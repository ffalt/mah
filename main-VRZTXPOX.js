import{a as qe,b as We}from"./chunk-ON6ND6TQ.js";import{a as J,b as Ne,d as lt,e as je}from"./chunk-NP64P3HA.js";import{a as Rt,b as Ue,d as ze}from"./chunk-GCLQQCMI.js";import{b as be,c as we,d as ke,e as Se,f as Te,i as $e,j as Ye,k as Xe,m as He,n as ot}from"./chunk-2BJ3Q6JT.js";import{C as Ft,c as Qt,d as Vt,e as Le,f as Ee,j as Ve,k as Fe,o as Jt,p as Re,r as Ge,t as Ae}from"./chunk-56S3VASB.js";import{$a as A,A as fe,Aa as kt,Ba as St,Ca as at,Da as L,E as b,Ea as E,F as w,G as mt,Ga as Q,H as jt,Ha as W,Ia as Z,Ja as x,Ka as u,L as ht,La as f,M as ft,Ma as k,Na as Mt,Oa as Lt,Pa as Zt,Q as _e,Qa as R,Ra as Pe,Sa as y,Ta as Et,Ua as M,Va as ve,Wa as Oe,Xa as tt,Ya as _t,Za as ct,_a as Tt,a as de,ab as Bt,b as zt,bb as O,cb as T,d as pe,da as Ce,db as U,ea as yt,eb as Kt,fb as G,ga as m,gb as Dt,i as me,jb as _,kb as C,l as ue,lb as xe,ma as qt,mb as ye,na as q,nb as et,ob as H,pa as bt,pb as nt,qa as ut,qb as It,r as ge,ra as Me,sa as wt,tb as Be,u as xt,ua as Wt,ub as De,vb as it,w as he,wb as Ie,y as S}from"./chunk-XLC3RWVP.js";var xn=["*"];function yn(n,i){if(n&1&&(Mt(0,"h1"),Zt(1,"i",4),O(2),Lt()),n&2){let r=M(2);m(2),T(r.title())}}function bn(n,i){if(n&1){let r=R();Mt(0,"a",5),_(1,"translate"),Et("click",function(){b(r);let e=M(2);return w(e.toggle())}),Zt(2,"i",6),Lt()}n&2&&Pe("title",G(C(1,2,"CLOSE")))}function wn(n,i){if(n&1){let r=R();Mt(0,"div",1),Et("click",function(){b(r);let e=M();return w(e.toggle())}),Mt(1,"div",2),Et("click",function(e){return b(r),w(e.stopPropagation())}),L(2,yn,3,1,"h1"),L(3,bn,3,4,"a",3),Oe(4),Lt()()}if(n&2){let r=M();Bt(Dt("overlay ",r.className())),m(2),E(r.title()?2:-1),m(),E(r.noClose()?-1:3)}}var Ze=(()=>{let i=class i{constructor(){this.title=H(),this.className=H(),this.visible=It(!1),this.noClose=H(!1),this.clickEvent=et()}toggle(){this.visible.set(!this.visible()),this.clickEvent.emit(this.visible())}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-dialog"]],inputs:{title:[1,"title"],className:[1,"className"],visible:[1,"visible"],noClose:[1,"noClose"]},outputs:{visible:"visibleChange",clickEvent:"clickEvent"},ngContentSelectors:xn,decls:1,vars:1,consts:[[3,"class"],[3,"click"],[1,"overlay-popup",3,"click"],["role","button",1,"close",3,"title"],[1,"icon-logo"],["role","button",1,"close",3,"click","title"],[1,"icon-cancel-circled2"]],template:function(e,o){e&1&&(ve(),L(0,wn,5,5,"div",0)),e&2&&E(o.visible()?0:-1)},dependencies:[it],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;color:var(--main-content-text-color)}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;color:var(--dialog-headline-color);margin-top:-8px;margin-bottom:10px;line-height:1.3em}@media only screen and (max-width: 700px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2em}}@media only screen and (max-width: 400px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1em}}"]});let n=i;return n})();function te(n){return(n<10?"0":"")+n.toString()}var Gt=(()=>{let i=class i{transform(t){if(Number.isNaN(t)||t===0)return"-";let e=Math.floor(t/1e3),o=Math.floor(e/3600),s=Math.floor((e-o*3600)/60),a=e-o*3600-s*60;return`${o>0?`${te(o)}:`:""}${te(s)}:${te(a)}`}};i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=ut({name:"duration",type:i,pure:!0});let n=i;return n})();var dt=class dt{constructor(i,r,t,e){this.left=i,this.top=r,this.right=t,this.bottom=e}static fromElement(i){let{left:r,top:t,right:e,bottom:o}=i.getBoundingClientRect();return new dt(r,t,e,o)}static fromWindow(i){return new dt(0,0,i.innerWidth,i.innerHeight)}inflate(i){this.left-=i,this.top-=i,this.right+=i,this.bottom+=i}intersectsWith(i){return i.left<this.right&&this.left<i.right&&i.top<this.bottom&&this.top<i.bottom}intersectsWithY(i){return i.top<this.bottom&&this.top<i.bottom}getIntersectionWith(i){let r=Math.max(this.left,i.left),t=Math.max(this.top,i.top),e=Math.min(this.right,i.right),o=Math.min(this.bottom,i.bottom);return e>=r&&o>=t?new dt(r,t,e,o):dt.empty}};dt.empty=new dt(0,0,0,0);var rt=dt;var Ct=(()=>{let i=class i{constructor(){this.scrollNotify=new Wt,this.observeNotify=new Wt,this.currentViewport=new rt(0,0,0,0),this.scrollSubject=new pe,this.platformId=S(_e),this.isBrowser=we(this.platformId),this.hasIntersectionObserver=i.checkIntersectionObserver();let t=this.scrollSubject.asObservable();this.scrollObservable=me(t.pipe(ge(300)),t.pipe(ue(100))),this.scrollObservable.subscribe(e=>{this.scrollNotify.emit(e)}),this.currentViewport=rt.fromWindow(window)}getObserver(){return this.intersectionObserver?this.intersectionObserver:(this.intersectionObserver=new IntersectionObserver(t=>{this.observeNotify.next(t)},{threshold:0}),this.intersectionObserver)}notifyScroll(t){if(this.hasIntersectionObserver)return;let e=t.element?rt.fromElement(t.element):rt.fromWindow(window),o=e.bottom-e.top;e.bottom+=o,e.top-=o,this.currentViewport=e,this.scrollSubject.next({rect:e})}static checkIntersectionObserver(){let t="IntersectionObserver"in window,o=window.navigator.userAgent.match(/Edge\/(\d*)\./i),s=!!o&&o.length>1,a=s&&!!o&&Number.parseInt(o[1],10)>15;return t&&(!s||a)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=xt({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var Ke=(()=>{let i=class i{constructor(){this.scrollTo=H(),this.element=S(ft),this.scrollNotify=S(Ct)}ngOnChanges(t){if(t.scrollTo?.currentValue){let e=t.scrollTo.currentValue;if(e.id&&e.id.length>0){let o=document.getElementById(e.id);o&&(this.element.nativeElement.scrollTop=o.offsetTop-o.offsetHeight)}}}scrollTrack(t){this.scrollNotify.notifyScroll({name:"scroll-host",element:this.element.nativeElement})}};i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=bt({type:i,selectors:[["","appDeferLoadScrollHost",""]],hostBindings:function(e,o){e&1&&y("scroll",function(a){return o.scrollTrack(a)})},inputs:{scrollTo:[1,"scrollTo"]},features:[ht]});let n=i;return n})();var Qe=(()=>{let i=class i{constructor(){this.preRender=H(!1),this.appDeferLoad=et(),this.timeoutLoadMS=20,this.elementRef=S(ft),this.deferLoadService=S(Ct)}ngAfterViewInit(){this.deferLoadService.isBrowser?this.deferLoadService.hasIntersectionObserver?this.registerIntersectionObserver():this.addScrollListeners():this.preRender()&&this.load()}ngOnDestroy(){this.removeListeners()}static getScrollPosition(){return window.scrollY+(document.documentElement.clientHeight||document.body.clientHeight)}loadAndUnobserve(){this.load(),this.unobserve(),this.removeListeners()}cancelDelayLoad(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}delayLoad(){this.timeoutId||(this.timeoutId=setTimeout(()=>{this.loadAndUnobserve(),this.cancelDelayLoad()},this.timeoutLoadMS))}manageIntersection(t){this.checkIfIntersecting(t)?this.delayLoad():this.cancelDelayLoad()}registerIntersectionObserver(){this.intersectionObserver||(this.intersectionObserver=this.deferLoadService.getObserver(),this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.observe(this.elementRef.nativeElement),this.observeSubscription=this.deferLoadService.observeNotify.subscribe(t=>{this.checkForIntersection(t)})))}checkForIntersection(t){for(let e of t)e.target===this.elementRef.nativeElement&&this.manageIntersection(e)}checkIfIntersecting(t){return t?.time?t.isIntersecting:this.isVisible()}load(){this.removeListeners(),this.appDeferLoad.emit()}loadFromScroll(){setTimeout(()=>{this.load()})}addScrollListeners(){this.scrollSubscription=this.deferLoadService.scrollNotify.subscribe(t=>{this.checkInView(t.rect)&&this.loadFromScroll()}),setTimeout(()=>{this.checkInView(this.deferLoadService.currentViewport)&&this.loadFromScroll()})}unobserve(){this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.unobserve(this.elementRef.nativeElement),this.intersectionObserver=void 0)}removeListeners(){this.scrollSubscription&&(this.scrollSubscription.unsubscribe(),this.scrollSubscription=void 0),this.unobserve(),this.observeSubscription&&(this.observeSubscription.unsubscribe(),this.observeSubscription=void 0)}checkInView(t){return rt.fromElement(this.elementRef.nativeElement).intersectsWithY(t)}isVisible(){let t=i.getScrollPosition();return this.elementRef.nativeElement.offsetTop<=t}};i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=bt({type:i,selectors:[["","appDeferLoad",""]],inputs:{preRender:[1,"preRender"]},outputs:{appDeferLoad:"appDeferLoad"}});let n=i;return n})();function h(n,i,r){return`${n}|${i}|${r}`}function vt(n,i){return Math.floor(Math.random()*(i-n+1))+n}function z(n){return n[Math.floor(Math.random()*n.length)]}function I(n){for(let i=n.length-1;i>0;i--){let r=Math.floor(Math.random()*(i+1));[n[i],n[r]]=[n[r],n[i]]}return n}function F(n,i,r){return n>=0&&n<=36&&i>=0&&i<=16&&r>=0&&r<=5}function Y(n,i,r,t){return n.has(h(i,r-1,t-1))||n.has(h(i,r,t-1))||n.has(h(i,r+1,t-1))||n.has(h(i,r-1,t))||n.has(h(i,r+1,t))||n.has(h(i,r-1,t+1))||n.has(h(i,r,t+1))||n.has(h(i,r+1,t+1))}function At(n,i,r,t){if(i===0)return!0;let e=i-1;return n.has(h(e,r,t))||n.has(h(e,r-1,t))&&n.has(h(e,r+1,t))?!0:n.has(h(e,r-1,t-1))&&n.has(h(e,r+1,t-1))&&n.has(h(e,r-1,t+1))&&n.has(h(e,r+1,t+1))}function Ot(n,i,r,t,e){if(!F(t,e,r))return!1;let o=h(r,t,e);return n.has(o)||!At(n,r,t,e)||Y(n,r,t,e)?!1:(n.add(o),i.push([r,t,e]),!0)}function Je(n){return n%2!==0}function tn(){return z(["lines","lines","lines","checker","checker","areas","areas","rings"])}function Nt(n,i){let r=[];for(let t=0;t<=i;t+=2)for(let e=0;e<=n;e+=2)r.push([e,t]);return r}function $t(n,i,r,t=0){for(let[e,o]of n)for(let s=-i;s<=i;s++)for(let a=-i;a<=i;a++){let c=e+a,l=o+s;F(c,l,t)&&r.add(h(t,c,l))}}function st(n,i,r,t=2){let e=[];for(let o=0;o<=r;o+=t)for(let s=0;s<=i;s+=t)n.has(h(0,s,o))&&e.push([0,s,o]);return e}function Yt(n,i,r=1){let t=[];for(let o=0;o<=n;o+=r)t.push(o);let e=[];for(let o=0;o<=i;o+=r)e.push(o);return{xs:t,ys:e}}function pt(n,i,r,t,e,o){let s=n;for(let[a,c]of i){if(s>=e)break;for(let[l,d]of r){if(s>=e)break;let p=o(l,d,a,c);if(p>0&&(s+=p,s>=t&&s<=e))break}if(s>=t&&s<=e)break}return s}function en(n){return n.some(i=>i[0]>0)}function kn(n,i,r,t,e,o){let s=vt(e,o),a=s*4,c=[];for(let d of t)for(let p of r)c.push([p,d]);I(c);let l=0;for(;l<s&&a-- >0&&c.length>0;){let[d,p]=c.pop();if(d===r[0]||d===r.at(-1)||p===t[0]||p===t.at(-1))continue;let g=h(i,d,p);if(!n.has(g))continue;let v=Math.random()<.5?"h":"v",P=[];v==="h"?(P.push(g),d+1<=r.at(-1)&&P.push(h(i,d+1,p))):(P.push(g),p+1<=t.at(-1)&&P.push(h(i,d,p+1)));let D=!1;for(let B of P)n.delete(B)&&(D=!0);D&&l++}}function Sn(n,i,r){for(let t of r)for(let e of i)e%2!==0||t%2!==0||n.add(h(0,e,t))}function Ln(){let n=Math.random()<.5?0:z([0,0,2,2,4]),i=Math.random()<.5?0:z([0,0,2,2,4]),r=Math.random()<.5?0:z([0,2,2,4]),t=Math.random()<.5?0:z([0,2,2,4]);return{left:n,right:i,top:r,bottom:t}}function En(n,i,r,t,e,o){let{left:s,right:a,top:c,bottom:l}=o;for(let d of r)for(let p of i)(p<s||p>t-a||d<c||d>e-l)&&n.delete(h(0,p,d))}function Tn(n,i,r){return Math.min(Math.max(i,Math.floor(n*.45)),r)}function Bn(n,i,r){let t=i.length;if(t<=r)return t;let e=I([...i]);for(;t>r&&e.length>0;){let o=e.pop();n.delete(h(0,o[1],o[2]))&&t--}return t}function Dn(n,i,r){let t=[];for(let e of r)for(let o of i)n.has(h(0,o,e))||t.push([0,o,e]);return t}function In(n,i,r,t){I(i);let e=r;for(;e<t&&i.length>0;){let[,o,s]=i.pop();Y(n,0,o,s)||(n.add(h(0,o,s)),e++)}return e}function nn({minTarget:n,maxTarget:i,xMax:r,yMax:t}){let e=new Set,{xs:o,ys:s}=Yt(r,t,1);Sn(e,o,s);let a=Ln();En(e,o,s,r,t,a),kn(e,0,o,s,6,32);let c=st(e,r,t,1),l=c.length,d=Tn(l,n,i);if(l>d)l=Bn(e,c,d);else if(l<d){let p=Dn(e,o,s);l=In(e,p,l,d)}return st(e,r,t,1)}function ee(n,i,r,t,e,o=!1){if(t%2!==0||e%2!==0||!F(t,e,0))return!1;let s=h(0,t,e);return n.has(s)||Y(n,0,t,e)?!1:(n.add(s),i.push([0,t,e]),o&&r.add(s),!0)}function Vn(n,i,r,t,e){let o=Math.floor(t/2),s=Math.floor(e/2);return o-=o%2,s-=s%2,F(o,s,0)||(o=0,s=0),ee(n,i,r,o,s,!0),{sx:o,sy:s}}function Fn(n,i){let r=n+i,t=Math.max(40,Math.floor(r*.8)),e=Math.max(t+100,Math.floor(r*2));return vt(t,e)}function Rn(n,i){let r=[n[0],n[1]],t=[-n[0],-n[1]],e=n[0]===0?[[1,0],[-1,0]]:[[0,1],[0,-1]],o=[r,...e,t];return Math.random()<i&&(o=I(o)),Math.random()<.2&&(o=[...I([...e]),r,t]),o}function Gn(n,i,r,t,e,o,s){let a=Rn(o,s);for(let[c,l]of a){let d=t+c*2,p=e+l*2;if(F(d,p,0)&&ee(n,i,r,d,p,!0))return{x:d,y:p,direction:[c,l]}}return null}function An(n,i,r,t,e){let o=I([[1,0],[-1,0],[0,1],[0,-1]]);for(let[s,a]of o){let c=t+s*2,l=e+a*2;if(!(!F(c,l,0)||Y(n,0,c,l)||n.has(h(0,c,l)))&&ee(n,i,r,c,l,!0))return{x:c,y:l,direction:[s,a]}}return null}function Nn(n,i,r,t,e,o){let s=Math.random()<.4?z([0,0,2]):0,a=Math.random()<.4?z([0,0,2]):0,c=Math.random()<.4?z([0,2]):0,l=Math.random()<.4?z([0,2]):0;for(let d of t)for(let p of r)if(p<s||p>e-a||d<c||d>o-l){let g=h(0,p,d);i.has(g)||n.delete(g)}}function $n(n,i,r,t){let e=i.length,o=I([...i].filter(s=>!r.has(h(0,s[1],s[2]))));for(;e>t&&o.length>0;){let s=o.pop();n.delete(h(0,s[1],s[2]))&&e--}return e}function Yn(n,i,r,t,e,o){let s=[],a=[];for(let d of t)for(let p of r)n.has(h(0,p,d))||([[p-2,d],[p+2,d],[p,d-2],[p,d+2]].some(([P,D])=>i.has(h(0,P,D)))?s:a).push([0,p,d]);I(s),I(a);let c=[s,a],l=e;for(let d of c)for(;l<o&&d.length>0;){let[p,g,v]=d.pop();g%2===0&&v%2===0&&!Y(n,0,g,v)&&(n.add(h(p,g,v)),l++)}return l}function Xn(n,i,r,t,e,o,s,a){let c=st(n,s,a,1),l=c.length,d=Math.min(Math.max(e,Math.floor(l*.9)),o);l>d?l=$n(n,c,i,d):l<d&&(l=Yn(n,i,r,t,l,d))}function Hn(n,i,r){let t=[];for(let e of r)for(let o of i)n.has(h(0,o,e))&&t.push([0,o,e]);return t}function on({minTarget:n,maxTarget:i,xMax:r,yMax:t}){let e=new Set,o=[],s=new Set,{xs:a,ys:c}=Yt(r,t,1),{sx:l,sy:d}=Vn(e,o,s,r,t),p=l,g=d,P=[[1,0],[-1,0],[0,1],[0,-1]][Math.floor(Math.random()*4)],D=Fn(r,t);for(let B=0;B<D;B++){let V=B%vt(6,12)===0?Math.random()*.6+.2:Math.random()*.3,j=Gn(e,o,s,p,g,P,V);if(j){p=j.x,g=j.y,P=j.direction;continue}let gt=An(e,o,s,p,g);if(gt){p=gt.x,g=gt.y,P=gt.direction;continue}break}return Nn(e,s,a,c,r,t),Xn(e,s,a,c,n,i,r,t),Hn(e,a,c)}function rn(n,i,r,t){let e=n+(r-1)*2,o=i+(t-1)*2,s=[];for(let a=n;a<=e;a+=2)s.push([a,i]);for(let a=i+2;a<=o;a+=2)s.push([e,a]);for(let a=e-2;a>=n;a-=2)s.push([a,o]);for(let a=o-2;a>i;a-=2)s.push([n,a]);return s}function ne(n,i,r,t,e,o,s){let a=`${r}x${t}`;if(s.has(a))return!1;let c=n+(r-1)*2,l=i+(t-1)*2;if(!F(c,l,0))return!1;let d=rn(n,i,r,t);for(let[p,g]of d){if(p%2!==0||g%2!==0||!F(p,g,0))return!1;let v=h(0,p,g);if(e.has(v)||o.has(v)||Y(e,0,p,g))return!1}return!0}function ie(n,i,r,t,e,o,s){let a=rn(n,i,r,t);for(let[c,l]of a)e.add(h(0,c,l));return $t(a,2,o,0),s.add(`${r}x${t}`),a.length}function sn({minTarget:n,maxTarget:i,xMax:r,yMax:t}){let e=new Set,o=new Set,s=new Set,a=[];for(let d=3;d<=8;d++)for(let p=3;p<=8;p++)a.push([d,p]);I(a);let c=Nt(r,t);I(c);let l=0;if(l=pt(l,a,c,n,i,(d,p,g,v)=>ne(d,p,g,v,e,o,s)?ie(d,p,g,v,e,o,s):0),l<n){let d=a.filter(([p,g])=>!s.has(`${p}x${g}`));I(d),I(c),l=pt(l,d,c,n,i,(p,g,v,P)=>ne(p,g,v,P,e,o,s)?ie(p,g,v,P,e,o,s):0)}if(l<i){let d=!0,p=!1;for(;d&&l<i;){d=!1;let g=p?[...a]:a.filter(([v,P])=>!s.has(`${v}x${P}`));if(g.length===0&&!p){p=!0;continue}I(g),I(c),l=pt(l,g,c,n,i,(v,P,D,B)=>{if(!ne(v,P,D,B,e,o,s))return 0;let V=ie(v,P,D,B,e,o,s);return V>0&&(d=!0),V})}}return st(e,r,t,2)}function an(n,i,r,t){let e=n+(r-1)*2,o=i+(t-1)*2,s=[];for(let a=i;a<=o;a+=2)for(let c=n;c<=e;c+=2)s.push([c,a]);return s}function oe(n,i,r,t,e,o,s){let a=`${r}x${t}`;if(s.has(a))return!1;let c=n+(r-1)*2,l=i+(t-1)*2;if(!F(c,l,0))return!1;let d=an(n,i,r,t);for(let[p,g]of d){if(p%2!==0||g%2!==0||!F(p,g,0))return!1;let v=h(0,p,g);if(e.has(v)||o.has(v)||Y(e,0,p,g))return!1}return!0}function re(n,i,r,t,e,o,s){let a=an(n,i,r,t);for(let[c,l]of a)e.add(h(0,c,l));return $t(a,2,o,0),s.add(`${r}x${t}`),a.length}function cn({minTarget:n,maxTarget:i,xMax:r,yMax:t}){let e=new Set,o=new Set,s=new Set,a=[];for(let d=2;d<=5;d++)for(let p=2;p<=5;p++)a.push([d,p]);I(a);let c=Nt(r,t);I(c);let l=pt(0,a,c,n,i,(d,p,g,v)=>oe(d,p,g,v,e,o,s)?re(d,p,g,v,e,o,s):0);if(l<n){let d=a.filter(([p,g])=>!s.has(`${p}x${g}`));I(d),I(c),l=pt(l,d,c,n,i,(p,g,v,P)=>oe(p,g,v,P,e,o,s)?re(p,g,v,P,e,o,s):0)}if(l<i){let d=!0,p=!1;for(;d&&l<i;){d=!1;let g=p?[...a]:a.filter(([v,P])=>!s.has(`${v}x${P}`));if(g.length===0&&!p){p=!0;continue}I(g),I(c),l=pt(l,g,c,n,i,(v,P,D,B)=>{if(!oe(v,P,D,B,e,o,s))return 0;let V=re(v,P,D,B,e,o,s);return V>0&&(d=!0),V})}}return st(e,r,t,2)}function Xt(n,i,r){if(!n&&!i||r.length===0)return r;let t=Math.max(...r.map(P=>P[1])),e=Math.max(...r.map(P=>P[2])),o=t*2+2,s=e*2+2,a=Math.min(36,o+4),c=Math.min(16,s+4);a%2!==0&&a--,c%2!==0&&c--,a<o&&(a=Math.max(t*2,Math.min(36-36%2,o))),c<s&&(c=Math.max(e*2,Math.min(16-16%2,s)));let l=P=>a-P,d=P=>c-P,p=[...r],g=new Set(p.map(([P,D,B])=>h(P,D,B))),v=(P,D,B)=>{if(!F(D,B,P))return;let V=h(P,D,B);g.has(V)||Y(g,P,D,B)||(g.add(V),p.push([P,D,B]))};if(n){let P=[...p];for(let[D,B,V]of P){let j=l(B);j!==B&&v(D,j,V)}}if(i){let P=[...p];for(let[D,B,V]of P){let j=d(V);j!==V&&v(D,B,j)}}return p}function Ht(n,i,r,t){let e=r&&t,o=r&&!t||!r&&t,s;e?s=.25:o?s=.5:s=1;let a=Math.max(1,Math.floor(n*s)),c=Math.max(a,Math.floor(i*s)),l=r?Math.floor(36/2):36,d=t?Math.floor(16/2):16;return{minTarget:a,maxTarget:c,xMax:l,yMax:d}}function ln(n,i,r){if(r==="checker"){let{minTarget:t,maxTarget:e}=Ht(70,120,n,i),o=n?7:14,s=n?Math.floor(36/2):36,a=i?6:12,c=i?Math.floor(16/2):16,l=Math.floor(Math.random()*(s-o+1))+o,d=Math.floor(Math.random()*(c-a+1))+a;return Xt(n,i,nn({minTarget:t,maxTarget:e,xMax:l,yMax:d}))}if(r==="lines")return Xt(n,i,on(Ht(60,80,n,i)));if(r==="rings")return Xt(n,i,sn(Ht(70,120,n,i)));if(r==="areas")return Xt(n,i,cn(Ht(60,100,n,i)));throw new Error("Invalid mode")}function Un(n,i){let r=36,t=0,e=16,o=0;for(let[s,a,c]of n)s===i-1&&(r=Math.min(r,a),t=Math.max(t,a),e=Math.min(e,c),o=Math.max(o,c));return r>t||e>o?null:{minX:Math.max(0,r-2),maxX:Math.min(36,t+2),minY:Math.max(0,e-2),maxY:Math.min(16,o+2)}}function zn(n,i,r){let t=[],e=[],o=[],s=i-1;for(let a=r.minY;a<=r.maxY;a++)for(let c=r.minX;c<=r.maxX;c++){let l=h(i,c,a);if(n.has(l)||!F(c,a,i))continue;let d=n.has(h(s,c,a)),p=n.has(h(s,c-1,a))&&n.has(h(s,c+1,a)),g=n.has(h(s,c-1,a-1))&&n.has(h(s,c+1,a-1))&&n.has(h(s,c-1,a+1))&&n.has(h(s,c+1,a+1));(d||p||g)&&(g?t.push([c,a]):p?e.push([c,a]):d&&o.push([c,a]))}return{bridgeLarge:t,bridgeSmall:e,direct:o}}function jn(n,i,r){let t=[],e=i-1;if(Math.random()<.25)for(let o=r.minY;o<=r.maxY;o++)for(let s=r.minX;s<=r.maxX;s++){if(!n.has(h(e,s,o)))continue;let a=[[-1,0],[1,0],[0,-1],[0,1]],[c,l]=z(a),d=s+c,p=o+l;if(!F(d,p,i))continue;let g=h(i,d,p);n.has(g)||t.push([d,p])}return t}function qn(n){let i=Math.trunc(Math.random()*n);return i-=i%2,Math.max(i,2)}function Wn(n,i,r,t,e,o,s,a,c){if(!Ot(n,i,r,t,e))return!1;if(o||s){let l=a(t),d=c(e);o&&l!==t&&Ot(n,i,r,l,e),s&&d!==e&&Ot(n,i,r,t,d),o&&s&&(l!==t||d!==e)&&Ot(n,i,r,l,d)}return!0}function Zn(n,i,r,t){if(n.length>=144)return n;let e=Un(n,i);if(!e)return n;let o=new Set(n.map(V=>h(V[0],V[1],V[2]))),{bridgeLarge:s,bridgeSmall:a,direct:c}=zn(o,i,e),l=jn(o,i,e),d=144-n.length,p=qn(d),g=0,{mirX:v,mirY:P}=dn(n),D=[...n],B=V=>{for(let[j,gt]of V){if(g>=p||D.length>=144)return;Wn(o,D,i,j,gt,r,t,v,P)&&g++}};return B(s),B(a),B(c),B(l),D}function Kn(n,i,r){let t=n;for(let e=1;e<=5&&t.length<144;e++)t=Zn(t,e,i,r);return t.length>144?t.slice(0,144):t}function dn(n){let i=n.map(l=>l[1]),r=n.map(l=>l[2]),t=i.length>0?Math.min(...i):0,e=i.length>0?Math.max(...i):36,o=r.length>0?Math.min(...r):0,s=r.length>0?Math.max(...r):16,a=(t+e)/2,c=(o+s)/2;return{mirX:l=>Math.round(2*a-l),mirY:l=>Math.round(2*c-l)}}function Qn(n,i,r,t,e,o,s,a,c){let l=[[t,e]];if(o){let d=a(t);d!==t&&l.push([d,e])}if(s){let d=c(e);if(l.some(p=>p[0]===t&&p[1]===d)||l.push([t,d]),o){let p=a(t),g=c(e);l.some(v=>v[0]===p&&v[1]===g)||l.push([p,g])}}for(let[d,p]of l){if(!F(d,p,r))return!1;let g=h(r,d,p);if(i.has(g)||!At(i,r,d,p)||Y(i,r,d,p))return!1}if(n.length+l.length>144)return!1;for(let[d,p]of l){let g=h(r,d,p);i.add(g),n.push([r,d,p])}return!0}function Jn(n,i,r){let t=new Set(n.map(a=>h(a[0],a[1],a[2]))),{mirX:e,mirY:o}=dn(n),s=!0;for(;n.length<144&&s;){s=!1;for(let a=0;a<=5&&n.length<144;a++){let c=[];for(let l=0;l<=16;l++)for(let d=0;d<=36;d++)F(d,l,a)&&(t.has(h(a,d,l))||c.push([d,l]));for(let l=c.length-1;l>0;l--){let d=Math.floor(Math.random()*(l+1));[c[l],c[d]]=[c[d],c[l]]}for(let[l,d]of c){if(n.length>=144)break;Qn(n,t,a,l,d,i,r,e,o)&&(s=!0)}}}return n}function ti(n){let i=36,r=0,t=16,e=0;for(let[,o,s]of n)i=Math.min(i,o),r=Math.max(r,o),t=Math.min(t,s),e=Math.max(e,s);return{minX:Math.max(0,i-2),maxX:Math.min(36,r+2),minY:Math.max(0,t-2),maxY:Math.min(16,e+2)}}function ei(n,i,r){for(let t=5;t>=0;t--)for(let e=r.minY;e<=r.maxY;e++)for(let o=r.minX;o<=r.maxX;o++){if(!F(o,e,t))continue;let s=h(t,o,e);if(!i.has(s)&&At(i,t,o,e)&&!Y(i,t,o,e))return i.add(s),n.push([t,o,e]),!0}return!1}function ni(n){let i=new Map;for(let[r,t,e]of n)i.set(h(r,t,e),0);for(let[r,t,e]of n){if(r===0)continue;let o=r-1,s=[h(o,t,e),h(o,t-1,e),h(o,t+1,e),h(o,t-1,e-1),h(o,t+1,e-1),h(o,t-1,e+1),h(o,t+1,e+1)];for(let a of s)i.has(a)&&i.set(a,(i.get(a)||0)+1)}return i}function ii(n,i){let r=-1,t=-1;for(let e=n.length-1;e>=0;e--){let[o,s,a]=n[e],c=h(o,s,a);(i.get(c)||0)===0&&o>=t&&(r=e,t=o)}return r}function oi(n){if(!Je(n.length))return n;let i=new Set(n.map(o=>h(o[0],o[1],o[2]))),r=ti(n);if(ei(n,i,r)||n.length===0)return n;let t=ni(n),e=ii(n,t);return e>=0?n.splice(e,1):n.pop(),n}function pn(n,i,r){let t=[...n],e=0;for(;t.length<144&&e<50;){e++;let o=t.length;if(t=Kn(t,i,r),t.length===o)break}return t.length<144&&(t=Jn(t,i,r)),t.length>144&&(t=t.slice(0,144)),t=oi(t),t}var mn=100;function ri(n,i,r){let t=ln(n,i,r);for(let e=0;e<mn;e++){let o=pn(t,n,i);if(o.length===144)return o}return[]}function un(n,i,r){let t=n==="random"?Math.random()<.5:n==="true",e=i==="random"?Math.random()<.5:i==="true",o=r==="random"?tn():r,s=[],a=0;for(;s.length!==144||!en(s);)if(s=ri(t,e,o),a++,a>mn)return[];return ze(s)}var si=["scrollHost"];function ai(n,i){if(n&1){let r=R();u(0,"a",4),y("click",function(){let e=b(r).$index,o=M(2);return w(o.scrollToGroup(e))}),O(1),f()}if(n&2){let r=i.$implicit;m(),T(r.name)}}function ci(n,i){if(n&1&&(u(0,"div",1),W(1,ai,2,1,"a",null,Q),f()),n&2){let r=M();m(),Z(r.groups)}}function li(n,i){if(n&1&&O(0),n&2){let r=M(2).$implicit;U(" [",r.layouts.length,"] ")}}function di(n,i){if(n&1){let r=R();u(0,"div",6),y("click",function(){b(r);let e=M().$implicit;return w(e.expanded=!e.expanded)}),k(1,"span",7),O(2),u(3,"span",8),L(4,li,1,1),f()()}if(n&2){let r=M().$implicit;m(),A("expanded",r.expanded),m(),U(" ",r.name," "),m(2),E(r.isRandom?-1:4)}}function pi(n,i){if(n&1&&k(0,"app-layout-preview",23),n&2){let r=M().$implicit;x("svg",r.layout.previewSVG)("alt",r.layout.name)}}function mi(n,i){if(n&1&&k(0,"div",26),n&2){let r=M().$implicit;A("selected",r.selected),x("id","item-"+r.layout.id)}}function ui(n,i){if(n&1){let r=R();u(0,"div",22),y("keydown.enter",function(){let e=b(r).$implicit,o=M(4);return w(o.onStart(e))})("click",function(){let e=b(r).$implicit,o=M(4);return w(o.onStart(e))})("appDeferLoad",function(){let e=b(r).$implicit;return w(e.visible=!0)}),L(1,pi,1,2,"app-layout-preview",23)(2,mi,1,3,"div",24),u(3,"div",25),O(4),f()()}if(n&2){let r=i.$implicit;A("selected",r.selected),x("id","item-"+r.layout.id),m(),E(r.visible?1:2),m(3),T(r.layout.name)}}function gi(n,i){if(n&1){let r=R();u(0,"div",9),W(1,ui,5,5,"div",10,Q),u(3,"div",11)(4,"div",12)(5,"label"),mt(),u(6,"svg",13),k(7,"path",14),f(),O(8),_(9,"translate"),f(),jt(),u(10,"select",15),y("change",function(e){b(r);let o=M(3);return w(o.randomMirrorXSet(e.target.value))}),u(11,"option",16),O(12),_(13,"translate"),f(),u(14,"option",17),O(15),_(16,"translate"),f(),u(17,"option",18),O(18),_(19,"translate"),f()()(),u(20,"div",12)(21,"label"),mt(),u(22,"svg",19),k(23,"path",20),f(),O(24),_(25,"translate"),f(),jt(),u(26,"select",15),y("change",function(e){b(r);let o=M(3);return w(o.randomMirrorYSet(e.target.value))}),u(27,"option",16),O(28),_(29,"translate"),f(),u(30,"option",17),O(31),_(32,"translate"),f(),u(33,"option",18),O(34),_(35,"translate"),f()()(),u(36,"div")(37,"button",21),y("click",function(){b(r);let e=M(3);return w(e.generateRandomLayouts())})("keydown.enter",function(){b(r);let e=M(3);return w(e.generateRandomLayouts())}),O(38),_(39,"translate"),f()()()()}if(n&2){let r=M(2).$implicit,t=M();m(),Z(r.layouts),m(7),U(" ",C(9,15,"MIRROR_X")," "),m(3),x("selected",t.randomMirrorX==="random"),m(),T(C(13,17,"RANDOM_MIRROR")),m(2),x("selected",t.randomMirrorX==="true"),m(),T(C(16,19,"YES")),m(2),x("selected",t.randomMirrorX==="false"),m(),T(C(19,21,"NO")),m(6),U(" ",C(25,23,"MIRROR_Y")," "),m(3),x("selected",t.randomMirrorY==="random"),m(),T(C(29,25,"RANDOM_MIRROR")),m(2),x("selected",t.randomMirrorY==="true"),m(),T(C(32,27,"YES")),m(2),x("selected",t.randomMirrorY==="false"),m(),T(C(35,29,"NO")),m(4),U(" ",C(39,31,"GENERATE")," ")}}function hi(n,i){if(n&1&&k(0,"app-layout-preview",23),n&2){let r=M().$implicit;x("svg",r.layout.previewSVG)("alt",r.layout.name)}}function fi(n,i){if(n&1&&k(0,"div",26),n&2){let r=M().$implicit;A("selected",r.selected),x("id","item-"+r.layout.id)}}function _i(n,i){if(n&1){let r=R();u(0,"div",27)(1,"span",29),_(2,"translate"),O(3),_(4,"duration"),f(),u(5,"a",30),_(6,"translate"),y("click",function(e){b(r);let o=M().$implicit,s=M(4);return w(s.clearBestTimeClick(e,o))}),k(7,"i",31),f()()}if(n&2){let r=M().$implicit;m(),x("title",G(C(2,5,"STATS_BEST"))),m(2),T(C(4,7,r.bestTime)),m(2),x("title",G(C(6,9,"BEST_TIME_CLEAR")))}}function Ci(n,i){if(n&1){let r=R();u(0,"div",28),_(1,"translate"),u(2,"a",4),y("click",function(e){b(r);let o=M().$implicit,s=M(4);return w(s.removeCustomLayout(e,o))}),k(3,"i",32),f()()}n&2&&x("title",G(C(1,2,"CUSTOM_BOARD_DELETE")))}function Mi(n,i){if(n&1){let r=R();u(0,"div",22),y("keydown.enter",function(){let e=b(r).$implicit,o=M(4);return w(o.onStart(e))})("click",function(){let e=b(r).$implicit,o=M(4);return w(o.onStart(e))})("appDeferLoad",function(){let e=b(r).$implicit;return w(e.visible=!0)}),L(1,hi,1,2,"app-layout-preview",23)(2,fi,1,3,"div",24),L(3,_i,8,11,"div",27),u(4,"div",25),O(5),f(),L(6,Ci,4,4,"div",28),f()}if(n&2){let r=i.$implicit;A("selected",r.selected),x("id","item-"+r.layout.id),m(),E(r.visible?1:2),m(2),E(r.bestTime?3:-1),m(2),T(r.layout.name),m(),E(r.layout.custom?6:-1)}}function Pi(n,i){if(n&1&&(u(0,"div",9),W(1,Mi,7,7,"div",10,Q),f()),n&2){let r=M(2).$implicit;m(),Z(r.layouts)}}function vi(n,i){if(n&1&&L(0,gi,40,33,"div",9)(1,Pi,3,0,"div",9),n&2){let r=M().$implicit;E(r.isRandom?0:1)}}function Oi(n,i){if(n&1&&(u(0,"div",3),L(1,di,5,4,"div",5),L(2,vi,2,1),f()),n&2){let r=i.$implicit,t=i.$index,e=M();x("id",Dt("group-",t)),m(),E(e.groups.length>1?1:-1),m(),E(r.expanded?2:-1)}}var gn=(()=>{let i=class i{constructor(){this.layouts=H(),this.startEvent=et(),this.scrollHost=nt.required("scrollHost"),this.groups=[],this.randomMirrorX="random",this.randomMirrorY="random",this.randomGroup={name:"",layouts:[],expanded:!0,isRandom:!0},this.storage=S(Ft),this.translate=S(De),this.layoutService=S(ot)}ngOnInit(){this.randomMirrorX=this.storage.getLastMirrorX()??"random",this.randomMirrorY=this.storage.getLastMirrorY()??"random",this.buildRandomGroup()}buildRandomGroup(){this.randomGroup.name=this.translate.instant("RANDOM_GROUP");let t=this.translate.instant("RANDOM_LAYOUT");for(let e=0;e<4;e++)this.randomGroup.layouts.push({layout:{id:`${Ne}${e}`,name:`${t} ${e+1}`,category:this.randomGroup.name,mapping:[]},visible:!1,selected:!1});this.generateRandomLayouts()}randomMirrorXSet(t){this.randomMirrorX=t,this.storage.setLastMirrorX(t),this.generateRandomLayouts()}randomMirrorYSet(t){this.randomMirrorY=t,this.storage.setLastMirrorY(t),this.generateRandomLayouts()}generateRandomLayout(t){let e=un(this.randomMirrorX,this.randomMirrorY,"random");t.layout.previewSVG=this.layoutService.generatePreview(e),t.layout.mapping=e}generateRandomLayouts(){for(let t of this.randomGroup.layouts)setTimeout(()=>{this.generateRandomLayout(t)})}ngOnChanges(t){this.refresh()}refresh(){let t=this.layouts();if(t){this.buildGroups();let e=this.storage.getLastPlayed(),o=this.layoutService.selectBoardID;this.layoutService.selectBoardID=void 0,o&&t.some(s=>s.id===o)&&(e=o),e&&setTimeout(()=>{this.select(e)})}}onStart(t){t?.visible&&this.startEvent.emit(t.layout)}buildGroups(){let t=[],e={},o=this.layouts()??this.layoutService.layouts.items;for(let s of o){e[s.category]||(e[s.category]={name:s.category,layouts:[],expanded:!0},t.push(e[s.category]));let a=this.storage.getScore(s.id)||{};e[s.category].layouts.push({layout:s,playCount:a.playCount,bestTime:a.bestTime,visible:!1})}t.push(this.randomGroup),this.groups=t}scrollToElement(t,e){if(!t||!e)return;let o=t.getBoundingClientRect(),s=e.getBoundingClientRect(),a=o.top-s.top+e.scrollTop;e.scrollTo({top:a,behavior:"auto"})}scrollToGroup(t){let e=document.getElementById(`group-${t}`);e&&this.scrollToElement(e,this.scrollHost().nativeElement)}scrollToItem(t){let e=document.getElementById(`item-${t}`);e&&this.scrollToElement(e,this.scrollHost().nativeElement)}select(t){if(t){for(let e of this.groups)for(let o of e.layouts)o.selected=o.layout.id===t;this.scrollToItem(t)}}clearBestTimeClick(t,e){t.stopPropagation(),confirm(this.translate.instant("BEST_TIME_CLEAR_SURE"))&&(this.storage.clearScore(e.layout.id),e.bestTime=void 0,e.playCount=void 0)}removeCustomLayout(t,e){t.stopPropagation(),confirm(this.translate.instant("CUSTOM_BOARD_DELETE_SURE"))&&(this.layoutService.removeCustomLayout([e.layout.id]),this.refresh())}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-layout-list"]],viewQuery:function(e,o){e&1&&tt(o.scrollHost,si,5),e&2&&_t()},inputs:{layouts:[1,"layouts"]},outputs:{startEvent:"startEvent"},features:[ht],decls:5,vars:1,consts:[["scrollHost",""],[1,"headline-anchors"],[1,"groups"],[1,"group",3,"id"],[3,"click"],[1,"group-name"],[1,"group-name",3,"click"],[1,"group-expander"],[1,"group-count"],["appDeferLoadScrollHost","",1,"previews"],["tabindex","0",1,"preview",3,"id","selected"],[1,"preview-random"],[1,"random-options"],["width","20px","height","20px","viewBox","-2 0 20 20"],["id","focus_vertical-[#842]","d","M7,20 L7,0 L9,0 L9,20 Z M0,2 L5,2 L5,4 L2,4 L2,7 L0,7 Z M11,2 L16,2 L16,7 L14,7 L14,4 L11,4 Z M0,18 L0,13 L2,13 L2,16 L5,16 L5,18 Z M16,18 L11,18 L11,16 L14,16 L14,13 L16,13 Z"],[3,"change"],["value","random",3,"selected"],["value","true",3,"selected"],["value","false",3,"selected"],["width","20px","height","20px","viewBox","0 -2 20 20"],["d","M0,9 L0,7 L20,7 L20,9 Z M2,5 L2,0 L7,0 L7,2 L4,2 L4,5 Z M18,0 L18,5 L16,5 L16,2 L13,2 L13,0 Z M2,16 L2,11 L4,11 L4,14 L7,14 L7,16 Z M18,16 L13,16 L13,14 L16,14 L16,11 L18,11 Z"],[3,"click","keydown.enter"],["tabindex","0",1,"preview",3,"keydown.enter","click","appDeferLoad","id"],[1,"svg-board",3,"svg","alt"],[1,"preview-placeholder",3,"id","selected"],[1,"preview-name"],[1,"preview-placeholder",3,"id"],[1,"preview-best-time"],[1,"preview-custom",3,"title"],[3,"title"],[3,"click","title"],[1,"icon-cancel-squared"],[1,"icon-trash-empty"]],template:function(e,o){e&1&&(L(0,ci,3,0,"div",1),u(1,"div",2,0),W(3,Oi,3,4,"div",3,Q),f()),e&2&&(E(o.groups.length>1?0:-1),m(3),Z(o.groups))},dependencies:[Ue,Ke,Qe,Gt,it],styles:['[_nghost-%COMP%]{display:flex;overflow:hidden;flex-direction:column;flex:1}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{border-bottom:1px solid var(--card-layout-color-border);width:100%;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));padding-bottom:10px;color:var(--dialog-text-color);white-space:nowrap}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:2px 4px;font-size:.9em;cursor:pointer;text-align:center}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--main-text-color-lt)}@media only screen and (max-width: 1000px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]{overflow:hidden auto;width:100%;flex:1}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{border-top:1px solid var(--card-layout-color-border);color:var(--main-content-text-color);padding-top:12px;padding-bottom:12px;height:48px;display:flex;justify-content:space-between;align-items:center;text-align:center;cursor:pointer}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]:hover{background-color:var(--card-layout-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]{margin-left:20px;min-width:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]:after{content:"+";color:var(--main-content-text-color-muted);font-size:1.2em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander.expanded[_ngcontent-%COMP%]:after{content:"-"}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-count[_ngcontent-%COMP%]{font-size:.8em;color:var(--main-content-text-color-muted);margin-right:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]:first-of-type   .group-name[_ngcontent-%COMP%]{border-top:inherit}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{padding:20px 10px 10px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;margin-right:20px;align-items:center;flex-direction:row;display:flex}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:var(--main-content-text-color)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;margin-top:20px;margin-left:auto;margin-right:auto}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{width:100%;display:flex;flex-flow:row wrap;justify-content:space-evenly;gap:4px;padding-bottom:12px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:8px;width:300px;height:200px;cursor:pointer;border:1px solid var(--card-layout-color-border);background-color:var(--card-layout-color-bg);display:block;position:relative;overflow:clip}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{display:block;width:300px;height:200px;text-align:center;padding-bottom:1.5em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{position:absolute;right:0;background-color:var(--preview-overlay-background);color:var(--preview-overlay-text);text-shadow:1px 1px var(--preview-overlay-text-shadow);border-bottom-left-radius:3px;padding:3px 3px 3px 6px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;min-width:1.2em;text-align:right;transition:all .1s;margin-top:-1px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{transform:scale(1.3)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{position:absolute;width:100%;height:1.5em;display:block;bottom:0;background-color:var(--card-text-color-bg);color:var(--card-text-color);text-align:center;font-size:.8em;padding:2px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{top:0;display:flex;flex-direction:row;justify-content:center}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]{bottom:0;padding:2px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus{background-color:var(--card-layout-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-name[_ngcontent-%COMP%]{background-color:var(--card-text-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-custom[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]{border:1px solid var(--card-layout-color-border-selected);box-shadow:#00000029 0 3px 6px,#0000003b 0 3px 6px}@media only screen and (max-width: 2200px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:200px;height:190px}}@media only screen and (max-width: 700px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:49%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%}}@media only screen and (max-width: 400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:96%}}@media only screen and (max-height: 500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%;height:100%}}']});let n=i;return n})();function xi(n,i){if(n&1&&(u(0,"option",5),O(1),_(2,"translate"),_(3,"translate"),f()),n&2){let r=i.$implicit,t=M();x("value",r.id)("selected",t.buildMode===r.id),m(),Kt("",C(2,4,r.id)," [",C(3,6,r.id+"_DESC"),"]")}}function yi(n,i){if(n&1&&(O(0),_(1,"translate")),n&2){let r=i.$implicit,t=i.$index,e=i.$count;Kt(" ",C(1,2,r.title),"",t!==e-1?", ":""," ")}}function bi(n,i){if(n&1&&(O(0," ["),W(1,yi,2,4,null,null,Q),O(3,"] ")),n&2){let r=M().$implicit;m(),Z(r.features)}}function wi(n,i){if(n&1&&(u(0,"option",5),O(1),_(2,"translate"),L(3,bi,4,0),f()),n&2){let r=i.$implicit,t=M();x("value",r.id)("selected",t.gameMode()===r.id),m(),U("",C(2,4,r.id)," "),m(2),E(r.features.length>0?3:-1)}}var hn=(()=>{let i=class i{constructor(){this.startEvent=et(),this.gameMode=It.required(),this.buildMode=Ve,this.buildModes=Fe,this.gameModes=Ge,this.layoutService=S(ot),this.storage=S(Ft)}onStart(t){t&&(this.startEvent.emit({layout:t,buildMode:this.buildMode,gameMode:this.gameMode()}),this.storage.storeLastPlayed(t.id))}randomGame(){let t=Math.floor(Math.random()*this.layoutService.layouts.items.length);this.onStart(this.layoutService.layouts.items[t])}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-choose-layout"]],inputs:{gameMode:[1,"gameMode"]},outputs:{startEvent:"startEvent",gameMode:"gameModeChange"},decls:20,vars:10,consts:[[3,"startEvent","layouts"],[1,"choose-buttons"],[1,"generator"],["for","board-generator-select"],["id","board-generator-select",3,"change"],[3,"value","selected"],[1,"mode"],["for","game-mode-select"],["id","game-mode-select",3,"change"],[1,"start-links"],[1,"link",3,"click"]],template:function(e,o){e&1&&(u(0,"app-layout-list",0),y("startEvent",function(a){return o.onStart(a)}),f(),u(1,"div",1)(2,"div",2)(3,"label",3),O(4),_(5,"translate"),f(),u(6,"select",4),y("change",function(a){return o.buildMode=a.target.value}),W(7,xi,4,8,"option",5,Q),f()(),u(9,"div",6)(10,"label",7),O(11),_(12,"translate"),f(),u(13,"select",8),y("change",function(a){return o.gameMode.set(a.target.value)}),W(14,wi,4,6,"option",5,Q),f()(),u(16,"div",9)(17,"button",10),y("click",function(){return o.randomGame()}),O(18),_(19,"translate"),f()()()),e&2&&(x("layouts",o.layoutService.layouts.items),m(4),U("",C(5,4,"BOARD_GENERATOR"),":"),m(3),Z(o.buildModes),m(4),U("",C(12,6,"GAME_MODE"),":"),m(3),Z(o.gameModes),m(4),T(C(19,8,"START_RANDOM")))},dependencies:[gn,it],styles:["[_nghost-%COMP%]{padding:0;margin:0;width:100%;height:100%;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{border-top:1px solid var(--card-layout-color-border);padding-top:10px;display:flex;flex-flow:row nowrap;align-items:flex-end}@media only screen and (max-height: 500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{padding-top:4px}}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{text-align:right;display:inline-block}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:var(--input-text-color);margin-left:8px;text-decoration:none;padding:8px 12px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:2px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{margin-left:8px;max-width:30%}"]});let n=i;return n})();var Ut=class{constructor(){this.gestureIndicators=[]}hide(i){let r=i;r&&setTimeout(()=>{r.state="hidden",setTimeout(()=>{this.removeIndicator(i)},250)},500)}removeIndicator(i){for(let r=0;r<this.gestureIndicators.length;r++){let t=this.gestureIndicators[r];if(t.x===i.x&&t.y===i.y){this.gestureIndicators.splice(r,1);break}}}setSize(i,r){this.gestureIndicators[i].size=r,this.gestureIndicators[i].top=this.gestureIndicators[i].y-r/2,this.gestureIndicators[i].left=this.gestureIndicators[i].x-r/2}display(i,r,t){if(i>0&&r>0){let e={x:i,y:r,size:t,top:r-t/2,left:i-t/2,state:"hidden"};return this.gestureIndicators.push(e),setTimeout(()=>{e.state="visible"},100),e}}};var fn=(()=>{let i=class i{transform(t,e){return`${e}${t??""}`}};i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=ut({name:"prefix",type:i,pure:!0});let n=i;return n})();var ki=(n,i)=>i.source.z+":"+i.source.x+":"+i.source.y;function Si(n,i){if(n&1&&(mt(),u(0,"title"),O(1),_(2,"translate"),f()),n&2){let r=M().$implicit;m(),T(C(2,1,r.url))}}function Li(n,i){if(n&1){let r=R();mt(),u(0,"g",12),y("mouseup",function(e){let o=b(r).$implicit,s=M();return w(s.onClickUp(e,o))})("touchend",function(e){let o=b(r).$implicit,s=M();return w(s.onTouchTileEnd(e,o))}),u(1,"g",13),L(2,Si,3,3,":svg:title"),k(3,"rect",14)(4,"rect",15)(5,"use",16),_(6,"prefix"),k(7,"use",17),f()()}if(n&2){let r=i.$implicit,t=M();A("selected",r.source.selected)("hidden",r.source.picked)("hinted",r.source.hinted)("wiggle",r.source.effects==null?null:r.source.effects.wiggle),at("transform",r.pos.translate),m(2),E(r.url?2:-1),m(3),at("href",xe(6,15,r.url,t.urlPrefix),null,"xlink")("x",t.imagePos[0])("y",t.imagePos[1])("width",t.imagePos[2])("height",t.imagePos[3])}}function Ei(n,i){if(n&1&&k(0,"div",18),n&2){let r=i.$implicit;Tt("top",r.top,"px")("left",r.left,"px")("width",r.size,"px")("height",r.size,"px")("transform",r.transform),A("visible",r.state==="visible")}}var se=1470,ae=960;function ce(n,i,r){return Math.min(Math.max(i,n),r)}var _n=(()=>{let i=class i{constructor(){this.background=H(),this.imageSet=H(),this.kyodaiUrl=H(),this.stones=H(),this.clickEvent=et(),this.indicators=new Ut,this.drawStones=[],this.rotate=!1,this.transformSVG="",this.transformStage="",this.viewport=`0 0 ${se} ${ae}`,this.prefix="",this.urlPrefix="",this.imagePos=[1,1,69,88],this.imageCut=[0,0,65,90],this.scale=1,this.panX=0,this.panY=0,this.bounds=[0,0,se,ae],this.lastPinch=0,this.touchPoints=[],this.initialDistance=0,this.initialScale=1,this.lastTouchX=0,this.lastTouchY=0,this.initialTouchX=0,this.initialTouchY=0,this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.lastMouseX=0,this.lastMouseY=0,this.initialMouseX=0,this.initialMouseY=0,this.isPanning=!1,this.isPinching=!1,this.app=S(lt),this.element=S(ft)}ngOnInit(){this.resize(window)}ngOnChanges(t){if(t.stones&&this.updateStones(t.stones.currentValue),t.background&&this.updateBackground(t.background.currentValue),t.imageSet){this.prefix=`b_${t.imageSet.currentValue}_`,this.urlPrefix=`#b_${t.imageSet.currentValue}_`;let e=je(t.imageSet.currentValue);this.imagePos=e?[0,0,75,100]:[6,6,63,88],this.imageCut=e?[0,0,75,100]:[0,0,65,90]}}onWheel(t){t.preventDefault();let o=(t.deltaY<0?1:-1)===1?this.scale+.15:this.scale-.15;this.zoomSVGValue(o,t.clientX,t.clientY);let s=this.indicators.display(t.clientX,t.clientY,o*10);this.indicators.hide(s)}onResize(t){let e=t.target;e&&this.resize(e)}onMouseDown(t){this.scale>1&&(t.preventDefault(),this.lastMouseX=t.clientX,this.lastMouseY=t.clientY,this.initialMouseX=t.clientX,this.initialMouseY=t.clientY)}onMouseMove(t){if(this.scale>1){if(!this.isPanning&&this.initialMouseX!==0&&this.initialMouseY!==0){let e=t.clientX-this.initialMouseX,o=t.clientY-this.initialMouseY;Math.hypot(e,o)>=10&&(this.isPanning=!0)}this.isPanning&&(t.preventDefault(),this.updatePanning(t))}}onMouseUp(t){let e=t.type==="mouseleave";this.isPanning?(t.preventDefault(),this.updatePanning(t)):e||this.clickEvent.emit(void 0),this.stopPanning()}onTouchTileEnd(t,e){this.hasPinchChanged||this.hasTouchPanMoved||this.clickEvent.emit(e?.source)}onClickUp(t,e){this.initialMouseX=0,this.initialMouseY=0,this.isPanning?(this.updatePanning(t),this.stopPanning()):(this.clickEvent.emit(e?.source),t.stopPropagation())}onTouchStart(t){t.preventDefault(),this.touchPoints=[],this.hasTouchPanMoved=!1,this.hasPinchChanged=!1;let e=Array.from(t.touches);for(let o of e)this.touchPoints.push({x:o.clientX,y:o.clientY,identifier:o.identifier});if(this.touchPoints.length===1)this.lastTouchX=this.touchPoints[0].x,this.lastTouchY=this.touchPoints[0].y,this.initialTouchX=this.touchPoints[0].x,this.initialTouchY=this.touchPoints[0].y,this.isPanning=!0;else if(this.touchPoints.length===2){this.isPanning=!1,this.isPinching=!0,this.initialDistance=this.getDistance(this.touchPoints[0],this.touchPoints[1]),this.initialScale=this.scale;let o=(this.touchPoints[0].x+this.touchPoints[1].x)/2,s=(this.touchPoints[0].y+this.touchPoints[1].y)/2;this.indicators.gestureIndicators=[],this.indicators.display(o,s,30),this.lastPinch=Date.now()}}onTouchMove(t){t.preventDefault(),this.touchPoints=[];let e=Array.from(t.touches);for(let o of e)this.touchPoints.push({x:o.clientX,y:o.clientY,identifier:o.identifier});if(this.isPinching&&this.touchPoints.length===2){let s=this.getDistance(this.touchPoints[0],this.touchPoints[1])/this.initialDistance;this.indicators.setSize(0,Math.min(30*s,80)),Math.abs(s-1)>=.1&&(this.hasPinchChanged=!0),this.lastPinch=Date.now()}else if(this.isPanning&&this.touchPoints.length===1&&this.scale>1&&Date.now()-this.lastPinch>600){let o=this.touchPoints[0].x-this.lastTouchX,s=this.touchPoints[0].y-this.lastTouchY,a=this.indicators.display(this.touchPoints[0].x,this.touchPoints[0].y,10);this.indicators.hide(a),this.setPanValue(this.panX+o,this.panY+s),this.lastTouchX=this.touchPoints[0].x,this.lastTouchY=this.touchPoints[0].y,Math.hypot(this.lastTouchX-this.initialTouchX,this.lastTouchY-this.initialTouchY)>=10&&(this.hasTouchPanMoved=!0)}}onTouchEnd(t){if(t.preventDefault(),this.isPinching){let o=this.indicators.gestureIndicators.at(0);o&&this.indicators.hide(o);let s=Array.from(t.touches).map(l=>({x:l.clientX,y:l.clientY,identifier:l.identifier})),a=Array.from(t.changedTouches).map(l=>({x:l.clientX,y:l.clientY,identifier:l.identifier})),c=[];if(s.length>=2?c.push(s[0],s[1]):s.length===1&&a.length>0?c.push(s[0],a[0]):a.length>=2&&c.push(a[0],a[1]),c.length===2){let d=this.getDistance(c[0],c[1])/this.initialDistance,p=this.initialScale;Math.abs(d-1)>=.1&&(p=this.initialScale*d);let g=(c[0].x+c[1].x)/2,v=(c[0].y+c[1].y)/2;this.zoomSVGValue(p,g,v)}this.isPinching=!1,this.lastPinch=Date.now()}else this.isPanning&&(this.updateTransform(),this.isPanning=!1);this.touchPoints=[];let e=Array.from(t.touches);for(let o of e)this.touchPoints.push({x:o.clientX,y:o.clientY,identifier:o.identifier});this.touchPoints.length===0&&(this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.initialTouchX=0,this.initialTouchY=0)}updatePanning(t){let e=t.clientX-this.lastMouseX,o=t.clientY-this.lastMouseY,s=this.indicators.display(t.clientX,t.clientY,10);this.indicators.hide(s),this.setPanValue(this.panX+e,this.panY+o),this.lastMouseX=t.clientX,this.lastMouseY=t.clientY,this.updateTransform()}stopPanning(){this.isPanning=!1,this.initialMouseX=0,this.initialMouseY=0}setPanValue(t,e){let o=this.element.nativeElement.offsetWidth||0,s=this.element.nativeElement.offsetHeight||0,a=50,c=Math.max(0,(this.scale-1)*o),l=Math.max(0,(this.scale-1)*s),d=-c-a,p=a,g=-l-a,v=a;this.panX=ce(t,d,p),this.panY=ce(e,g,v)}zoomSVGValue(t,e,o){let s=this.scale,a=ce(t,1,2);if(a!==s){if(a<1.01)this.scale=1,this.panX=0,this.panY=0;else{let c=(e-this.panX)/this.scale,l=(o-this.panY)/this.scale,d=e-c*a,p=o-l*a;this.scale=a,this.setPanValue(d,p)}this.updateTransform()}}updateViewPort(){window.requestAnimationFrame(()=>{this.setViewPort()})}updateTransform(){window.requestAnimationFrame(()=>{this.setTransform()})}setTransform(){let t=this.scale>1?` scale(${this.scale})`:"";this.transformSVG=`translate(${this.panX}px, ${this.panY}px)${t}`,this.transformStage=this.rotate?"rotate(90)":""}getDistance(t,e){let o=e.x-t.x,s=e.y-t.y;return Math.hypot(o,s)}resize(t){let e=t.innerHeight>t.innerWidth;this.panX=0,this.panY=0,this.scale=1,this.updateTransform(),e!==this.rotate&&(this.rotate=e,this.updateViewPort())}setViewPort(){this.viewport=Xe(this.bounds,this.rotate)}updateStones(t){if(!t)return;this.scale=1,this.panX=0,this.panY=0;let e=t.filter(o=>o!==void 0).map(o=>({z:o.z,x:o.x,y:o.y,v:o.v,visible:!0,url:o.img?.id,pos:$e(o.z,o.x,o.y),source:o,className:o.effects?.wiggle?"wiggle":void 0}));this.bounds=He(e,se,ae),this.drawStones=Ye(e),this.setViewPort(),this.setTransform()}webpSupported(){try{let t=document.createElement("canvas");return!t.getContext?.("2d")?!1:t.toDataURL("image/webp").startsWith("data:image/webp")}catch{return!1}}backgroundFormat(){return this.webpSupported()?"webp":"jpg"}updateBackground(t){let e=Ae.find(o=>o.img===t)?.img;this.backgroundUrl=e?`url("assets/img/${e}.${this.backgroundFormat()}")`:void 0}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-board"]],hostVars:2,hostBindings:function(e,o){e&1&&y("wheel",function(a){return o.onWheel(a)})("resize",function(a){return o.onResize(a)},Ce)("mousedown",function(a){return o.onMouseDown(a)})("mousemove",function(a){return o.onMouseMove(a)})("mouseup",function(a){return o.onMouseUp(a)})("mouseleave",function(a){return o.onMouseUp(a)})("touchstart",function(a){return o.onTouchStart(a)})("touchmove",function(a){return o.onTouchMove(a)})("touchend",function(a){return o.onTouchEnd(a)})("touchcancel",function(a){return o.onTouchEnd(a)}),e&2&&Tt("background-image",o.backgroundUrl)},inputs:{background:[1,"background"],imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],stones:[1,"stones"]},outputs:{clickEvent:"clickEvent"},features:[ht],decls:17,vars:18,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid meet",1,"board-svg",3,"mouseup"],["id","mah-board-filter",2,"color-interpolation-filters","sRGB"],["in","SourceGraphic","stdDeviation","8"],["id","front","width","300","height","400","viewBox","0 0 300 400"],["d","m 151.73588,1025.0177 c -3.32683,-9.3138 -10.24843,-68.45389 5.31821,-90.62655 20.27717,-26.12032 219.43558,-16.45796 231.55506,-9.93184 11.07433,5.31702 -178.60366,0.0589 -204.85126,34.86646 -21.59349,30.0006 -26.50086,82.17843 -32.02201,65.69193 z","transform","rotate(180,229,666.5)",2,"fill","#000000","fill-opacity","0.15","fill-rule","evenodd","stroke","none","filter","url(#mah-board-filter)"],["transform","translate(28,-614)","d","M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z",2,"fill","#ffffff","fill-opacity","0.4","fill-rule","evenodd","stroke","none","filter","url(#mah-board-filter)"],["id","mah-image-clip"],["rx","10","ry","10","fill","#fff"],["app-image-set-loader","",3,"imageSet","kyodaiUrl","dark","prefix"],[1,"stage"],[1,"draw",3,"selected","hidden","hinted","wiggle"],[1,"gesture-indicator",3,"top","left","width","height","transform","visible"],[1,"draw",3,"mouseup","touchend"],[1,"tile"],["x","3","y","3","width","75","height","100","rx","10","ry","10",1,"shadow"],["x","0","y","0","width","75","height","100","rx","10","ry","10",1,"stone"],["clip-path","url(#mah-image-clip)"],[0,"xlink","href","#front","x","0","y","0","width","75","height","100"],[1,"gesture-indicator"]],template:function(e,o){e&1&&(mt(),u(0,"svg",0),y("mouseup",function(a){return o.onMouseUp(a)}),u(1,"defs")(2,"filter",1),k(3,"feGaussianBlur",2),f(),u(4,"svg",3),k(5,"path",4)(6,"path",5),f(),u(7,"clipPath",6),k(8,"rect",7),f()(),u(9,"style"),O(10," g.tile { transform-origin: 50px 32.5px; opacity: 1; transition: transform 120ms ease-in-out; } @keyframes mah-wiggle { 0% { transform: rotate(0deg); } 20% { transform: rotate(-3deg); } 40% { transform: rotate(3deg); } 60% { transform: rotate(-1deg); } 80% { transform: rotate(1deg); } 100% { transform: rotate(0deg); } } g.wiggle g.tile { animation: mah-wiggle 250ms ease-in-out; } g.hinted g.tile { transform: scale(1.12); } g.hinted g.tile > rect { stroke: #9f0000; stroke-width: 3px; } @keyframes mah-select-pop { 0% { transform: scale(1); } 60% { transform: scale(1.08); } 100% { transform: scale(1.04); } } g.selected g.tile { transform: scale(1.04); animation: mah-select-pop 140ms ease-out; } g.selected g.tile rect.stone { stroke: black; fill: #F8EABB; } g.selected.hinted g.tile { transform: scale(1.14); animation: none; } g.selected.hinted g.tile rect.stone { stroke: #9f0000; stroke-width: 3px; } g.draw rect.shadow { fill: #191919; opacity: 0.6; stroke-width: 1; stroke: black; } g.draw rect.stone { fill: #FFF9E5; stroke-width: 1; stroke: black; } g.hidden { opacity: 0; } g.stage.contrast g.draw rect.stone { stroke-width: 2; } g.stage.contrast g.draw rect.shadow { opacity: 0.7; } g.stage.dark g.draw rect.shadow { opacity: 0.6; stroke-width: 1; fill: #9d948c; stroke: green; } g.stage.dark g.draw rect.stone { fill: #000; stroke-width: 1; stroke: #9d948c; } g.stage.dark g.selected g.tile rect.stone { stroke: #F8EABB; fill: black; } g.stage.dark g.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark g.selected.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark.contrast g.draw rect.stone { stroke-width: 2; } g.stage.dark.contrast g.draw rect.shadow { opacity: 0.7; } @media (prefers-reduced-motion: reduce) { g.tile { transition: none; } g.wiggle g.tile { animation: none; } g.selected g.tile { animation: none; } } "),f(),k(11,"defs",8),u(12,"g",9),W(13,Li,8,18,":svg:g",10,ki),f()(),W(15,Ei,1,12,"div",11,Q)),e&2&&(Tt("transform",o.transformSVG),A("rotate",o.rotate),at("viewBox",o.viewport),m(8),at("x",o.imageCut[0])("y",o.imageCut[1])("width",o.imageCut[2])("height",o.imageCut[3]),m(3),x("imageSet",o.imageSet())("kyodaiUrl",o.kyodaiUrl())("dark",o.app.settings.dark)("prefix",o.prefix),m(),A("dark",o.app.settings.dark)("contrast",o.app.settings.contrast),at("transform",o.transformStage),m(),Z(o.drawStones),m(2),Z(o.indicators.gestureIndicators))},dependencies:[We,fn,it],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;background-repeat:repeat;background-size:cover}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;transform-origin:0 0 0;transform:translate(0) scale(1);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .gesture-indicator[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;position:fixed;top:0;left:0;height:50px;width:50px;display:block;border-radius:50%;text-align:center;line-height:45px;z-index:10;background-color:var(--gesture-indicator);transform:scale(0);transition:transform .15s ease-in-out}[_nghost-%COMP%]   .gesture-indicator.visible[_ngcontent-%COMP%]{transform:scale(1.5)}"]});let n=i;return n})();var Cn=(()=>{let i=class i{transform(t){return t===Jt}};i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=ut({name:"gameModeEasy",type:i,pure:!0});let n=i;return n})(),Mn=(()=>{let i=class i{transform(t){return t===Jt||t===Re}};i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=ut({name:"gameModeStandard",type:i,pure:!0});let n=i;return n})();var Ti=["info"],Bi=["settings"],Di=["help"],Ii=["newgame"],Vi=()=>[import("./chunk-VDNYULSA.js").then(n=>n.HelpComponent)],Fi=()=>[import("./chunk-HLBM2V6H.js").then(n=>n.TilesInfoComponent)],Ri=()=>[import("./chunk-K24RWGVL.js").then(n=>n.SettingsComponent)];function Gi(n,i){if(n&1){let r=R();u(0,"button",23),_(1,"translate"),y("click",function(){b(r);let e=M();return w(e.enterFullScreen())}),k(2,"i",38),f()}n&2&&x("title",G(C(1,2,"FULLSCREEN")))}function Ai(n,i){n&1&&k(0,"app-help")}function Ni(n,i){n&1&&(wt(0,Ai,1,0),kt(1,0,Vi),St())}function $i(n,i){n&1&&k(0,"app-tiles-info")}function Yi(n,i){n&1&&(wt(0,$i,1,0),kt(1,0,Fi),St())}function Xi(n,i){n&1&&k(0,"app-settings")}function Hi(n,i){n&1&&(wt(0,Xi,1,0),kt(1,0,Ri),St())}function Ui(n,i){if(n&1){let r=R();u(0,"app-choose-layout",39),y("startEvent",function(e){b(r);let o=M();return w(o.startGame(e))}),f()}if(n&2){let r=M();x("gameMode",r.game.mode)}}function zi(n,i){if(n&1&&(u(0,"div"),O(1),_(2,"translate"),f()),n&2){let r=M(2);m(),T(C(2,1,r.game.message.messageID))}}function ji(n,i){if(n&1&&(u(0,"div"),O(1),_(2,"duration"),f()),n&2){let r=M(2);m(),T(C(2,1,r.game.message.playTime))}}function qi(n,i){if(n&1){let r=R();u(0,"div",40),y("click",function(){b(r);let e=M();return w(e.clickMessage())}),L(1,zi,3,3,"div"),L(2,ji,3,3,"div"),f()}if(n&2){let r=M();m(),E(r.game.message.messageID?1:-1),m(),E(r.game.message.playTime?2:-1)}}var Pn=(()=>{let i=class i{constructor(){this.info=nt.required("info"),this.settings=nt.required("settings"),this.help=nt.required("help"),this.newgame=nt.required("newgame"),this.app=S(lt),this.fullScreenEnabled=!0,this.title="",this.workerService=S(Rt),this.game=this.app.game,this.fullScreenEnabled=this.canFullscreen(),this.title=`${this.app.name} v${J.version}`}showNewGame(){this.newgame().visible.set(!0)}handleKeyDownEventKey(t){switch(t){case"h":{this.help().toggle();break}case"i":{this.info().toggle();break}case"s":{this.settings().toggle();break}case"t":{this.game.hint();break}case"m":{this.game.shuffle();break}case"g":{this.debugSolve();break}case"u":{this.game.back();break}case"n":{this.game.pause(),this.newgame().toggle();break}case" ":case"space":case"Space":case"spacebar":case"Spacebar":case"p":{this.game.isRunning()?this.game.pause():this.game.isPaused()&&this.game.resume();break}default:return!1}return!0}handleKeyDownDialogExit(){let t=this.help();if(t.visible())return t.toggle(),!0;let e=this.newgame();if(e.visible())return e.toggle(),!0;let o=this.info();if(o.visible())return o.toggle(),!0;let s=this.settings();return s.visible()?(s.toggle(),!0):!1}handleKeyDownEvent(t){t.key==="Escape"&&this.handleKeyDownDialogExit()||(t.target?.nodeName??"").toLocaleLowerCase()==="input"||this.handleKeyDownEventKey(t.key)&&t.preventDefault()}stoneClick(t){this.game.click(t)}isFullscreenEnabled(){let t=window.document;if(typeof t.fullscreenEnabled=="boolean")return t.fullscreenEnabled;let e=document.documentElement;return!!(e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen)}canFullscreen(){return J.mobile?!1:this.isFullscreenEnabled()}isFullscreen(){let t=window.document;return!!(t.fullscreenElement||t.webkitIsFullScreen||t.mozFullScreen)}exitFullscreen(){let t=window.document;t.exitFullscreen?t.exitFullscreen().catch(e=>{console.error(e)}):t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}requestFullscreen(){let t=document.body;t.requestFullscreen?t.requestFullscreen().catch(e=>{console.error(e)}):t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen&&t.mozRequestFullScreen()}enterFullScreen(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()}newGame(){this.game.pause(),this.showNewGame()}startGame(t){this.newgame().visible.set(!1),this.game.reset(),this.game.start(t.layout,t.buildMode,t.gameMode)}toggleDialogState(t){t?this.app.game.isPaused()||this.app.game.pause():(this.app.settings.save(),this.app.game.isPaused()&&this.app.game.resume())}clickMessage(){this.game.isPaused()?this.game.resume():(this.game.reset(),this.showNewGame())}debugSolve(){if(J.production)return;let t=(e,o)=>{let s=o[e],a=o[e+1];if(!s||!a)return;let c=this.game.board.stones.filter(l=>l.z===s[0]&&l.x===s[1]&&l.y===s[2]||l.z===a[0]&&l.x===a[1]&&l.y===a[2]);if(c.length>1){for(let l of c)l.selected=!0;setTimeout(()=>{this.game.board.pick(c[0],c[1]),t(e+2,o)},300)}};this.workerService.solveGame(this.game.board.stones.filter(e=>!e.picked).map(e=>e.toPosition()),e=>{t(0,e.order)})}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-game-component"]],viewQuery:function(e,o){e&1&&(tt(o.info,Ti,5),tt(o.settings,Bi,5),tt(o.help,Di,5),tt(o.newgame,Ii,5)),e&2&&_t(4)},hostBindings:function(e,o){e&1&&y("keydown",function(a){return o.handleKeyDownEvent(a)},yt)},decls:90,vars:100,consts:[["help",""],["info",""],["settings",""],["newgame",""],[1,"controls","controls-top"],[1,"ctrl","ctrl-name"],[1,"link","button",3,"click","title"],[1,"icon-logo"],[1,"name"],[1,"ctrl","ctrl-game"],[1,"icon-pause"],[1,"label"],[1,"link","button","feature",3,"click","title"],[1,"icon-spin1"],[1,"icon-undo"],[1,"icon-lightbulb"],[1,"icon-loop"],[1,"board",3,"clickEvent","stones","imageSet","kyodaiUrl","background"],[1,"controls","controls-bottom"],[1,"ctrl","ctrl-stats"],["title","Menu","aria-haspopup","true",1,"link","button","menu-button"],[1,"icon-menu"],["role","menu",1,"menu"],["role","menuitem",1,"link","button",3,"click","title"],[1,"icon-cog"],[1,"icon-volume-low"],[1,"icon-calendar"],["role","menuitem",1,"link","button",3,"title"],[1,"ctrl","ctrl-time"],[1,"label","button","text"],[1,"time"],["className","overlay-help",3,"clickEvent","title"],["className","overlay-info",3,"clickEvent","title"],["className","overlay-settings",3,"clickEvent","title"],["className","overlay-newgame",3,"clickEvent","title"],[1,"choose",3,"gameMode"],["className","overlay-message",3,"clickEvent","visible","noClose"],[1,"overlay-message-message"],[1,"icon-resize-full-alt"],[1,"choose",3,"startEvent","gameMode"],[1,"overlay-message-message",3,"click"]],template:function(e,o){if(e&1){let s=R();u(0,"div",4)(1,"div",5)(2,"button",6),_(3,"translate"),y("click",function(){b(s);let c=ct(74);return w(c.toggle())}),k(4,"i",7),u(5,"span",8),O(6),f()()(),u(7,"div",9)(8,"button",6),_(9,"translate"),y("click",function(){return b(s),w(o.game.toggle())}),k(10,"i",10),u(11,"span",11),O(12),_(13,"translate"),f()(),u(14,"button",12),_(15,"gameModeEasy"),_(16,"translate"),y("click",function(){return b(s),w(o.game.shuffle())}),k(17,"i",13),u(18,"span",11),O(19),_(20,"translate"),f()(),u(21,"button",12),_(22,"gameModeStandard"),_(23,"translate"),y("click",function(){return b(s),w(o.game.back())}),k(24,"i",14),u(25,"span",11),O(26),_(27,"translate"),f()(),u(28,"button",12),_(29,"gameModeStandard"),_(30,"translate"),y("click",function(){return b(s),w(o.game.hint())}),k(31,"i",15),u(32,"span",11),O(33),_(34,"translate"),f()(),u(35,"button",6),_(36,"translate"),y("click",function(){return b(s),w(o.newGame())}),k(37,"i",16),u(38,"span",11),O(39),_(40,"translate"),f()()()(),u(41,"app-board",17),y("clickEvent",function(c){return b(s),w(o.stoneClick(c))}),f(),u(42,"div",18)(43,"div",19)(44,"button",20),k(45,"i",21),f(),u(46,"div",22)(47,"button",23),_(48,"translate"),y("click",function(){b(s);let c=ct(81);return w(c.toggle())}),k(49,"i",24),f(),u(50,"button",23),_(51,"translate"),y("click",function(){return b(s),w(o.app.toggleSound())}),k(52,"i",25),f(),u(53,"button",23),_(54,"translate"),y("click",function(){b(s);let c=ct(77);return w(c.toggle())}),k(55,"i",26),f(),L(56,Gi,3,4,"button",27),f()(),u(57,"div",28)(58,"span",29)(59,"small"),O(60),_(61,"translate"),f(),u(62,"span"),O(63),f()(),u(64,"span",29)(65,"small"),O(66),_(67,"translate"),f(),u(68,"span"),O(69),f()(),u(70,"span",30),O(71),_(72,"duration"),f()()(),u(73,"app-dialog",31,0),y("clickEvent",function(c){return b(s),w(o.toggleDialogState(c))}),L(75,Ni,3,0),f(),u(76,"app-dialog",32,1),_(78,"translate"),y("clickEvent",function(c){return b(s),w(o.toggleDialogState(c))}),L(79,Yi,3,0),f(),u(80,"app-dialog",33,2),_(82,"translate"),y("clickEvent",function(c){return b(s),w(o.toggleDialogState(c))}),L(83,Hi,3,0),f(),u(84,"app-dialog",34,3),_(86,"translate"),y("clickEvent",function(c){return b(s),w(o.toggleDialogState(c))}),L(87,Ui,1,1,"app-choose-layout",35),f(),u(88,"app-dialog",36),y("clickEvent",function(){return b(s),w(o.clickMessage())}),L(89,qi,3,2,"div",37),f()}if(e&2){let s=ct(74),a=ct(77),c=ct(81),l=ct(85);m(2),x("title",G(C(3,54,"OPEN_HELP"))),m(4),T(o.app.name),m(2),x("title",G(C(9,56,"PAUSE_LONG"))),m(4),T(C(13,58,"PAUSE")),m(2),A("enabled",C(15,60,o.game.mode)),x("title",G(C(16,62,"SHUFFLE_LONG"))),m(5),T(C(20,64,"SHUFFLE")),m(2),A("enabled",C(22,66,o.game.mode)),x("title",G(C(23,68,"UNDO_LONG"))),at("disabled",o.game.board.undo.length===0?!0:null),m(5),T(C(27,70,"UNDO")),m(2),A("enabled",C(29,72,o.game.mode)),x("title",G(C(30,74,"HINT_LONG"))),m(5),T(C(34,76,"HINT")),m(2),x("title",G(C(36,78,"RESTART_LONG"))),m(4),T(C(40,80,"RESTART")),m(2),x("stones",o.game.board.stones)("imageSet",o.app.settings.tileset)("kyodaiUrl",o.app.settings.kyodaiUrl)("background",o.app.settings.background),m(6),x("title",G(C(48,82,"OPEN_SETTINGS"))),m(3),A("inactive",!o.app.settings.sounds),x("title",G(C(51,84,"AUDIO_SOUNDS"))),m(3),x("title",G(C(54,86,"TILES_INFO"))),m(3),E(o.fullScreenEnabled?56:-1),m(4),U("",C(61,88,"STONES"),":"),m(3),T(o.game.board.count),m(3),U("",C(67,90,"FREE"),":"),m(3),T(o.game.board.free.length),m(2),T(C(72,92,o.game.clock.elapsed)),m(2),x("title",o.title),m(2),E(s.visible()?75:-1),m(),x("title",C(78,94,"TILES")),m(3),E(a.visible()?79:-1),m(),x("title",C(82,96,"SETTINGS")),m(3),E(c.visible()?83:-1),m(),x("title",C(86,98,"SELECT_BOARD")),m(3),E(l.visible()?87:-1),m(),x("visible",!!o.game.message)("noClose",!0),m(),E(o.game.message?89:-1)}},dependencies:[_n,hn,Ze,Gt,Mn,Cn,it],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column nowrap;width:100%;background-color:var(--main-bg-color);height:100vh;height:100svh}.dkgreen[_nghost-%COMP%]{--main-bg-color: #19262e;--main-bg-color-lt: #22353f;--main-bg-color-dk: #142026}.dkblue[_nghost-%COMP%]{--main-bg-color: #001552;--main-bg-color-lt: #22353f;--main-bg-color-dk: #142026;--main-text-color: #fff;--main-text-color-lt: #ffe9c0;--main-text-color-dk: #dcdbdb;--dialog-text-color: #001552}.ltblue[_nghost-%COMP%]{--main-bg-color: #34385a;--main-bg-color-lt: #22353f;--main-bg-color-dk: #142026;--main-text-color: #fff;--main-text-color-lt: #ffe9c0;--main-text-color-dk: #dcdbdb;--dialog-text-color: #34385a}.white[_nghost-%COMP%]{--main-bg-color: #fff;--main-bg-color-lt: #b9b9b9;--main-bg-color-dk: #f6f5f5;--main-text-color: #000;--main-text-color-lt: #646464;--main-text-color-dk: #8c8c8c;--dialog-text-color: #000}.brown[_nghost-%COMP%]{--main-bg-color: brown;--main-bg-color-lt: #ad2d2d;--main-bg-color-dk: #982626;--main-text-color: #fff;--main-text-color-lt: #ffe9c0;--main-text-color-dk: #dcdbdb;--dialog-text-color: #601616}.black[_nghost-%COMP%]{--main-bg-color: #000;--main-bg-color-lt: #3a3a3a;--main-bg-color-dk: #171717}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{min-width:170px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .feature.enabled[_ngcontent-%COMP%]{display:unset}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{display:inline-block;color:var(--main-text-color);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{text-decoration:none;font-weight:400;color:var(--main-text-color);margin-left:16px;padding:.2em .8em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:2px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--main-text-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[disabled][_ngcontent-%COMP%]{color:var(--main-text-color-dk)}@media only screen and (min-width: 400px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{margin-left:10px}}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;border-color:transparent;border-radius:3px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border-color:var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]{font-weight:600;cursor:pointer}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]   .icon-logo[_ngcontent-%COMP%]{color:red}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]   span.name[_ngcontent-%COMP%]{margin-left:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]:hover{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-game[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]{cursor:default;float:right;padding-right:12px;padding-top:2px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-right:26px;font-variant-numeric:lining-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{min-width:98px;display:inline-block;text-align:right;font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-left:10px}@media only screen and (min-width: 500px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-game[_ngcontent-%COMP%]{padding-right:8px}}@media only screen and (min-width: 700px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.2em}}@media only screen and (min-width: 1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.3em}}@media only screen and (min-width: 1900px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.6em}}@media only screen and (min-width: 2200px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:2.3em}}@media only screen and (min-width: 3000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:4em}}@media only screen and (max-width: 1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.3em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{padding:.2em}}@media only screen and (max-width: 700px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   span.label[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width: 500px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{padding:0 6px}}@media only screen and (max-width: 400px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{padding:.2em;margin-left:2px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   span.name[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{min-width:80px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{margin-left:0}}@media only screen and (max-width: 280px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:18px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl-game[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{padding-left:.1em;padding-right:.1em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{min-width:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   span.name[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:none;position:absolute;bottom:100%;right:0;background:var(--dialog-background-color);border:1px solid var(--dialog-border-color);border-radius:8px;flex-direction:column;z-index:10}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{padding:.5em;margin-left:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:hover   .menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:focus-within   .menu[_ngcontent-%COMP%]{display:flex}}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{border-bottom:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{border-top:1px solid var(--main-bg-color-lt);margin-bottom:4px}[_nghost-%COMP%]   .board[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1;overflow:hidden}@media only screen and (width >= 400px) and (height <= 600px){[_nghost-%COMP%]{flex-direction:row;padding-left:52px;padding-right:52px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{float:unset!important;text-align:center}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:32px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{display:block;margin-left:0;margin-bottom:10px;padding-left:0;padding-right:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature.enabled[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{min-width:unset;max-width:52px;padding:0;display:flex;flex-direction:column;height:100%;position:absolute;left:0;justify-content:space-between}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]   .ctrl.ctrl-game[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]   .ctrl.ctrl-game[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-of-type{margin-bottom:2px}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]   span.name[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]   span.label[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{min-width:98px;max-width:98px;display:flex;flex-direction:column;height:100%;position:absolute;right:0;padding:0;align-items:flex-end}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;text-align:right}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end;padding-right:6px;padding-left:6px}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{text-align:right;min-width:0}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:right;margin-right:0;margin-bottom:8px}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;margin-right:0;line-height:.9em}}@media only screen and (width >= 400px) and (height <= 300px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{margin-bottom:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}}"]});let n=i;return n})();var Wi=["gameComponent"],Zi=["editorPlaceholder"];function Ki(n,i){if(n&1&&k(0,"app-game-component",3,1),n&2){let r=M();Bt(r.app.settings.theme),x("hidden",r.loading)}}function Qi(n,i){}var vn=(()=>{let i=class i{constructor(){this.gameComponent=nt.required("gameComponent"),this.editorPlaceholder=nt.required("editorPlaceholder",{read:qt}),this.app=S(lt),this.loading=!0,this.editorVisible=!1,this.layoutService=S(ot),this.meta=S(Te),this.updateName(),this.registerWindowListeners()}ngOnInit(){this.init().catch(t=>{console.error(t)})}handleKeyDownEvent(t){(t.target?.nodeName??"").toLocaleLowerCase()!=="input"&&J.editor&&t.key==="e"&&(this.toggleEditor(),t.preventDefault())}loadEditor(){J.editor&&import("./chunk-YUXKH4JE.js").then(({EditorComponent:t})=>{let e=this.editorPlaceholder().createComponent(t);this.editorSubscription=e.instance.closeEvent.subscribe(()=>{this.toggleEditor()})}).catch(t=>{console.error(t)})}toggleEditor(){J.editor&&(this.editorVisible=!this.editorVisible,this.editorVisible?(this.app.game.pause(),this.loadEditor()):(this.editorSubscription&&(this.editorSubscription.unsubscribe(),this.editorSubscription=void 0),this.editorPlaceholder().clear()))}init(){return zt(this,null,function*(){yield this.layoutService.get(),this.loading=!1;let t=new URLSearchParams(window.location.search),e=yield this.checkImport(t.get("mah"));this.layoutService.selectBoardID=e[0]||t.get("board"),window.location.search&&this.clearSearchParameters(),(this.app.game.isIdle()||this.layoutService.selectBoardID)&&this.gameComponent().showNewGame()})}clearSearchParameters(){try{window.history.replaceState(null,"",window.location.pathname)}catch(t){console.error(t)}}checkImport(t){return zt(this,null,function*(){if(!t)return[];try{let e=[],o=JSON.parse(atob(t)),s=[];for(let a of o.boards){let c=this.layoutService.expandLayout(a,!0);e.push(c.id),!this.layoutService.layouts.items.some(l=>l.id===c.id)&&!s.some(l=>l.id===c.id)&&s.push(ot.layout2loadLayout(c,a.map))}return s.length>0&&this.layoutService.storeCustomBoards(s),e}catch(e){return console.error(e),[]}})}registerWindowListeners(){window.addEventListener("beforeunload",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1),window.addEventListener("blur",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1)}updateName(){let t=this.meta.getTag("name=application-name");this.app.name=t?t.content:this.app.name}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=q({type:i,selectors:[["app-root"]],viewQuery:function(e,o){e&1&&(tt(o.gameComponent,Wi,5),tt(o.editorPlaceholder,Zi,5,qt)),e&2&&_t(2)},hostBindings:function(e,o){e&1&&y("keydown",function(a){return o.handleKeyDownEvent(a)},yt)},decls:3,vars:1,consts:[["editorPlaceholder",""],["gameComponent",""],[3,"hidden","class"],[3,"hidden"]],template:function(e,o){e&1&&(L(0,Ki,2,3,"app-game-component",2),Me(1,Qi,0,0,"ng-template",null,0,ye)),e&2&&E(o.editorVisible?-1:0)},dependencies:[Pn],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100vh;height:100svh}"]});let n=i;return n})();var le=new he("TRANSLATE_HTTP_LOADER_CONFIG"),Ji=(()=>{class n{http;config;constructor(){this.config=de({prefix:"/assets/i18n/",suffix:".json",enforceLoading:!1,useHttpBackend:!1},S(le)),this.http=this.config.useHttpBackend?new Vt(S(Qt)):S(Vt)}getTranslation(r){let t=this.config.enforceLoading?`?enforceLoading=${Date.now()}`:"";return this.http.get(`${this.config.prefix}${r}${this.config.suffix}${t}`)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();function On(n={}){let i=n.useHttpBackend??!1;return[{provide:le,useValue:n},{provide:Be,useClass:Ji,deps:[i?Qt:Vt,le]}]}J.production&&void 0;ke(vn,{providers:[fe(Se,be,...J.modules),Ie({loader:On({prefix:"./assets/i18n/",suffix:".json"}),fallbackLang:"en"}),lt,ot,Rt,Ct,qe,Le(Ee())]}).catch(console.error);
