import{$ as Le,$a as $t,A as et,Aa as Ie,B as xe,Ba as kn,C as fn,Ca as Sn,D as Ve,Da as En,E as ee,Ea as Tn,F as T,Fa as De,G as L,Ga as te,Ha as Ln,I as U,J as F,Ja as In,K as N,Ka as Dn,L as P,La as ot,M as g,Ma as Bn,N as h,Na as rt,O as S,P as D,Pa as ce,Q as B,Qa as Ne,R as le,Ra as An,S as $,Sa as Ft,T as tt,Ta as Vn,U as v,Ua as Nt,V as ge,Va as ze,W as M,Wa as Rn,X as Cn,Xa as at,Y as Mn,Ya as Fn,Z as Ee,Za as st,_ as Te,_a as Re,a as sn,aa as nt,ab as Nn,b as pe,ba as Q,bb as jt,c as ln,ca as fe,cb as Gt,d as cn,da as f,db as $n,e as dn,ea as O,eb as lt,f as pn,fa as z,fb as jn,g as Me,ga as Ue,gb as Be,h as gn,ha as j,hb as Ht,i as k,ia as J,j as hn,k as x,l as y,la as u,lb as Gn,m as K,ma as _,mb as Hn,n as He,na as Pn,nb as Ut,o as At,oa as On,p as Se,pa as Oe,pb as Un,q as Pe,qa as V,qb as Ce,r as mn,ra as me,rb as ct,s as un,sa as it,sb as zn,t as Qe,ta as bn,u as _n,ub as Yn,v as Je,va as vn,wa as xn,x as l,xa as yn,y as Vt,ya as wn,z as H,za as Rt}from"./chunk-535DRCYB.js";var $e={APP_VERSION:"1.16.0",APP_NAME:"Mah",APP_FEATURE_EDITOR:!0,APP_FEATURE_KYODAI:!0,APP_FEATURE_MOBILE:!1};var ne={production:!0,version:$e.APP_VERSION,name:$e.APP_NAME,mobile:$e.APP_FEATURE_MOBILE,editor:$e.APP_FEATURE_EDITOR,kyodai:$e.APP_FEATURE_KYODAI,modules:[],openExternal:void 0};var dt=class{constructor(){this.free=[],this.stones=[],this.count=0,this.hints={groups:[],current:void 0},this.selected=void 0,this.undo=[]}clearSelection(){this.selected&&(this.selected.selected=!1),this.selected=void 0}setStoneSelected(o){this.clearSelection(),o&&(o.selected=!0,this.selected=o)}clearHints(){if(this.hints.current)for(let o of this.hints.current.stones)o.hinted=!1;this.hints={groups:[],current:void 0}}hint(){if(this.hintNext()||(this.clearHints(),this.free.length===0))return;let o=this.collectHints();if(this.selected){let t=this.selected.groupNr;o.sort((n,r)=>n.group===t?-1:r.group===t?1:0)}let e=o[0];this.hints={groups:o,current:e};for(let t of e.stones)t.hinted=!0}reset(){this.clearSelection(),this.clearHints(),this.free=[],this.count=0,this.stones=[],this.undo=[]}canRemove(o){return o.group.some(e=>!e.picked&&!e.isBlocked())}update(){let o=[],e=0;for(let t of this.stones)t.state={blocked:!t.picked&&t.isBlocked(),removable:!1},e+=t.picked?0:1;for(let t of this.stones)t.state.removable=!t.picked&&!t.state.blocked&&this.canRemove(t),t.state.removable&&o.push(t);this.free=o,this.count=e}back(){if(this.undo.length<2)return;this.clearSelection(),this.clearHints();let o=this.undo.pop(),e=this.undo.pop();if(!(!o||!e)){for(let t of this.stones)(t.z===o[0]&&t.x===o[1]&&t.y===o[2]||t.z===e[0]&&t.x===e[1]&&t.y===e[2])&&(t.picked=!1);this.update()}}shuffle(){this.clearSelection(),this.clearHints();let o=this.stones.filter(c=>c.picked),e=this.stones.filter(c=>!c.picked),t=new jn(e),n=e.map(c=>[c.z,c.x,c.y]),a=new rt(t).build(ot,n);if(!a)return;let s=[...a,...o];Dn.fillStones(s,new lt(this.stones.length)),this.stones=s,this.update()}load(o,e){if(!o)return;this.undo=e;let n=new rt(new lt(o.length+e.length)).load(o);if(n){for(let r of e){let a=In(n,r[0],r[1],r[2]);a&&(a.picked=!0)}this.stones=n,this.update()}}save(){return this.stones.map(o=>[o.z,o.x,o.y,o.v])}applyMapping(o,e){let t=new rt(new lt(o.length));this.stones=t.build(e,o)||[]}pick(o,e){this.clearSelection(),this.undo.push([o.z,o.x,o.y],[e.z,e.x,e.y]),this.clearHints(),o.picked=!0,e.picked=!0,this.update()}countUnblocked(){return this.stones.filter(o=>!o.picked&&!o.isBlocked()).length}hintNext(){if(!this.hints.current)return!1;for(let e of this.hints.current.stones)e.hinted=!1;let o=this.hints.groups.indexOf(this.hints.current);if(o>=0&&(o++,o>=this.hints.groups.length&&(o=0),o<this.hints.groups.length)){this.hints.current=this.hints.groups[o];for(let e of this.hints.current.stones)e.hinted=!0;return!0}return!1}collectHints(){let o={};for(let e of this.free){let t=e.groupNr.toString();o[t]=o[t]||[],o[t].push(e)}return Object.keys(o).map(e=>({group:o[e][0].groupNr,stones:o[e]}))}};var pt=class{constructor(){this.elapsed=0,this.lastTime=0,this.timer=void 0}start(){this.timer||(this.elapsed=this.elapsed||0)}reset(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0),this.lastTime=0,this.elapsed=0}run(){this.timer||(this.lastTime=Date.now(),this.timer=window.setTimeout(()=>{this.step()},1e3))}pause(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0,this.elapsed+=Date.now()-this.lastTime)}step(){let o=Date.now();this.elapsed+=o-this.lastTime,this.lastTime=o,this.timer=window.setTimeout(()=>{this.step()},1e3)}};function Kn(...i){return Ki.play(...i)}var Ki={volume:.3,sampleRate:44100,audioContext:new AudioContext,play:function(...i){return this.playSamples([this.buildSamples(...i)])},playSamples:function(i,o=1,e=1,t=0,n=!1){let r=i.length,a=i[0].length,s=this.audioContext.createBuffer(r,a,this.sampleRate),c=this.audioContext.createBufferSource();i.forEach((m,C)=>s.getChannelData(C).set(m)),c.buffer=s,c.playbackRate.value=e,c.loop=n;let d=this.audioContext.createGain();d.gain.value=this.volume*o,d.connect(this.audioContext.destination);let p=new StereoPannerNode(this.audioContext,{pan:t});return c.connect(p).connect(d),c.start(),c},buildSamples:function(i=1,o=.05,e=220,t=0,n=0,r=.1,a=0,s=1,c=0,d=0,p=0,m=0,C=0,E=0,w=0,A=0,I=0,R=1,X=0,W=0,ve=0){let Z=this.sampleRate,de=Math.PI*2,Tt=Math.abs,Lt=Yi=>Yi<0?-1:1,Ri=c*=500*de/Z/Z,Qt=e*=(1+o*2*Math.random()-o)*de/Z,Fi=0,Ni=0,$i=0,We=1,Fe,It=[],ke=0,se=0,_e=0,Dt,ji=2,Jt=de*Tt(ve)*2/Z,Bt=Math.cos(Jt),en=Math.sin(Jt)/2/ji,Ze=1+en,Gi=-2*Bt/Ze,Hi=(1-en)/Ze,tn=(1+Lt(ve)*Bt)/2/Ze,Ui=-(Lt(ve)+Bt)/Ze,zi=tn,nn=0,on=0,rn=0,an=0;for(t=t*Z||9,X*=Z,n*=Z,r*=Z,I*=Z,d*=500*de/Z**3,w*=de/Z,p*=de/Z,m*=Z,C=C*Z|0,i*=this.volume,Fe=t+X+n+r+I|0;se<Fe;It[se++]=_e*i)++$i%(A*100|0)||(_e=a?a>1?a>2?a>3?a>4?(ke/de%1<s/2)*2-1:Math.sin(ke**3):Math.max(Math.min(Math.tan(ke),1),-1):1-(2*ke/de%2+2)%2:1-4*Tt(Math.round(ke/de)-ke/de):Math.sin(ke),_e=(C?1-W+W*Math.sin(de*se/C):1)*(a>4?_e:Lt(_e)*Tt(_e)**s)*(se<t?se/t:se<t+X?1-(se-t)/X*(1-R):se<t+X+n?R:se<Fe-I?(Fe-se-I)/r*R:0),_e=I?_e/2+(I>se?0:(se<Fe-I?1:(Fe-se)/I)*It[se-I|0]/2/i):_e,ve&&(_e=an=zi*nn+Ui*(nn=on)+tn*(on=_e)-Hi*rn-Gi*(rn=an))),Dt=(e+=c+=d)*Math.cos(w*Fi++),ke+=Dt+Dt*E*Math.sin(se**5),We&&++We>m&&(e+=p,Qt+=p,We=0),C&&!(++Ni%C)&&(e=Qt,c=Ri,We||=1);return It},getNote:function(i=0,o=440){return o*2**(i/12)}};var be={NOPE:[],SELECT:[2,.2,400,,,.02,,3,-50,,,,,,16,,,,,,500,1],MATCH:[2,.2,800,,,.02,,3,-50,,,,,,16,,,,,,500,1],OVER:[2,,146,.02,.23,.04,3,2.47,-1.3,,,,,,-112,,.2,.99,.04],UNDO:[1,.1,260,.24,,.05,,.7,64,,135,.22,.01,.1,,,.07,,.01,.54],HINT:[1,.1,201,.09,.04,.08,1,1.87,,-25,,,,,55,,,.4,.01],SHUFFLE:[1,0,288,.05,.01,,,2,-10,,,,,,,,,.5,.1],WIN:[2,.05,6,.09,.14,.46,1,.28,0,0,-54,.09,.06,0,0,0,.15,.54,.04,0]},gt=class{constructor(){this.enabled=!0}play(o){if(this.enabled)try{Kn(...o)}catch{}}};var ht=class{constructor(){this.enabled=!1}play(){}pause(){}toggle(){}toggleMusic(){}};var mt="random-";var ut=class{constructor(o){this.storage=o,this.clock=new pt,this.board=new dt,this.sound=new gt,this.music=new ht,this.state=ce.idle,this.layoutID=void 0,this.mode=Nt,this.saveTimer=void 0}init(){this.load(),this.board.update(),this.state===ce.run&&this.pause(),this.message={messageID:this.isPaused()?"MSG_CONTINUE_SAVE":"MSG_START"}}click(o){return o?!this.isRunning()||o.state.blocked?(this.sound.play(be.NOPE),this.wiggleStone(o),!0):(this.clock.elapsed===0&&this.clock.run(),this.board.selected&&o&&o!==this.board.selected&&o.groupNr===this.board.selected.groupNr?(this.resolveMatchingStone(o),!0):(this.board.setStoneSelected(this.board.selected===o?void 0:o),this.sound.play(be.SELECT),!0)):(this.board.clearSelection(),!1)}wiggleStone(o){o&&(o.effects=o.effects||{},o.effects.wiggle=!0,setTimeout(()=>{o.effects&&(o.effects.wiggle=!1)},300))}isRunning(){return this.state===ce.run}isPaused(){return this.state===ce.pause}isIdle(){return this.state===ce.idle}resume(){this.run(),this.clock.run(),this.music.play()}run(){this.board.clearHints(),this.board.update(),this.setState(ce.run)}toggle(){this.state===ce.run?this.pause():this.state===ce.pause&&this.resume()}pause(){this.clock.pause(),this.setState(ce.pause,"MSG_CONTINUE_PAUSE"),this.save(),this.music.pause()}reset(){this.clock.reset(),this.setState(ce.idle),this.board.reset()}start(o,e,t){this.layoutID=o.id,this.mode=t,this.board.applyMapping(o.mapping,e),this.board.update(),this.run()}hint(){this.mode!==Ft&&(this.board.hint(),this.sound.play(be.HINT))}shuffle(){this.mode===Ne&&(this.board.shuffle(),this.sound.play(be.SHUFFLE))}back(){this.mode!==Ft&&this.isRunning()&&(this.board.back(),this.sound.play(be.UNDO))}load(){try{let o=this.storage.getState();if(o?.stones)return this.clock.elapsed=o.elapsed??0,this.layoutID=o.layout,this.mode=o.gameMode??Nt,this.state=o.state??ce.idle,this.board.load(o.stones,o.undo??[]),!0}catch(o){console.error("load state failed",o)}return!1}save(){if(this.layoutID)try{this.storage.storeState({elapsed:this.clock.elapsed,state:this.state,layout:this.layoutID,gameMode:this.mode,undo:this.board.undo,stones:this.board.save()})}catch(o){console.error("storing state failed",o)}}isStorableLayoutId(){return this.layoutID!==void 0&&!this.layoutID.startsWith(mt)}storeLostGame(){if(this.isStorableLayoutId()){let o=this.layoutID??"unknown",e=this.storage.getScore(o)??{};e.playCount=(e.playCount??0)+1,this.storage.storeScore(o,e)}}gameOverLosing(){this.storeLostGame(),this.sound.play(be.OVER),this.gameOver("MSG_FAIL")}gameOverEasyModeShuffle(){for(let o=0;o<10;o++)if(this.shuffle(),this.board.free.length>0){this.resume();return}this.gameOverEasyMode()}surrender(){this.storeLostGame(),this.sound.play(be.OVER),this.setState(ce.idle),this.clock.reset()}checkGameState(){if(this.board.count<2)this.gameOverWinning();else if(this.board.free.length===0){if(this.mode===Ne&&this.board.countUnblocked()>1)return this.gameOverEasyMode(),!1;this.gameOverLosing()}else return this.sound.play(be.MATCH),this.delayedSave(),!0;return!1}gameOverWinning(){let o=this.clock.elapsed;if(!this.isStorableLayoutId()){this.gameOver("MSG_GOOD",o);return}let e=this.layoutID??"unknown",t=this.storage.getScore(e)??{};t.playCount=(t.playCount??0)+1,!t.bestTime||t.bestTime>o?(t.bestTime=o,this.gameOver("MSG_BEST",o)):this.gameOver("MSG_GOOD",o),this.storage.storeScore(e,t),this.sound.play(be.WIN)}delayedSave(){clearTimeout(this.saveTimer),this.saveTimer=setTimeout(()=>{this.save()},300)}gameOverEasyMode(){this.clock.pause(),this.message={messageID:"MSG_FAIL",askShuffle:!0},this.state=ce.pause,this.delayedSave(),this.music.pause()}resolveMatchingStone(o){let e=this.board.selected;e&&(this.board.pick(e,o),this.checkGameState())}gameOver(o,e){this.setState(ce.idle,o,e),this.clock.reset(),this.delayedSave()}setState(o,e,t){this.message=e?{messageID:e,playTime:t}:void 0,this.state=o}};var Ye={en:{title:"English"},de:{title:"Deutsch"},nl:{title:"Nederlands"},pt:{title:"Portugu\xEAs"},ru:{title:"\u0440\u0443\u0441\u0441\u043A\u0438\u0439"},es:{title:"Espa\xF1ol"},eu:{title:"Euskara"},jp:{title:"\u65E5\u672C\u8A9E"},fr:{title:"Fran\xE7ais"},zh:{title:"\u4E2D\u6587"}};var _t=class{constructor(o){this.storageProvider=o,this.lang=jt,this.sounds=!0,this.tileset=Re,this.music=!1,this.contrast=!1,this.dark=!1,this.background="",this.theme=$t,this.stats={games:0,bestTime:0}}load(){try{let o=this.storageProvider.getSettings();return o&&(this.lang=o.lang??jt,this.tileset=o.tileset??Re,this.background=o.background??this.background,this.pattern=o.pattern,this.theme=o.theme??$t,this.contrast=o.contrast??!1,this.dark=o.dark??!1,this.sounds=o.sounds??this.sounds,this.music=o.music??this.music,this.kyodaiUrl=o.kyodaiUrl),!0}catch(o){console.error("load settings failed",o)}return!1}save(){try{return this.storageProvider.storeSettings({lang:this.lang,sounds:this.sounds,music:this.music,contrast:this.contrast,dark:this.dark,background:this.background,pattern:this.pattern,theme:this.theme,tileset:this.tileset,kyodaiUrl:this.kyodaiUrl}),!0}catch(o){console.error("storing settings failed",o)}return!1}};var ue=(()=>{class i{constructor(){this.name="Mah Jong",this.cache={},this.storage=k(Be),this.translate=k(De),this.game=new ut(this.storage),this.settings=new _t(this.storage),this.settings.load(),this.setLang(),this.game.init(),this.game.sound.enabled=this.settings.sounds,this.game.music.enabled=this.settings.music}getCachedValue(e){return this.cache[e]}cacheValue(e,t){if(t===void 0){delete this.cache[e];return}this.cache[e]=t}setLang(){let e=!this.settings.lang||this.settings.lang===Nn?(navigator.language.split("-")[0]||"en").toLowerCase():this.settings.lang;Object.keys(Ye).includes(e)?this.translate.use(e):this.translate.use("en")}toggleSound(){this.settings.sounds=!this.settings.sounds,this.game.sound.enabled=this.settings.sounds,this.settings.save()}toggleMusic(){this.settings.music=!this.settings.music,this.game.music.enabled=this.settings.music,this.game.music.toggle(),this.settings.save()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var qi=["*"];function Xi(i,o){if(i&1&&(D(0,"h1"),le(1,"i",5),f(2),B()),i&2){let e=M(2);l(2),O(e.title())}}function Wi(i,o){if(i&1){let e=$();D(0,"a",6),u(1,"translate"),ge("click",function(){x(e);let n=M(2);return y(n.toggle())}),le(2,"i",7),B()}i&2&&tt("title",j(_(1,2,"CLOSE")))}function Zi(i,o){if(i&1){let e=$();D(0,"div",1),ge("click",function(){x(e);let n=M();return y(n.toggle())}),D(1,"div",2),ge("click",function(n){return x(e),y(n.stopPropagation())}),D(2,"div",3),T(3,Xi,3,1,"h1"),T(4,Wi,3,4,"a",4),B(),Mn(5),B()()}if(i&2){let e=M();fe(J("overlay ",e.className())),l(3),L(e.title()?3:-1),l(),L(e.noCloseButton()?-1:4)}}var Xn=(()=>{class i{constructor(){this.title=V(),this.className=V(),this.visible=it(!1),this.noCloseButton=V(!1),this.clickEvent=Oe()}toggle(){this.visible.set(!this.visible()),this.clickEvent.emit(this.visible())}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-dialog"]],inputs:{title:[1,"title"],className:[1,"className"],visible:[1,"visible"],noCloseButton:[1,"noCloseButton"]},outputs:{visible:"visibleChange",clickEvent:"clickEvent"},ngContentSelectors:qi,decls:1,vars:1,consts:[[3,"class"],[3,"click"],[1,"overlay-popup",3,"click"],[1,"dialog-header"],["role","button",1,"close",3,"title"],[1,"icon-logo"],["role","button",1,"close",3,"click","title"],[1,"icon-cancel-circled2"]],template:function(t,n){t&1&&(Cn(),T(0,Zi,6,5,"div",0)),t&2&&L(n.visible()?0:-1)},dependencies:[te],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;color:var(--main-content-text-color)}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;color:var(--dialog-headline-color);margin-top:-8px;margin-bottom:10px;line-height:1.3em}@media only screen and (max-width:700px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2em}}@media only screen and (max-width:400px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1em}}"]})}}return i})();function je(i){if(ne.openExternal){i.preventDefault();try{let o=i.target;for(;o&&!(o instanceof HTMLAnchorElement);)o=o.parentElement;if(o&&o instanceof HTMLAnchorElement){let e=o.getAttribute("href")??"";ne.openExternal(e)}}catch(o){console.error(o)}}}function Qi(i,o){if(i&1&&(D(0,"li")(1,"div")(2,"span",14),f(3),B(),le(4,"i"),D(5,"span",4),f(6),u(7,"translate"),B()(),D(8,"span",15),f(9),u(10,"translate"),B()()),i&2){let e=o.$implicit;l(3),O(e.key),l(),fe(e.icon),l(2),O(_(7,5,e.name)),l(3),O(_(10,7,e.name+"_LONG"))}}var Wn=(()=>{class i{constructor(){this.shortcuts=[{icon:"icon-lightbulb",key:"T",name:"HINT"},{icon:"icon-spin1",key:"M",name:"SHUFFLE"},{icon:"icon-undo",key:"U",name:"UNDO"},{icon:"icon-loop",key:"N",name:"RESTART"},{icon:"icon-pause",key:"P",name:"PAUSE"},{icon:"icon-calendar",key:"I",name:"INFO"},{icon:"icon-cog",key:"S",name:"SETTINGS"},{icon:"icon-logo",key:"H",name:"HELP"}],this.clickExternalHref=je}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-help"]],decls:77,vars:45,consts:[[1,"top"],[1,"help"],[1,"license"],[1,"license-list"],[1,"name"],[1,"info"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/tree/main/src/assets/svg/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/sounds/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/fonts/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/img/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/patterns/README.md",3,"click"],[1,"keyboard"],[1,"keyboard-list"],[1,"key"],[1,"func"]],template:function(t,n){t&1&&(D(0,"div",0)(1,"fieldset",1)(2,"legend"),f(3),u(4,"translate"),B(),D(5,"p"),f(6),u(7,"translate"),B(),D(8,"p")(9,"b"),f(10),u(11,"translate"),B(),f(12),u(13,"translate"),B(),D(14,"p")(15,"b"),f(16),u(17,"translate"),B(),f(18),u(19,"translate"),B(),D(20,"p"),f(21),u(22,"translate"),B()(),D(23,"fieldset",2)(24,"legend"),f(25),u(26,"translate"),B(),D(27,"div",3)(28,"div")(29,"div",4),f(30),u(31,"translate"),B(),D(32,"div",5)(33,"a",6),ge("click",function(a){return n.clickExternalHref(a)}),f(34,"MIT"),B()()(),D(35,"div")(36,"div",4),f(37),u(38,"translate"),B(),D(39,"div",5)(40,"a",7),ge("click",function(a){return n.clickExternalHref(a)}),f(41,"Free | Public Domain | CCA4.0 | GNU"),B()()(),D(42,"div")(43,"div",4),f(44),u(45,"translate"),B(),D(46,"div",5)(47,"a",8),ge("click",function(a){return n.clickExternalHref(a)}),f(48,"MIT"),B()()(),D(49,"div")(50,"div",4),f(51),u(52,"translate"),B(),D(53,"div",5)(54,"a",9),ge("click",function(a){return n.clickExternalHref(a)}),f(55,"SIL"),B()()(),D(56,"div")(57,"div",4),f(58),u(59,"translate"),B(),D(60,"div",5)(61,"a",10),ge("click",function(a){return n.clickExternalHref(a)}),f(62,"Public Domain"),B()()(),D(63,"div")(64,"div",4),f(65),u(66,"translate"),B(),D(67,"div",5)(68,"a",11),ge("click",function(a){return n.clickExternalHref(a)}),f(69,"MIT"),B()()()()()(),D(70,"fieldset",12)(71,"legend"),f(72),u(73,"translate"),B(),D(74,"ul",13),F(75,Qi,11,9,"li",null,U),B()()),t&2&&(l(3),O(_(4,15,"HOW_TO_PLAY")),l(3),O(_(7,17,"HOW_GOAL")),l(4),O(_(11,19,"HOW_OPEN")),l(2),z(": ",_(13,21,"HOW_OPEN_DESC")),l(4),O(_(17,23,"HOW_PAIR")),l(2),z(": ",_(19,25,"HOW_PAIR_DESC")),l(3),O(_(22,27,"HOW_DO")),l(4),O(_(26,29,"LICENSE")),l(5),O(_(31,31,"GAME")),l(7),O(_(38,33,"DESIGNS")),l(7),O(_(45,35,"SOUNDS")),l(7),O(_(52,37,"FONTS")),l(7),O(_(59,39,"BACKGROUNDS")),l(7),O(_(66,41,"PATTERN_SETTINGS")),l(7),O(_(73,43,"SHORTCUTS")),l(3),N(n.shortcuts))},dependencies:[te],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;flex:1;overflow:hidden auto;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{border:1px solid var(--main-bg-color-lt);border-radius:8px;padding:8px 12px 12px;flex:1}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{padding:0 6px;font-weight:700}[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{flex:1;padding-right:6px;display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   .help[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:4px}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .license-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:40%;max-width:40%}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]{padding:0;list-style:none;columns:2}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{break-inside:avoid;margin-bottom:14px}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .func[_ngcontent-%COMP%]{margin-top:8px;font-size:.8em;display:block}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{vertical-align:middle}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:8px;vertical-align:middle;color:var(--main-content-text-color)}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;padding-left:4px;padding-right:4px;border:2px solid #ddd;border-radius:6px;min-height:20px;min-width:28px;font-size:.7em;vertical-align:top;display:inline-block;letter-spacing:1px;background:#000;color:#ddd;box-shadow:0 5px #000;text-align:center}@media only screen and (max-width:700px){[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]{columns:1}}@media only screen and (max-width:1000px){[_nghost-%COMP%]{flex-flow:column nowrap}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .top[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{flex-flow:column nowrap}[_nghost-%COMP%]   .help[_ngcontent-%COMP%], [_nghost-%COMP%]   .license[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .license-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex-wrap:wrap;margin-bottom:8px}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:100%;max-width:100%}}"]})}}return i})();function ft(i){return["kyodai","kyodai-black"].includes(i)}var Qn=[{name:"Traditional",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191758/https://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/79546_orig.jpg"},{name:"Cards",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/4962942_orig.jpg"},{name:"Board Games",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3862268_orig.jpg"},{name:"Motorcycles",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8438984_orig.jpg"},{name:"NHL",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/630927_orig.jpg"},{name:"Social Media",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/241535_orig.jpg"},{name:"Monopoly",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9084861_orig.jpg"},{name:"Horror Films",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/849930_orig.jpg"},{name:"Animated Movies",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2303366_orig.jpg"},{name:"Stephen King",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/4168429_orig.jpg"},{name:"Lord of the Rings",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3966297_orig.jpg"},{name:"007",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9617288_orig.jpg"},{name:"Disney Princess",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2281343_orig.jpg"},{name:"Religions",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191748im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2620625_orig.jpg"},{name:"Happy Eastern",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1396173_orig.jpg"},{name:"Halloween",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8455923_orig.jpg"},{name:"Neck Ties",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9349600_orig.jpg"},{name:"Floral",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3178635_orig.jpg"},{name:"Easter Eggs",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8685131_orig.jpg"},{name:"St. Patricks Day",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/7310933_orig.jpg"},{name:"Valentine's Day",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1140822_orig.jpg"},{name:"Christmas",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1525811_orig.jpg"},{name:"Canada Flower & Birds",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2953105_orig.jpg"},{name:"Canada Scenery",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8401335_orig.jpg"},{name:"Nova Scotia",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2933195_orig.jpg"},{name:"Canada Birds",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9756515_orig.jpg"},{name:"Arabic Alphabet & Numbers",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170902065732im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/5652995_orig.jpg"},{name:"Mahjongg Platinum 2 Dark",author:"Pavel Osharin",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2479283_orig.jpg"},{name:"Mahjongg Platinum 2 Red",author:"Pavel Osharin",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2090721_orig.jpg"},{name:"Mahjongg Titans",author:"Microsoft Vista",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/6604294_orig.jpg"},{name:"Viking Artifacts 1",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/VikingArtifacts.jpg"},{name:"Viking Artifacts 2",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/VikingArtifacts2.jpg"},{name:"Art of the Scythians",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/ScythianArt.jpg"},{name:"Waite-Rider Tarot",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/WaiteRiderTarot.jpg"},{name:"Waite-Rider Tarot Images",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725im_/http://www.vikinganswerlady.com/kyodai/WaiteRiderTarotImagesThumbnail.jpg"},{name:"Morgan-Greer Tarot",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/MorganGreerTarot.jpg"},{name:"Xena: Tarot of the Bitter Suite",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/BitterSuite.jpg"},{name:"A Rainbow of Bearded Irises",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/RainbowIris.jpg"},{name:"Antique Roses",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/AntiqueRoses.jpg"},{name:"Flags of the World",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725im_/http://www.vikinganswerlady.com/kyodai/FlagsThumbnail.jpg"},{name:"X-Men",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/XMen.jpg"},{name:"Age of Empires II: Age of Kings",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/AOEII.jpg"}];function Ji(i){return pe(this,null,function*(){return new Promise((o,e)=>{let t=new Image;t.addEventListener("load",()=>{o(t)}),t.addEventListener("error",n=>{console.error(n),e(new Error(`Image ${i} could not be loaded.`))}),t.src=i})})}function Zn(i,o,e,t){let n="";for(let[r,a]of i.entries()){let s=r*e;for(let[c,d]of a.entries()){let p=c*t;n+=`<svg preserveAspectRatio="xMidYMid slice" id="${d}" width="75" height="100" viewBox="${p} ${s} ${t} ${e}"><use xlink:href="#${o}"></use></svg>`}}return n}function Jn(i){return pe(this,null,function*(){if(!i)return"<svg><defs></defs></svg>";let o=(d,p)=>[...Array.from({length:p}).keys()].map(m=>m+d),e=[o(1,9).map(d=>`do${d}`),o(1,9).map(d=>`ba${d}`),o(1,9).map(d=>`ch${d}`),["se_winter","se_spring","se_summer","se_fall","wi_north","wi_south","wi_east","wi_west"],["fl_bamboo","fl_plum","fl_orchid","fl_chrysanthemum","dr_green","dr_white","dr_red"]].map(d=>d.map(p=>`t_${p}`)),t=[o(1,9).map(d=>`g${d}`),o(10,9).map(d=>`g${d}`),o(1,9).map(d=>`e${d}`)].map(d=>d.map(p=>`t_${p}`)),n=yield Ji(i),r=n.height/5,a=n.width/9,s=Ht(i),c=Ht("kyodai-extra");return`<svg><defs>
<image id="${s}" xlink:href="${i}" x="0" y="0" height="${n.height}" width="${n.width}"/>
<image id="${c}" xlink:href="/assets/svg/kyodai-extra.png" x="0" y="0" height="300" width="675"/>
${Zn(e,s,r,a)}
${Zn(t,c,100,75)}
</defs></svg>
`})}var Ct=(()=>{class i{constructor(){this.http=k(Ie),this.cache={}}get(e,t){return pe(this,null,function*(){if(ft(e))return Jn(t);let n=this.cache[e];if(n){if(n.data)return n.data;if(n.request!==void 0)return n.request}n={};let r=new Promise((a,s)=>{setTimeout(()=>{this.http.get(`assets/svg/${e}.svg`,{responseType:"text"}).subscribe({next:c=>{n.data=c,n.request=void 0,a(c)},error:c=>{s(c)}})})});return n.request=r,this.cache[e]=n,r})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ei='<svg id="mah-error-icon" width="60" height="60" shape-rendering="geometricPrecision" text-rendering="geometricPrecision"image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="10 0 560 431.15"><g fill-rule="nonzero"><path fill="#D92D27" d="M492.56 431.15H19.42v-.05c-14.72.03-24.33-16.08-16.78-29.12L234.51 9.64c7.35-12.57 25.75-13.05 33.42-.23l240.41 390.96c9.12 12.64.2 30.78-15.78 30.78z"/><path fill="#fff" d="M41.15 399.63h431.88L252.71 47.08c-.63-.99-1.38-.98-1.97 0L40.02 397.9c-.63 1.12-.31 1.74 1.13 1.73z"/><path d="M243.18 246.58h25.46v20.32h-25.46v-20.32zm-78.9 102.8h-17.43v7.87h21.35v12.7h-38.78v-54.47h38.35l-2.18 12.69h-18.74v8.58h17.43v12.63zm58.16 20.57h-19.16l-7.15-16.21h-5v16.21h-16.18v-54.47h27.45c12.49 0 18.74 6.36 18.74 19.08 0 8.72-2.7 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.26c2.09 0 3.62-.23 4.57-.66.95-.43 1.44-1.44 1.44-3v-4.82c0-1.57-.49-2.58-1.44-3.01-.95-.43-2.49-.66-4.57-.66h-5.26zm84.25 41.78h-19.17l-7.15-16.21h-4.99v16.21h-16.18v-54.47h27.45c12.49 0 18.74 6.36 18.74 19.08 0 8.72-2.7 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.25c2.1 0 3.63-.23 4.58-.66.95-.43 1.44-1.44 1.44-3v-4.82c0-1.57-.49-2.58-1.44-3.01-.95-.43-2.5-.66-4.58-.66h-5.25zm34.14 14.59c0-9.94 1.86-17.18 5.58-21.74 3.71-4.57 10.43-6.85 20.13-6.85s16.41 2.28 20.13 6.85c3.72 4.56 5.58 11.8 5.58 21.74 0 4.94-.4 9.09-1.18 12.46-.78 3.37-2.14 6.3-4.05 8.8-1.92 2.5-4.57 4.33-7.93 5.49-3.37 1.16-7.551.74-12.55 1.74-4.99 0-9.18-.58-12.55-1.74-3.37-1.16-6.01-2.99-7.93-5.49s-3.27-5.43-4.05-8.8c-.79-3.37-1.18-7.52-1.18-12.46zm18.74-9.07v22.66h7.23c2.38 0 4.11-.27 5.19-.831.07-.55 1.61-1.81 1.61-3.79v-22.66h-7.33c-2.32 0-4.02.28-5.09.83-1.07.55-1.61 1.81-1.61 3.79zm85.62 36.26H363.4l-7.15-16.21h-4.99v16.21h-16.18v-54.47h27.44c12.5 0 18.756.36 18.75 19.08 0 8.72-2.71 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.25c2.1 0 3.63-.23 4.58-.66.95-.43 1.43-1.44 1.43-3v-4.82c0-1.57-.48-2.58-1.43-3.01-.95-.43-2.5-.66-4.58-.66h-5.25zm-82.62-93h-25.46c-1.82-22.29-4.73-26.26-5.95-40.78-1.25-14.61-2.12-35.58 18.73-35.58 21.86 0 20.1 23.36 18.45 38.47-1.37 12.45-4.05 17.16-5.77 37.89z"/></g></svg>',ti='<svg id="mah-tile-spinner" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><rect x="11" y="1" width="2" height="5" opacity=".14"/><rect x="11" y="1" width="2" height="5" transform="rotate(30 12 12)" opacity=".29"/><rect x="11" y="1" width="2" height="5" transform="rotate(60 12 12)" opacity=".43"/><rect x="11" y="1" width="2" height="5" transform="rotate(90 12 12)" opacity=".57"/><rect x="11" y="1" width="2" height="5" transform="rotate(120 12 12)" opacity=".71"/><rect x="11" y="1" width="2" height="5" transform="rotate(150 12 12)" opacity=".86"/><rect x="11" y="1" width="2" height="5" transform="rotate(180 12 12)"/><animateTransform attributeName="transform" type="rotate" calcMode="discrete" dur="0.75s" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12" repeatCount="indefinite"/></g></svg>';var eo=["app-image-set-loader",""],Mt=(()=>{class i{constructor(){this.imageSet=V(),this.kyodaiUrl=V(),this.prefix=V(),this.dark=V(!1),this.elementRef=k(Pe),this.svgDef=k(Ct)}ngOnChanges(e){this.getImageSet()}setLoading(){let e=[ti];for(let t of Gt)for(let n of t)e.push(`<svg id="${n}" width="75" height="100"><use xlink:href="#mah-tile-spinner" transform="translate(26,42)"></use></svg>`);this.setImageSet(`<svg><defs>${e.join("")}</defs></svg>`)}prepareDefs(e){let t=e.indexOf("<defs>"),n=e.lastIndexOf("</defs>");return(t!==-1&&n!==-1&&n>t+6?e.slice(t+6,n):"").replace(/xlink:href="\./g,'xlink:href="assets/svg').replace(/ id="t_/g,` id="${this.prefix()}t_`)}setError(){let e=[ei];for(let t of Gt)for(let n of t)e.push(`<svg id="${n}" width="75" height="100"><use xlink:href="#mah-error-icon" transform="translate(8,18)"></use></svg>`);this.setImageSet(`<svg><defs>${e.join("")}</defs></svg>`)}setImageSet(e){this.elementRef.nativeElement.innerHTML="";let t=this.prepareDefs(e);setTimeout(()=>{this.elementRef.nativeElement.innerHTML=t},0)}loadImageSet(){let e=this.imageSet()+(this.dark()?"-black":"");this.svgDef.get(e,this.kyodaiUrl()).then(t=>{this.setImageSet(t)}).catch(t=>{this.setError(),console.error(t)})}getImageSet(){this.imageSet()&&(this.setLoading(),setTimeout(()=>this.loadImageSet(),0))}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["","app-image-set-loader",""]],inputs:{imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],prefix:[1,"prefix"],dark:[1,"dark"]},features:[Se],attrs:eo,decls:1,vars:0,template:function(t,n){t&1&&(K(),le(0,"defs"))},encapsulation:2})}}return i})();var ni=(()=>{class i{constructor(){this.imageSet=V(),this.kyodaiUrl=V(),this.tile=V.required(),this.index=V(),this.isDark=V(!1)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-tile"]],inputs:{imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],tile:[1,"tile"],index:[1,"index"],isDark:[1,"isDark"]},decls:6,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 75 100","preserveAspectRatio","xMidYMid meet"],["app-image-set-loader","",3,"imageSet","kyodaiUrl","dark","prefix"],["x","6","y","6","width","63","height","88"]],template:function(t,n){t&1&&(K(),g(0,"svg",0),S(1,"defs",1),g(2,"title"),f(3),u(4,"translate"),h(),S(5,"use",2),h()),t&2&&(Q("dark",n.isDark()),l(),P("imageSet",n.imageSet())("kyodaiUrl",n.kyodaiUrl())("dark",n.isDark())("prefix","t_"+n.imageSet()+"_"+n.index()+"_"),l(2),O(_(4,8,n.tile())),l(2),ee("href","#t_"+n.imageSet()+"_"+n.index()+"_"+n.tile(),null,"xlink"))},dependencies:[Mt,te],styles:["[_nghost-%COMP%]{display:block;width:75px;height:100px;margin:0 auto}[_nghost-%COMP%] > svg[_ngcontent-%COMP%]{height:100%;width:auto;background-color:var(--tile-color);border:1px solid var(--tile-color-border)}[_nghost-%COMP%] > svg.dark[_ngcontent-%COMP%]{background-color:var(--tile-color-dark);border:1px solid var(--tile-color-border-dark)}"]})}}return i})();function to(i,o){i&1&&(K(),le(0,"path",3))}function no(i,o){i&1&&(K(),le(0,"path",4))}function io(i,o){i&1&&(K(),le(0,"path",5))}function oo(i,o){i&1&&(K(),le(0,"path",6))}function ro(i,o){i&1&&(K(),le(0,"path",7))}function ao(i,o){i&1&&(K(),le(0,"path",8))}var Pt=(()=>{class i{constructor(){this.link=V.required(),this.licenseKey=V.required(),this.licenses=Fn,this.clickExternalHref=je}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-license-link"]],inputs:{link:[1,"link"],licenseKey:[1,"licenseKey"]},decls:9,vars:3,consts:[["target","_blank","rel","noopener",3,"click","href","title"],["xmlns","http://www.w3.org/2000/svg",0,"xml","space","preserve","fill-rule","evenodd","stroke-linecap","round","clip-rule","evenodd","viewBox","0 0 1067 1067"],["fill","#fff","fill-rule","nonzero","stroke","#000","stroke-width","62.55","d","M1034.158 535.104c0 276.808-224.169 501.207-500.698 501.207-276.535 0-500.703-224.398-500.703-501.207S256.926 33.897 533.46 33.897c276.535 0 500.694 224.398 500.694 501.207h.005Z"],["fill-rule","nonzero","d","m463.156 546.582 68.977 28.564q-6.95 39.752-21.892 66.412t-37.095 40.228q-22.152 13.568-56.381 13.568-41.526 0-67.848-16.544-26.322-16.543-45.435-58.2-19.112-41.657-19.112-106.641 0-86.646 33.62-133.182t95.126-46.536q48.127 0 75.667 26.66t40.917 81.885l-69.499 21.185q-3.649-15.948-7.645-23.328-6.603-12.378-16.158-19.043t-21.371-6.665q-26.757 0-41.004 29.517-10.773 21.9-10.772 68.793 0 58.082 12.857 79.623 12.858 21.543 36.139 21.542 22.587 0 34.141-17.377t16.767-50.464Zm276.778 0 68.977 28.564q-6.95 39.752-21.892 66.412t-37.095 40.228-56.381 13.568q-41.526 0-67.848-16.544-26.322-16.543-45.435-58.2-19.112-41.657-19.112-106.641 0-86.646 33.62-133.182t95.126-46.536q48.127 0 75.667 26.66t40.917 81.885l-69.499 21.185q-3.649-15.948-7.645-23.328-6.603-12.378-16.158-19.043t-21.371-6.665q-26.757 0-41.004 29.517-10.773 21.9-10.772 68.793 0 58.082 12.857 79.623 12.858 21.543 36.139 21.542 22.587 0 34.141-17.377t16.767-50.464Z"],["fill-rule","nonzero","d","M288.297 575.269v-72.601H409.92v148.773q-34.923 32.611-61.767 44.394t-63.678 11.783q-45.348 0-73.929-21.185t-44.305-63.08q-15.724-41.894-15.724-96.167 0-57.13 17.201-99.38 17.2-42.251 50.387-64.151 25.889-16.9 69.672-16.901 42.22 0 63.157 10.474t34.749 32.492 20.763 55.82l-75.927 18.567q-4.691-19.756-15.898-30.231-11.207-10.474-28.581-10.474-25.889 0-41.265 24.637t-15.377 77.957q0 56.653 15.55 80.933t43.35 24.28q13.205 0 25.193-5.237t27.452-17.853V575.27zM456.31 352.704h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089v129.492H456.31zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm178.264-148.773h78.707v263.031h122.839v85.931H713.629z"],["fill-rule","nonzero","d","M156.426 390.204h151.806v58.494h-90.135v47.538h76.987v54.965h-76.987v111.231h-61.671zm185.691 272.228V390.205H444.45q28.464 0 43.509 6.685t24.262 24.79 9.217 44.102q0 22.655-7.048 39.089-7.049 16.434-19.382 26.647-7.862 6.5-21.551 10.77 10.978 5.013 15.994 10.027 3.389 3.342 9.827 14.298t8.607 16.898l29.683 78.92h-69.397L435.37 579.24q-6.235-16.155-11.114-20.983-6.642-6.314-15.045-6.314h-5.422v110.488zm61.671-161.925h25.888q4.202 0 16.265-3.714 6.1-1.67 9.962-8.542 3.863-6.87 3.863-15.784 0-13.184-6.099-20.241-6.1-7.056-22.906-7.056h-26.973zm153.296-110.303H721.63v58.122H618.619v43.267h95.556v55.522h-95.556v53.666h105.993v61.65H557.084zm200.465 0h164.546v58.122H819.084v43.267h95.556v55.522h-95.556v53.666h105.993v61.65H757.549z"],["fill-rule","nonzero","d","M309.898 348.538h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm177.916-148.773H697.7q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85-7.993-11.426-30.058-11.426h-22.413v77.838Z"],["fill-rule","nonzero","d","M309.898 348.538h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm179.306-148.773h116.932q34.575 0 55.86 12.854t35.184 36.896 20.155 55.939 6.255 67.603q0 55.938-9.295 86.765t-25.801 51.654-35.444 27.731q-25.888 9.521-46.912 9.521H568.261V348.539Zm78.707 79.028v190.668h19.286q24.672 0 35.097-7.498t16.332-26.184 5.907-60.58q0-55.462-13.205-75.934-13.205-20.47-43.784-20.471h-19.633Z"],["fill-rule","nonzero","transform","scale(4.5) translate(30 90)","d","M0 .003h25.679l9.912 38.43L45.46.003h25.59v63.16H55.109V14.997L42.746 63.163H28.311L15.987 14.997v48.166H0zM84.28.003h19.56v63.168H84.28zM113.408.003h59.329V15.6H152.83v47.563h-19.516V15.6h-19.906z"]],template:function(t,n){if(t&1&&(D(0,"a",0),ge("click",function(a){return n.clickExternalHref(a)}),K(),D(1,"svg",1),le(2,"path",2),T(3,to,1,0,":svg:path",3)(4,no,1,0,":svg:path",4)(5,io,1,0,":svg:path",5)(6,oo,1,0,":svg:path",6)(7,ro,1,0,":svg:path",7)(8,ao,1,0,":svg:path",8),B()()),t&2){let r;tt("href",n.link(),Qe)("title",n.licenses[n.licenseKey()]||"?"),l(3),L((r=n.licenseKey())==="cca"?3:r==="gpl"?4:r==="free"?5:r==="per"?6:r==="pub"?7:r==="mit"?8:-1)}},styles:["[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;object-fit:contain;vertical-align:middle}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{margin-left:3px;line-height:30px;font-size:.8em}"]})}}return i})();function so(i,o){if(i&1&&(g(0,"div",14)(1,"div"),S(2,"app-tile",15),h(),S(3,"div",16),u(4,"translate"),h()),i&2){let e=o.$implicit,t=o.$index,n=M(3);l(2),P("tile",e)("imageSet",n.tileset)("kyodaiUrl",n.kyodaiUrl)("index",t)("isDark",n.isDark),l(),P("innerHTML",_(4,6,e),un)}}function lo(i,o){if(i&1&&(g(0,"div")(1,"div",13),f(2),u(3,"translate"),h(),g(4,"div"),F(5,so,5,8,"div",14,U),h()()),i&2){let e=o.$implicit;fe(J("tiles-section tiles-section-",e.tiles.length)),l(2),O(_(3,7,e.name)),l(2),fe(J("tiles-set tiles-set-",e.tiles.length)),l(),N(e.tiles)}}function co(i,o){if(i&1&&F(0,lo,7,9,"div",12,U),i&2){let e=o.$implicit;N(e.groups)}}function po(i,o){if(i&1&&S(0,"app-license-link",4),i&2){let e=M();P("link",J("https://github.com/ffalt/mah/blob/main/src/assets/svg/README.md#",e.selectedSet.id,"svg"))("licenseKey",e.selectedSet.license)}}function go(i,o){if(i&1&&(g(0,"option",6),f(1),h()),i&2){let e=o.$implicit,t=M();P("value",e.id)("selected",t.tileset===e.id),l(),O(e.name)}}function ho(i,o){if(i&1&&(g(0,"option",7),f(1),u(2,"translate"),h()),i&2){let e=M();P("selected",e.tileset==="kyodai"),l(),O(_(2,2,"KYODAI_TILESET"))}}var ii=(()=>{class i{get selectedSet(){return this.sets.find(e=>e.id===this.tileset)}applyTileset(){this.app.settings.tileset=this.tileset,this.app.settings.dark=this.isDark,this.app.settings.save()}constructor(){this.TILES_INFOS=$n,this.sets=st,this.tileset=Re,this.isDark=!1,this.canKyodai=ne.kyodai,this.app=k(ue),this.clickExternalHref=je,this.tileset=this.app.settings.tileset,this.isDark=this.app.settings.dark,this.kyodaiUrl=this.app.settings.kyodaiUrl}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-tiles-info"]],decls:23,vars:17,consts:[[1,"tiles-content"],[1,"tiles-footer"],[1,"tiles-form"],[1,"tiles-select"],[3,"link","licenseKey"],[3,"change"],[3,"value","selected"],["value","kyodai",3,"selected"],["type","checkbox",3,"change","checked"],["type","button",3,"click","disabled"],[1,"tiles-reference"],["rel","noopener","target","_blank",3,"click","href"],[3,"class"],[1,"tiles-title"],[1,"tile"],[3,"tile","imageSet","kyodaiUrl","index","isDark"],[3,"innerHTML"]],template:function(t,n){t&1&&(g(0,"div",0),F(1,co,2,0,null,null,U),h(),g(3,"div",1)(4,"form",2)(5,"div",3),T(6,po,1,3,"app-license-link",4),g(7,"select",5),v("change",function(a){return n.tileset=a.target.value}),F(8,go,2,3,"option",6,U),T(10,ho,3,4,"option",7),h()(),g(11,"label")(12,"input",8),v("change",function(){return n.isDark=!n.isDark}),h(),f(13),u(14,"translate"),h(),g(15,"button",9),v("click",function(){return n.applyTileset()}),f(16),u(17,"translate"),h()(),g(18,"div",10)(19,"a",11),u(20,"translate"),v("click",function(a){return n.clickExternalHref(a)}),f(21),u(22,"translate"),h()()()),t&2&&(l(),N(n.TILES_INFOS),l(5),L(n.selectedSet?6:-1),l(2),N(n.sets),l(2),L(n.canKyodai&&n.kyodaiUrl?10:-1),l(2),P("checked",n.isDark),l(),O(_(14,9,"TILES_DARK")),l(2),P("disabled",!n.selectedSet||n.selectedSet.id===n.app.settings.tileset&&n.isDark===n.app.settings.dark),l(),z("",_(17,11,"USE_NOW")," "),l(3),P("href",j(_(20,13,"READ_MORE_WIKIPEDIA_URL")),Qe),l(2),O(_(22,15,"READ_MORE_WIKIPEDIA")))},dependencies:[ni,Pt,te],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden;height:100%}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;color:var(--dialog-text-color);margin-top:0;margin-bottom:.2em;line-height:1em}@media only screen and (max-width:400px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2em}}[_nghost-%COMP%]   .tiles-content[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;flex:1;border:1px solid var(--card-layout-color-border);border-radius:4px;overflow-y:auto}[_nghost-%COMP%]   .tile[_ngcontent-%COMP%]{flex:1;text-align:center;word-break:normal;margin-top:5px;margin-bottom:5px;display:flex;flex-direction:column;padding-left:5px;padding-right:5px}[_nghost-%COMP%]   .tile[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;font-size:.9em}[_nghost-%COMP%]   .tiles-title[_ngcontent-%COMP%]{flex:1;margin-top:.5em;margin-bottom:.2em;font-weight:700;text-align:center;letter-spacing:2px;border-bottom:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .tiles-section[_ngcontent-%COMP%]{padding:0 6px}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]{flex:50%}[_nghost-%COMP%]   .tiles-set[_ngcontent-%COMP%]{display:flex;justify-content:space-around}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:20%}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:50%}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:33%}}@media only screen and (max-width:280px){[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:50%}}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]{padding-top:8px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;gap:8px;width:100%;margin-bottom:8px}@media only screen and (max-width:500px){[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   .tiles-select[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;gap:8px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;height:100%;flex:1}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-reference[_ngcontent-%COMP%]{text-align:center}"]})}}return i})();function oi(){let i={adjointed:["circles","diamonds"],african:[[1,5]],batik:[[1,7]],blobs:[],"brick-wall":[[1,2]],"candy-cane":[1],chainlink:[[1,3]],checkerboard:[],chevron:[1,2,3,4,5,7,8,11,13,14,15],chinese:[[1,14]],"christmas-bells":[1],"christmas-gift":[],"christmas-pattern":[[1,7]],"christmas-tree":[1,"balls"],circles:[[1,17],19,20,22,"and-diamonds"],"concentric-circles":[[1,6]],"cross-section":[],cubes:[[1,6]],diamonds:[[1,15],17,18,19,20,21],doodle:[[1,2]],"double-bubble":[[1,4]],egyptian:[1,2,3,4,6,8,9,10,12],"ethnic-pattern":[[1,3]],eyes:[[1,4]],flower:[[1,7]],geometric:[[1,10]],"greek-key":[],halloween:[[1,7]],hearts:[3,5,9],herringbone:[[1,8]],hexagon:[[1,11],13],"interlocked-hexagons":[[1,4]],"inverted-triangles":[],"japanese-pattern":[1,2,3,4,5,6,7,8,12],jigsaw:[],lanterns:[1],leaves:[[1,10]],lines:[1,2,3,4,5,6,8],memphis:[1,2,3,4,5,6,10],"mexican-pattern":[[1,2]],moroccan:[[1,2]],new:[[1,17]],octagons:[[1,2]],"overlapping-hexagons":[],patches:[],pipes:[],"plaid-pattern":[[1,6]],plus:[[1,6]],"quarter-circles":[[1,2]],railroad:[],"rectangles-and-squares":[1],rope:[1],"santa-claus":[],scales:[[1,9]],semicircles:[1],snowflakes:[1],songket:[1],sprinkles:[1],squares:[[1,9]],"squares-and-plus":[1,2],"squares-and-squares":[1,2],"squares-and-triangles":[1,2],"squares-and-stars":[1,2],"squares-and-diamonds":[],"squares-and-diamonds-2":[],"squares-and-circles":[[1,3]],squiggle:[1],"stained-glass":[],stars:[[1,8]],"stars-and-lines":[1,2],"straight-lines":[],stripes:[[1,2]],terrazzo:[1],tiles:[[1,3]],triangles:[[1,25],27,28],tribal:[[1,5]],waves:[[1,20],22,24],zebra:[]},o=[];for(let[e,t]of Object.entries(i)){t.length===0&&o.push({id:e});for(let n of t)if(Array.isArray(n)){let[r,a]=n;for(let s=r;s<=a;s++)o.push({id:`${e}-${s}`})}else o.push({id:`${e}-${n}`})}return o.map(e=>({id:e.id,title:e.id.split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join(" ")}))}function mo(i){let o=i.replace(/\s+/g," ").replace(/>\s+</g,"><").trim();return encodeURIComponent(o)}function uo(i,o,e,t,n,r,a,s,c,d,p,m,C,E,w){let A="";r==="stroke-join"&&(A=C==2?"stroke-linejoin='round' stroke-linecap='round' ":"stroke-linecap='square' ");function I(W){let ve=a[W+1];t===0&&n>2&&(s===3&&n===4&&W===2||s===4&&n===5&&W===3||s===3&&n===5&&W===3||s===3&&n===5&&W===2||s===2)&&(ve=a[1]);let Z;r==="stroke-join"?Z=` stroke='${ve}' fill='none'`:r==="stroke"?Z=` stroke='${ve}' fill='none'`:Z=` stroke='none' fill='${ve}'`;let de=p[0]/2===0?"":` transform='translate(${p[0]/2},${t})'`;return`<path d='${i[W]}' stroke-width='${c}'${Z} ${de}${A}/>`}let R=[],X=Math.min(i.length,t===0&&n>2?n-1:s);for(let W=0;W<X;W++)R.push(I(W));return["<svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg'>","<defs>",`<pattern id='a' patternUnits='userSpaceOnUse' width='${o+p[0]}' height='${e-t*(n-s)+p[1]}' patternTransform='scale(${d}) rotate(${m})'>`,...R,"</pattern></defs>",`<rect width='800%' height='800%' transform='translate(${d*E},${d*w})' fill='url(#a)'/>`,"</svg>"].join("")}var ri=(()=>{class i{constructor(){this.http=k(Ie),this.cache={}}get(e){return pe(this,null,function*(){let t=this.cache[e];if(t){if(t.data)return t.data;if(t.request!==void 0)return t.request}t={};let n=new Promise((r,a)=>{setTimeout(()=>{this.http.get(`assets/patterns/${e}.json`,{responseType:"text"}).subscribe({next:s=>{t.data=s,t.request=void 0,r(s)},error:s=>{a(s)}})})});return t.request=n,this.cache[e]=t,n})}svgDataUrl(e,t){return pe(this,null,function*(){let n=yield this.get(e);return`url("data:image/svg+xml;utf8,${this.svgBackground(n,t)}")`})}svgBackground(e,t){let n=JSON.parse(e),r=uo(n.path,n.width,n.height,n.vHeight??0,n.path.length+1,n.mode,["",...t],t.length+1,1,1,n.spacing??[0,0],0,1,0,0);return mo(r)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var _o=["kyodaiInput"],ai=(i,o)=>o.id,fo=(i,o)=>o.source;function Co(i,o){if(i&1){let e=$();g(0,"input",29),v("change",function(){let n=x(e).$implicit,r=M();return y(r.setSelectedTab(n.id))}),h()}if(i&2){let e=o.$implicit,t=M();P("id",`tab-${e.id}`)("checked",t.selectedTab===e.id)}}function Mo(i,o){if(i&1&&(g(0,"label",3),f(1),u(2,"translate"),h()),i&2){let e=o.$implicit;P("id",`tab-${e.id}-label`)("for",`tab-${e.id}`),l(),O(_(2,3,e.name))}}function Po(i,o){if(i&1){let e=$();g(0,"li")(1,"input",30),v("change",function(){let n=x(e).$implicit,r=M();return r.app.settings.lang=n.key,y(r.app.setLang())}),h(),g(2,"label",31),f(3),h()()}if(i&2){let e=o.$implicit,t=o.$index,n=M();l(),P("id","lang"+(t+1))("value",e.key)("checked",n.app.settings.lang===e.key),ee("aria-label",e.title),l(),P("for","lang"+(t+1)),l(),O(e.title)}}function Oo(i,o){if(i&1){let e=$();g(0,"li")(1,"input",32),v("change",function(){let n=x(e).$implicit,r=M();return r.app.settings.tileset=n.id,y(r.app.settings.save())}),h(),g(2,"label",31),f(3),h(),S(4,"app-license-link",33),h()}if(i&2){let e=o.$implicit,t=o.$index,n=M();l(),P("id",J("imageset",t))("value",e.id)("checked",n.app.settings.tileset===e.id),ee("aria-label",e.name),l(),P("for",J("imageset",t)),l(),z(" ",e.name," "),l(),P("link",J("https://github.com/ffalt/mah/blob/main/src/assets/svg/README.md#",e.id,"svg"))("licenseKey",e.license)}}function bo(i,o){if(i&1){let e=$();g(0,"li")(1,"input",34),u(2,"translate"),v("change",function(){x(e);let n=M();return n.app.settings.tileset="kyodai",y(n.app.settings.save())}),h(),g(3,"label",35),f(4),u(5,"translate"),h()()}if(i&2){let e=M();l(),P("checked",e.app.settings.tileset==="kyodai"),ee("aria-label",_(2,3,"KYODAI_TILESET")),l(3),O(_(5,5,"KYODAI_TILESET"))}}function vo(i,o){if(i&1&&(g(0,"option",45),f(1),h()),i&2){let e=o.$implicit;P("value",e.source),l(),Ue("",e.name," - ",e.author)}}function xo(i,o){if(i&1){let e=$();g(0,"fieldset",13)(1,"legend",36),f(2),u(3,"translate"),h(),g(4,"div",37)(5,"textarea",38,0),u(7,"translate"),v("change",function(n){x(e);let r=M();return y(r.updateKyodaiUrl(n))}),h(),g(8,"button",39),u(9,"translate"),u(10,"translate"),v("click",function(){x(e);let n=M();return y(n.clearKyodaiUrl())}),K(),g(11,"svg",40),S(12,"path",41)(13,"path",42),h()(),He(),g(14,"select",43),u(15,"translate"),v("change",function(n){x(e);let r=M();return y(r.setKyodaiUrl(n))}),g(16,"option",44),f(17),u(18,"translate"),h(),F(19,vo,2,3,"option",45,fo),h()(),g(21,"button",46),u(22,"translate"),v("click",function(){x(e);let n=M();return y(n.applyKyodaiUrl())}),f(23),u(24,"translate"),h()()}if(i&2){let e=M();l(2),O(_(3,14,"KYODAI_TILESET_SETTINGS")),l(3),P("placeholder",j(_(7,16,"KYODAI_TILESET_URL_PLACEHOLDER")))("value",e.app.settings.kyodaiUrl?e.app.settings.kyodaiUrl:""),l(3),P("title",j(_(9,18,"KYODAI_TILESET_CLEAR"))),Ve("aria-label",j(_(10,20,"KYODAI_TILESET_CLEAR"))),l(6),Ve("aria-label",j(_(15,22,"KYODAI_TILESET_EXAMPLES"))),l(3),O(_(18,24,"KYODAI_TILESET_EXAMPLES")),l(2),N(e.kyodaiTileSets),l(2),Ve("aria-label",j(_(22,26,"KYODAI_TILESET_LOAD"))),l(2),z(" ",_(24,28,"KYODAI_TILESET_LOAD")," ")}}function yo(i,o){if(i&1){let e=$();g(0,"li")(1,"input",47),u(2,"translate"),v("change",function(){let n=x(e).$implicit,r=M();return r.app.settings.theme=n.id||"",y(r.app.settings.save())}),h(),g(3,"label",31),f(4),u(5,"translate"),h(),g(6,"div",48),S(7,"div",49),h()()}if(i&2){let e=o.$implicit,t=o.$index,n=M();l(),P("id",J("color",t))("value",e.id)("checked",n.app.settings.theme===e.id),ee("aria-label",_(2,10,e.name)),l(2),P("for",J("color",t)),l(),O(_(5,12,e.name)),l(3),fe("theme-"+e.id)}}function wo(i,o){if(i&1&&S(0,"app-license-link",51),i&2){let e=M(2).$implicit;P("licenseKey",e.license)}}function ko(i,o){if(i&1&&S(0,"app-license-link",33),i&2){let e=M(2).$implicit;P("link",J("https://github.com/ffalt/mah/blob/main/src/assets/img/README.md#",e.img,"jpg"))("licenseKey",e.license)}}function So(i,o){if(i&1&&T(0,wo,1,1,"app-license-link",51)(1,ko,1,3,"app-license-link",33),i&2){let e=M().$implicit;L(e.type==="MAH"?0:1)}}function Eo(i,o){if(i&1){let e=$();g(0,"li")(1,"input",50),u(2,"translate"),v("change",function(){let n=x(e).$implicit,r=M();return y(r.setBackground(n.img))}),h(),g(3,"label",31),f(4),u(5,"translate"),h(),T(6,So,2,1),h()}if(i&2){let e=o.$implicit,t=o.$index,n=M();l(),P("id",J("back",t))("value",e.img)("checked",n.app.settings.background===e.img),ee("aria-label",_(2,9,e.name)),l(2),P("for",J("back",t)),l(),O(_(5,11,e.name)),l(2),L(e.license?6:-1)}}function To(i,o){if(i&1){let e=$();g(0,"li")(1,"input",54),v("change",function(){let n=x(e).$implicit,r=M(2);return r.app.settings.pattern=n.id,y(r.app.settings.save())}),h(),g(2,"label",31),f(3),h()()}if(i&2){let e=o.$implicit,t=o.$index,n=M(2);l(),P("id",J("pattern",t))("value",e.id)("checked",n.app.settings.pattern===e.id),ee("aria-label",e.title),l(),P("for",J("pattern",t)),l(),O(e.title)}}function Lo(i,o){if(i&1&&(g(0,"fieldset",24)(1,"legend",52),f(2),u(3,"translate"),h(),g(4,"ul",53),F(5,To,4,8,"li",null,U),h()()),i&2){let e=M();l(2),O(_(3,1,"PATTERN_SETTINGS")),l(3),N(e.patterns)}}var si=[{id:"lang",name:"LANG"},{id:"stones",name:"TILESET"},{id:"theme",name:"THEME"},{id:"background",name:"BACKGROUND"},{id:"data",name:"DATA"}],li=(()=>{class i{constructor(){this.kyodaiInput=me.required("kyodaiInput"),this.canKyodai=ne.kyodai,this.kyodaiTileSets=Qn,this.sets=st,this.backs=at,this.themes=ze,this.PatternBackground=Rn,this.languages=Object.keys(Ye).map(e=>({key:e,title:Ye[e].title})),this.app=k(ue),this.tabs=si,this.patterns=oi(),this.selectedTab=this.app.getCachedValue("settings.selectedTab")??si[0].id,this.element=k(Pe),this.storage=k(Be),this.layoutService=k(Ce),this.translate=k(De)}ngAfterViewInit(){this.element?.nativeElement&&this.restoreScroll(this.element.nativeElement)}setBackground(e){this.app.settings.background=e,this.app.settings.save()}updateKyodaiUrl(e){this.app.settings.kyodaiUrl=e.target.value,this.app.settings.save()}clearKyodaiUrl(){this.app.settings.kyodaiUrl=void 0,this.app.settings.tileset=Re,this.app.settings.save()}setKyodaiUrl(e){let t=this.kyodaiInput();t.nativeElement&&(e.preventDefault(),e.stopPropagation(),t.nativeElement.value=e.target.value)}applyKyodaiUrl(){let e=this.kyodaiInput();e.nativeElement&&(this.app.settings.kyodaiUrl=e.nativeElement.value,this.app.settings.save())}setSelectedTab(e){this.selectedTab=e,this.app.cacheValue("settings.selectedTab",e)}restoreScroll(e){if(!e)return;let t=this.app.getCachedValue("settings.scrollTop");setTimeout(()=>e.scrollTop=t??0,0)}onScroll(e){let t=e.target.scrollTop;this.app.cacheValue("settings.scrollTop",t)}clearTimes(){return pe(this,null,function*(){let e=yield this.layoutService.get();for(let t of e.items)this.storage.clearScore(t.id)})}clearTimesClick(){confirm(this.translate.instant("BEST_TIMES_CLEAR_SURE"))&&this.clearTimes().catch(e=>console.error(e))}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-settings"]],viewQuery:function(t,n){t&1&&Ee(n.kyodaiInput,_o,5),t&2&&Te()},hostBindings:function(t,n){t&1&&v("scroll",function(a){return n.onScroll(a)})},decls:76,vars:51,consts:[["kyodaiInput",""],["type","radio","name","settings-tab",1,"tabs-input",3,"id","checked"],["role","tablist","aria-label","Settings Tabs",1,"tabs-labels"],["role","tab",3,"id","for"],[1,"tabs-panels","panels"],["id","panel-lang","role","tabpanel","aria-labelledby","tab-lang-label",1,"panel"],["id","lang-legend"],["role","group","aria-labelledby","lang-legend",1,"radio"],["type","radio","name","lang","id","lang0","value","auto",3,"change","checked"],["for","lang0"],["id","panel-stones","role","tabpanel","aria-labelledby","tab-stones-label",1,"panel"],["id","tileset-legend"],["role","group","aria-labelledby","tileset-legend",1,"radio","radio-tilesets"],[1,"kyodai-settings"],["id","tiles-legend"],["role","group","aria-labelledby","tiles-legend",1,"checks"],[1,"check"],["type","checkbox",3,"change","checked","aria-label"],["id","panel-theme","role","tabpanel","aria-labelledby","tab-theme-label",1,"panel"],["id","theme-legend"],["role","group","aria-labelledby","theme-legend",1,"radio","radio-themes"],["id","panel-background","role","tabpanel","aria-labelledby","tab-background-label",1,"panel"],["id","background-legend"],["role","group","aria-labelledby","background-legend",1,"radio"],[1,"pattern-settings"],["id","panel-data","role","tabpanel","aria-labelledby","tab-data-label",1,"panel"],["id","times-legend"],[1,"button-group"],[1,"clear-times",3,"click","aria-label"],["type","radio","name","settings-tab",1,"tabs-input",3,"change","id","checked"],["type","radio","name","lang",3,"change","id","value","checked"],[3,"for"],["type","radio","name","imageset",3,"change","id","value","checked"],[3,"link","licenseKey"],["type","radio","name","imageset","value","kyodai","id","imageset-kyodai",3,"change","checked"],["for","imageset-kyodai"],["id","kyodai-legend"],[1,"input-wrapper"],["type","text","name","kyodai","aria-labelledby","kyodai-legend","aria-describedby","kyodai-help",3,"change","value","placeholder"],[1,"clear-kyodai",3,"click","title","aria-label"],["width","17px","height","17px","viewBox","0 0 35 35","aria-hidden","true"],["d","M28.814,30.064a1.247,1.247,0,0,1-.884-.367L5.3,7.07A1.249,1.249,0,0,1,7.07,5.3L29.7,27.93a1.251,1.251,0,0,1-.884,2.134Z"],["d","M6.186,30.064A1.251,1.251,0,0,1,5.3,27.93L27.93,5.3A1.25,1.25,0,0,1,29.7,7.07L7.07,29.7A1.247,1.247,0,0,1,6.186,30.064Z"],[1,"example-kyodai",3,"change","aria-label"],["value",""],[3,"value"],[3,"click","aria-label"],["type","radio","name","color",3,"change","id","value","checked"],[1,"theme-preview-wrapper"],[1,"theme-preview"],["type","radio","name","back",3,"change","id","value","checked"],["link","https://github.com/ffalt/mah/blob/main/src/assets/patterns/README.md",3,"licenseKey"],["id","pattern-legend"],["role","group","aria-labelledby","pattern-legend",1,"radio","radio-patterns"],["type","radio","name","pattern",3,"change","id","value","checked"]],template:function(t,n){t&1&&(F(0,Co,1,2,"input",1,ai),g(2,"div",2),F(3,Mo,3,5,"label",3,ai),h(),g(5,"div",4)(6,"section",5)(7,"fieldset")(8,"legend",6),f(9),u(10,"translate"),h(),g(11,"ul",7)(12,"li")(13,"input",8),u(14,"translate"),v("change",function(){return n.app.settings.lang="auto",n.app.setLang()}),h(),g(15,"label",9),f(16),u(17,"translate"),h()(),F(18,Po,4,6,"li",null,U),h()()(),g(20,"section",10)(21,"fieldset")(22,"legend",11),f(23),u(24,"translate"),h(),g(25,"ul",12),F(26,Oo,5,11,"li",null,U),T(28,bo,6,7,"li"),h()(),T(29,xo,25,30,"fieldset",13),g(30,"fieldset")(31,"legend",14),f(32),u(33,"translate"),h(),g(34,"ul",15)(35,"li")(36,"label",16)(37,"input",17),u(38,"translate"),v("change",function(){return n.app.settings.contrast=!n.app.settings.contrast,n.app.settings.save()}),h(),g(39,"span"),f(40),u(41,"translate"),h()()(),g(42,"li")(43,"label",16)(44,"input",17),u(45,"translate"),v("change",function(){return n.app.settings.dark=!n.app.settings.dark,n.app.settings.save()}),h(),g(46,"span"),f(47),u(48,"translate"),h()()()()()(),g(49,"section",18)(50,"fieldset")(51,"legend",19),f(52),u(53,"translate"),h(),g(54,"ul",20),F(55,yo,8,14,"li",null,U),h()()(),g(57,"section",21)(58,"fieldset")(59,"legend",22),f(60),u(61,"translate"),h(),g(62,"ul",23),F(63,Eo,7,13,"li",null,U),h()(),T(65,Lo,7,3,"fieldset",24),h(),g(66,"section",25)(67,"fieldset")(68,"legend",26),f(69),u(70,"translate"),h(),g(71,"div",27)(72,"button",28),u(73,"translate"),v("click",function(){return n.clearTimesClick()}),f(74),u(75,"translate"),h()()()()()),t&2&&(N(n.tabs),l(3),N(n.tabs),l(6),O(_(10,23,"LANG")),l(4),P("checked",n.app.settings.lang==="auto"),ee("aria-label",_(14,25,"LANG_AUTO")),l(3),O(_(17,27,"LANG_AUTO")),l(2),N(n.languages),l(5),O(_(24,29,"TILESET")),l(3),N(n.sets),l(2),L(n.canKyodai?28:-1),l(),L(n.canKyodai&&n.app.settings.tileset==="kyodai"?29:-1),l(3),O(_(33,31,"TILES")),l(5),Ve("aria-label",j(_(38,33,"HIGHER_CONTRAST"))),P("checked",n.app.settings.contrast),l(3),O(_(41,35,"HIGHER_CONTRAST")),l(4),Ve("aria-label",j(_(45,37,"TILES_DARK"))),P("checked",n.app.settings.dark),l(3),O(_(48,39,"TILES_DARK")),l(5),O(_(53,41,"THEME")),l(3),N(n.themes),l(5),O(_(61,43,"BACKGROUND")),l(3),N(n.backs),l(2),L(n.app.settings.background===n.PatternBackground?65:-1),l(4),O(_(70,45,"BEST_TIMES")),l(3),Ve("aria-label",j(_(73,47,"BEST_TIMES_CLEAR"))),l(2),z(" ",_(75,49,"BEST_TIMES_CLEAR")," "))},dependencies:[Pt,te],styles:['[_nghost-%COMP%]{flex:1;overflow-y:auto;width:100%;height:100%;display:flex;flex-direction:column;position:relative}@media only screen and (max-width:1000px){[_nghost-%COMP%]{gap:8px;padding:4px}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{border:1px solid var(--main-bg-color-lt);border-radius:8px;padding:12px;margin:0;background-color:var(--dialog-background-color);transition:all .2s ease}@media only screen and (max-width:700px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{padding:10px}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{padding:0 8px;font-weight:600;color:var(--primary-text-colddor);margin-left:-4px;font-size:.95em;display:none}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:0;display:flex;gap:6px;height:40px;min-height:40px;line-height:40px;align-items:center;border-radius:6px;transition:background-color .15s ease;box-sizing:border-box;break-inside:avoid;flex:1}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:focus-within{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{columns:2;text-align:left;list-style:none;padding:0;margin:0;vertical-align:text-bottom}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{vertical-align:middle;line-height:1.2;-webkit-user-select:none;user-select:none;white-space:normal;text-overflow:ellipsis;cursor:pointer;flex:1;font-size:.95em;height:100%;display:flex;align-items:center}@media only screen and (max-width:400px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{-webkit-hyphens:auto;hyphens:auto;word-break:break-all}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-shrink:0}@media only screen and (max-width:350px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{list-style:none;padding:0 0 0 13px;margin:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-left:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:8px;padding:8px;margin:-8px;border-radius:6px;transition:background-color .15s ease;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:focus-within{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{padding:2px;display:flex;align-items:center;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;flex-shrink:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95em}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]{background-color:var(--dialog-background-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;position:relative;border:1px solid var(--input-border-color);background-color:var(--input-background-color);border-radius:6px;margin:8px 0;overflow:hidden;transition:border-color .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;border:none;resize:none;outline:none;font-size:10px;background-color:var(--input-background-color);color:var(--input-text-color);padding:10px;font-family:monospace;line-height:1.4}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus-visible{outline:none}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:after{position:absolute;content:"";right:18px;top:calc(50% - 4px);width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid var(--input-text-color);pointer-events:none}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]{background-image:unset;background-color:var(--input-background-color);color:var(--input-background-color);border:1px solid var(--input-border-color);border-left:1px solid var(--input-border-color);width:44px;padding:0;display:flex;align-items:center;justify-content:center;appearance:none;cursor:pointer}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]{background-color:var(--input-background-color);color:var(--input-text-color);border:1px solid var(--input-border-color);border-left:1px solid var(--input-border-color);width:44px;padding:0;margin-left:-1px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--input-text-color);transition:fill .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:active{background-color:var(--dialog-background-color)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]{columns:2}@media only screen and (max-width:500px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{flex-wrap:nowrap;align-items:center;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   app-license-link[_ngcontent-%COMP%]{margin-left:auto;flex-shrink:0}@media only screen and (max-width:500px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview-wrapper[_ngcontent-%COMP%]{display:block;border:1px solid #000}@media(prefers-color-scheme:dark){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview-wrapper[_ngcontent-%COMP%]{border-color:#6e6e6e}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview[_ngcontent-%COMP%]{background-color:var(--main-bg-color);display:block;width:20px;height:20px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:3}@media only screen and (max-width:700px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:2}}@media only screen and (max-width:400px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   .tabs-input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:1px;height:1px;margin:-1px;padding:0;border:0;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-top:2px;margin-bottom:16px;padding-bottom:8px}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]{background:transparent;color:var(--input-text-color);padding:8px 0;border-radius:0;border:none;border-bottom:2px solid transparent;font-weight:600;cursor:pointer;min-width:auto;text-align:center;position:relative;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:focus-visible{color:var(--dialog-headline-color);outline:none;border-bottom-color:var(--gesture-indicator)}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.35}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:hover:not(:disabled){color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color);opacity:.9}[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{flex:1;padding-right:8px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{background:var(--dialog-background-color);display:none;width:100%;height:100%;flex-direction:column;justify-content:center;gap:8px}[_nghost-%COMP%]   #lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]{color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color);font-weight:700}[_nghost-%COMP%]   #lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]:hover{color:var(--text-highlight-color);border-bottom-color:var(--text-highlight-color)}@media(prefers-color-scheme:dark){[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{border-bottom-color:var(--input-border-color)}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]{color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color)}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]:hover{color:var(--main-text-color);border-bottom-color:var(--main-text-color)}}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-lang[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-background[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-stones[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-theme[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-data[_ngcontent-%COMP%]{display:flex}@media only screen and (max-height:400px){[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:none}}']})}}return i})();function zt(i){return(i<10?"0":"")+i.toString()}var Ot=(()=>{class i{transform(e){if(Number.isNaN(e)||e===0)return"-";let t=Math.floor(e/1e3),n=Math.floor(t/3600),r=Math.floor((t-n*3600)/60),a=t-n*3600-r*60;return`${n>0?`${zt(n)}:`:""}${zt(r)}:${zt(a)}`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=xe({name:"duration",type:i,pure:!0})}}return i})();var ye=class i{static{this.empty=new i(0,0,0,0)}constructor(o,e,t,n){this.left=o,this.top=e,this.right=t,this.bottom=n}static fromElement(o){let{left:e,top:t,right:n,bottom:r}=o.getBoundingClientRect();return new i(e,t,n,r)}static fromWindow(o){return new i(0,0,o.innerWidth,o.innerHeight)}inflate(o){this.left-=o,this.top-=o,this.right+=o,this.bottom+=o}intersectsWith(o){return o.left<this.right&&this.left<o.right&&o.top<this.bottom&&this.top<o.bottom}intersectsWithY(o){return o.top<this.bottom&&this.top<o.bottom}getIntersectionWith(o){let e=Math.max(this.left,o.left),t=Math.max(this.top,o.top),n=Math.min(this.right,o.right),r=Math.min(this.bottom,o.bottom);return n>=e&&r>=t?new i(e,t,n,r):i.empty}};var Ge=(()=>{class i{constructor(){this.scrollNotify=new At,this.observeNotify=new At,this.currentViewport=new ye(0,0,0,0),this.scrollSubject=new ln,this.platformId=k(mn),this.isBrowser=xn(this.platformId),this.hasIntersectionObserver=i.checkIntersectionObserver();let e=this.scrollSubject.asObservable();this.scrollObservable=cn(e.pipe(pn(300)),e.pipe(dn(100))),this.scrollObservable.subscribe(t=>{this.scrollNotify.emit(t)}),this.currentViewport=ye.fromWindow(window)}getObserver(){return this.intersectionObserver?this.intersectionObserver:(this.intersectionObserver=new IntersectionObserver(e=>{this.observeNotify.next(e)},{threshold:0}),this.intersectionObserver)}notifyScroll(e){if(this.hasIntersectionObserver)return;let t=e.element?ye.fromElement(e.element):ye.fromWindow(window),n=t.bottom-t.top;t.bottom+=n,t.top-=n,this.currentViewport=t,this.scrollSubject.next({rect:t})}static checkIntersectionObserver(){let e="IntersectionObserver"in window,n=window.navigator.userAgent.match(/Edge\/(\d*)\./i),r=!!n&&n.length>1,a=r&&!!n&&Number.parseInt(n[1],10)>15;return e&&(!r||a)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ci=(()=>{class i{constructor(){this.scrollTo=V(),this.element=k(Pe),this.scrollNotify=k(Ge)}ngOnChanges(e){if(e.scrollTo?.currentValue){let t=e.scrollTo.currentValue;if(t.id&&t.id.length>0){let n=document.getElementById(t.id);n&&(this.element.nativeElement.scrollTop=n.offsetTop-n.offsetHeight)}}}scrollTrack(e){this.scrollNotify.notifyScroll({name:"scroll-host",element:this.element.nativeElement})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=et({type:i,selectors:[["","appDeferLoadScrollHost",""]],hostBindings:function(t,n){t&1&&v("scroll",function(a){return n.scrollTrack(a)})},inputs:{scrollTo:[1,"scrollTo"]},features:[Se]})}}return i})();var di=(()=>{class i{constructor(){this.preRender=V(!1),this.appDeferLoad=Oe(),this.timeoutLoadMS=20,this.elementRef=k(Pe),this.deferLoadService=k(Ge)}ngAfterViewInit(){this.deferLoadService.isBrowser?this.deferLoadService.hasIntersectionObserver?this.registerIntersectionObserver():this.addScrollListeners():this.preRender()&&this.load()}ngOnDestroy(){this.removeListeners()}static getScrollPosition(){return window.scrollY+(document.documentElement.clientHeight||document.body.clientHeight)}loadAndUnobserve(){this.load(),this.unobserve(),this.removeListeners()}cancelDelayLoad(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}delayLoad(){this.timeoutId||(this.timeoutId=setTimeout(()=>{this.loadAndUnobserve(),this.cancelDelayLoad()},this.timeoutLoadMS))}manageIntersection(e){this.checkIfIntersecting(e)?this.delayLoad():this.cancelDelayLoad()}registerIntersectionObserver(){this.intersectionObserver||(this.intersectionObserver=this.deferLoadService.getObserver(),this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.observe(this.elementRef.nativeElement),this.observeSubscription=this.deferLoadService.observeNotify.subscribe(e=>{this.checkForIntersection(e)})))}checkForIntersection(e){for(let t of e)t.target===this.elementRef.nativeElement&&this.manageIntersection(t)}checkIfIntersecting(e){return e?.time?e.isIntersecting:this.isVisible()}load(){this.removeListeners(),this.appDeferLoad.emit()}loadFromScroll(){setTimeout(()=>{this.load()})}addScrollListeners(){this.scrollSubscription=this.deferLoadService.scrollNotify.subscribe(e=>{this.checkInView(e.rect)&&this.loadFromScroll()}),setTimeout(()=>{this.checkInView(this.deferLoadService.currentViewport)&&this.loadFromScroll()})}unobserve(){this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.unobserve(this.elementRef.nativeElement),this.intersectionObserver=void 0)}removeListeners(){this.scrollSubscription&&(this.scrollSubscription.unsubscribe(),this.scrollSubscription=void 0),this.unobserve(),this.observeSubscription&&(this.observeSubscription.unsubscribe(),this.observeSubscription=void 0)}checkInView(e){return ye.fromElement(this.elementRef.nativeElement).intersectsWithY(e)}isVisible(){let e=i.getScrollPosition();return this.elementRef.nativeElement.offsetTop<=e}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=et({type:i,selectors:[["","appDeferLoad",""]],inputs:{preRender:[1,"preRender"]},outputs:{appDeferLoad:"appDeferLoad"}})}}return i})();function b(i,o,e){return`${i}|${o}|${e}`}function qe(i,o){return Math.floor(Math.random()*(o-i+1))+i}function he(i){return i[Math.floor(Math.random()*i.length)]}function G(i){for(let o=i.length-1;o>0;o--){let e=Math.floor(Math.random()*(o+1));[i[o],i[e]]=[i[e],i[o]]}return i}function q(i,o,e){return i>=0&&i<=36&&o>=0&&o<=16&&e>=0&&e<=5}function re(i,o,e,t){return i.has(b(o,e-1,t-1))||i.has(b(o,e,t-1))||i.has(b(o,e+1,t-1))||i.has(b(o,e-1,t))||i.has(b(o,e+1,t))||i.has(b(o,e-1,t+1))||i.has(b(o,e,t+1))||i.has(b(o,e+1,t+1))}function bt(i,o,e,t){if(o===0)return!0;let n=o-1;return i.has(b(n,e,t))||i.has(b(n,e-1,t))&&i.has(b(n,e+1,t))?!0:i.has(b(n,e-1,t-1))&&i.has(b(n,e+1,t-1))&&i.has(b(n,e-1,t+1))&&i.has(b(n,e+1,t+1))}function Xe(i,o,e,t,n){if(!q(t,n,e))return!1;let r=b(e,t,n);return i.has(r)||!bt(i,e,t,n)||re(i,e,t,n)?!1:(i.add(r),o.push([e,t,n]),!0)}function pi(i){return i%2!==0}function gi(){return he(["lines","lines","lines","checker","checker","areas","areas","rings"])}function vt(i,o){let e=[];for(let t=0;t<=o;t+=2)for(let n=0;n<=i;n+=2)e.push([n,t]);return e}function xt(i,o,e,t=0){for(let[n,r]of i)for(let a=-o;a<=o;a++)for(let s=-o;s<=o;s++){let c=n+s,d=r+a;q(c,d,t)&&e.add(b(t,c,d))}}function we(i,o,e,t=2){let n=[];for(let r=0;r<=e;r+=t)for(let a=0;a<=o;a+=t)i.has(b(0,a,r))&&n.push([0,a,r]);return n}function yt(i,o,e=1){let t=[];for(let r=0;r<=i;r+=e)t.push(r);let n=[];for(let r=0;r<=o;r+=e)n.push(r);return{xs:t,ys:n}}function Ae(i,o,e,t,n,r){let a=i;for(let[s,c]of o){if(a>=n)break;for(let[d,p]of e){if(a>=n)break;let m=r(d,p,s,c);if(m>0&&(a+=m,a>=t&&a<=n))break}if(a>=t&&a<=n)break}return a}function hi(i){return i.some(o=>o[0]>0)}function Io(i,o,e,t,n,r){let a=qe(n,r),s=a*4,c=[];for(let p of t)for(let m of e)c.push([m,p]);G(c);let d=0;for(;d<a&&s-- >0&&c.length>0;){let[p,m]=c.pop();if(p===e[0]||p===e.at(-1)||m===t[0]||m===t.at(-1))continue;let C=b(o,p,m);if(!i.has(C))continue;let E=Math.random()<.5?"h":"v",w=[];E==="h"?(w.push(C),p+1<=e.at(-1)&&w.push(b(o,p+1,m))):(w.push(C),m+1<=t.at(-1)&&w.push(b(o,p,m+1)));let A=!1;for(let I of w)i.delete(I)&&(A=!0);A&&d++}}function Do(i,o,e){for(let t of e)for(let n of o)n%2!==0||t%2!==0||i.add(b(0,n,t))}function Bo(){let i=Math.random()<.5?0:he([0,0,2,2,4]),o=Math.random()<.5?0:he([0,0,2,2,4]),e=Math.random()<.5?0:he([0,2,2,4]),t=Math.random()<.5?0:he([0,2,2,4]);return{left:i,right:o,top:e,bottom:t}}function Ao(i,o,e,t,n,r){let{left:a,right:s,top:c,bottom:d}=r;for(let p of e)for(let m of o)(m<a||m>t-s||p<c||p>n-d)&&i.delete(b(0,m,p))}function Vo(i,o,e){return Math.min(Math.max(o,Math.floor(i*.45)),e)}function Ro(i,o,e){let t=o.length;if(t<=e)return t;let n=G([...o]);for(;t>e&&n.length>0;){let r=n.pop();i.delete(b(0,r[1],r[2]))&&t--}return t}function Fo(i,o,e){let t=[];for(let n of e)for(let r of o)i.has(b(0,r,n))||t.push([0,r,n]);return t}function No(i,o,e,t){G(o);let n=e;for(;n<t&&o.length>0;){let[,r,a]=o.pop();re(i,0,r,a)||(i.add(b(0,r,a)),n++)}return n}function mi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,{xs:r,ys:a}=yt(e,t,1);Do(n,r,a);let s=Bo();Ao(n,r,a,e,t,s),Io(n,0,r,a,6,32);let c=we(n,e,t,1),d=c.length,p=Vo(d,i,o);if(d>p)Ro(n,c,p);else if(d<p){let m=Fo(n,r,a);No(n,m,d,p)}return we(n,e,t,1)}function Yt(i,o,e,t,n,r=!1){if(t%2!==0||n%2!==0||!q(t,n,0))return!1;let a=b(0,t,n);return i.has(a)||re(i,0,t,n)?!1:(i.add(a),o.push([0,t,n]),r&&e.add(a),!0)}function $o(i,o,e,t,n){let r=Math.floor(t/2),a=Math.floor(n/2);return r-=r%2,a-=a%2,q(r,a,0)||(r=0,a=0),Yt(i,o,e,r,a,!0),{sx:r,sy:a}}function jo(i,o){let e=i+o,t=Math.max(40,Math.floor(e*.8)),n=Math.max(t+100,Math.floor(e*2));return qe(t,n)}function Go(i,o){let e=[i[0],i[1]],t=[-i[0],-i[1]],n=i[0]===0?[[1,0],[-1,0]]:[[0,1],[0,-1]],r=[e,...n,t];return Math.random()<o&&(r=G(r)),Math.random()<.2&&(r=[...G([...n]),e,t]),r}function Ho(i,o,e,t,n,r,a){let s=Go(r,a);for(let[c,d]of s){let p=t+c*2,m=n+d*2;if(q(p,m,0)&&Yt(i,o,e,p,m,!0))return{x:p,y:m,direction:[c,d]}}return null}function Uo(i,o,e,t,n){let r=G([[1,0],[-1,0],[0,1],[0,-1]]);for(let[a,s]of r){let c=t+a*2,d=n+s*2;if(!(!q(c,d,0)||re(i,0,c,d)||i.has(b(0,c,d)))&&Yt(i,o,e,c,d,!0))return{x:c,y:d,direction:[a,s]}}return null}function zo(i,o,e,t,n,r){let a=Math.random()<.4?he([0,0,2]):0,s=Math.random()<.4?he([0,0,2]):0,c=Math.random()<.4?he([0,2]):0,d=Math.random()<.4?he([0,2]):0;for(let p of t)for(let m of e)if(m<a||m>n-s||p<c||p>r-d){let C=b(0,m,p);o.has(C)||i.delete(C)}}function Yo(i,o,e,t){let n=o.length,r=G([...o].filter(a=>!e.has(b(0,a[1],a[2]))));for(;n>t&&r.length>0;){let a=r.pop();i.delete(b(0,a[1],a[2]))&&n--}return n}function Ko(i,o,e,t,n,r){let a=[],s=[];for(let p of t)for(let m of e)i.has(b(0,m,p))||([[m-2,p],[m+2,p],[m,p-2],[m,p+2]].some(([w,A])=>o.has(b(0,w,A)))?a:s).push([0,m,p]);G(a),G(s);let c=[a,s],d=n;for(let p of c)for(;d<r&&p.length>0;){let[m,C,E]=p.pop();C%2===0&&E%2===0&&!re(i,0,C,E)&&(i.add(b(m,C,E)),d++)}return d}function qo(i,o,e,t,n,r,a,s){let c=we(i,a,s,1),d=c.length,p=Math.min(Math.max(n,Math.floor(d*.9)),r);d>p?Yo(i,c,o,p):d<p&&Ko(i,o,e,t,d,p)}function Xo(i,o,e){let t=[];for(let n of e)for(let r of o)i.has(b(0,r,n))&&t.push([0,r,n]);return t}function ui({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=[],a=new Set,{xs:s,ys:c}=yt(e,t,1),{sx:d,sy:p}=$o(n,r,a,e,t),m=d,C=p,w=[[1,0],[-1,0],[0,1],[0,-1]][Math.floor(Math.random()*4)],A=jo(e,t);for(let I=0;I<A;I++){let R=I%qe(6,12)===0?Math.random()*.6+.2:Math.random()*.3,X=Ho(n,r,a,m,C,w,R);if(X){m=X.x,C=X.y,w=X.direction;continue}let W=Uo(n,r,a,m,C);if(W){m=W.x,C=W.y,w=W.direction;continue}break}return zo(n,a,s,c,e,t),qo(n,a,s,c,i,o,e,t),Xo(n,s,c)}function _i(i,o,e,t){let n=i+(e-1)*2,r=o+(t-1)*2,a=[];for(let s=i;s<=n;s+=2)a.push([s,o]);for(let s=o+2;s<=r;s+=2)a.push([n,s]);for(let s=n-2;s>=i;s-=2)a.push([s,r]);for(let s=r-2;s>o;s-=2)a.push([i,s]);return a}function Kt(i,o,e,t,n,r,a){let s=`${e}x${t}`;if(a.has(s))return!1;let c=i+(e-1)*2,d=o+(t-1)*2;if(!q(c,d,0))return!1;let p=_i(i,o,e,t);for(let[m,C]of p){if(m%2!==0||C%2!==0||!q(m,C,0))return!1;let E=b(0,m,C);if(n.has(E)||r.has(E)||re(n,0,m,C))return!1}return!0}function qt(i,o,e,t,n,r,a){let s=_i(i,o,e,t);for(let[c,d]of s)n.add(b(0,c,d));return xt(s,2,r,0),a.add(`${e}x${t}`),s.length}function fi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=new Set,a=new Set,s=[];for(let p=3;p<=8;p++)for(let m=3;m<=8;m++)s.push([p,m]);G(s);let c=vt(e,t);G(c);let d=0;if(d=Ae(d,s,c,i,o,(p,m,C,E)=>Kt(p,m,C,E,n,r,a)?qt(p,m,C,E,n,r,a):0),d<i){let p=s.filter(([m,C])=>!a.has(`${m}x${C}`));G(p),G(c),d=Ae(d,p,c,i,o,(m,C,E,w)=>Kt(m,C,E,w,n,r,a)?qt(m,C,E,w,n,r,a):0)}if(d<o){let p=!0,m=!1;for(;p&&d<o;){p=!1;let C=m?[...s]:s.filter(([E,w])=>!a.has(`${E}x${w}`));if(C.length===0&&!m){m=!0;continue}G(C),G(c),d=Ae(d,C,c,i,o,(E,w,A,I)=>{if(!Kt(E,w,A,I,n,r,a))return 0;let R=qt(E,w,A,I,n,r,a);return R>0&&(p=!0),R})}}return we(n,e,t,2)}function Ci(i,o,e,t){let n=i+(e-1)*2,r=o+(t-1)*2,a=[];for(let s=o;s<=r;s+=2)for(let c=i;c<=n;c+=2)a.push([c,s]);return a}function Xt(i,o,e,t,n,r,a){let s=`${e}x${t}`;if(a.has(s))return!1;let c=i+(e-1)*2,d=o+(t-1)*2;if(!q(c,d,0))return!1;let p=Ci(i,o,e,t);for(let[m,C]of p){if(m%2!==0||C%2!==0||!q(m,C,0))return!1;let E=b(0,m,C);if(n.has(E)||r.has(E)||re(n,0,m,C))return!1}return!0}function Wt(i,o,e,t,n,r,a){let s=Ci(i,o,e,t);for(let[c,d]of s)n.add(b(0,c,d));return xt(s,2,r,0),a.add(`${e}x${t}`),s.length}function Mi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=new Set,a=new Set,s=[];for(let p=2;p<=5;p++)for(let m=2;m<=5;m++)s.push([p,m]);G(s);let c=vt(e,t);G(c);let d=Ae(0,s,c,i,o,(p,m,C,E)=>Xt(p,m,C,E,n,r,a)?Wt(p,m,C,E,n,r,a):0);if(d<i){let p=s.filter(([m,C])=>!a.has(`${m}x${C}`));G(p),G(c),d=Ae(d,p,c,i,o,(m,C,E,w)=>Xt(m,C,E,w,n,r,a)?Wt(m,C,E,w,n,r,a):0)}if(d<o){let p=!0,m=!1;for(;p&&d<o;){p=!1;let C=m?[...s]:s.filter(([E,w])=>!a.has(`${E}x${w}`));if(C.length===0&&!m){m=!0;continue}G(C),G(c),d=Ae(d,C,c,i,o,(E,w,A,I)=>{if(!Xt(E,w,A,I,n,r,a))return 0;let R=Wt(E,w,A,I,n,r,a);return R>0&&(p=!0),R})}}return we(n,e,t,2)}function wt(i,o,e){if(!i&&!o||e.length===0)return e;let t=Math.max(...e.map(w=>w[1])),n=Math.max(...e.map(w=>w[2])),r=t*2+2,a=n*2+2,s=Math.min(36,r+4),c=Math.min(16,a+4);s%2!==0&&s--,c%2!==0&&c--,s<r&&(s=Math.max(t*2,Math.min(36-36%2,r))),c<a&&(c=Math.max(n*2,Math.min(16-16%2,a)));let d=w=>s-w,p=w=>c-w,m=[...e],C=new Set(m.map(([w,A,I])=>b(w,A,I))),E=(w,A,I)=>{if(!q(A,I,w))return;let R=b(w,A,I);C.has(R)||re(C,w,A,I)||(C.add(R),m.push([w,A,I]))};if(i){let w=[...m];for(let[A,I,R]of w){let X=d(I);X!==I&&E(A,X,R)}}if(o){let w=[...m];for(let[A,I,R]of w){let X=p(R);X!==R&&E(A,I,X)}}return m}function kt(i,o,e,t){let n=e&&t,r=e&&!t||!e&&t,a;n?a=.25:r?a=.5:a=1;let s=Math.max(1,Math.floor(i*a)),c=Math.max(s,Math.floor(o*a)),d=e?Math.floor(36/2):36,p=t?Math.floor(16/2):16;return{minTarget:s,maxTarget:c,xMax:d,yMax:p}}function Pi(i,o,e){if(e==="checker"){let{minTarget:t,maxTarget:n}=kt(70,120,i,o),r=i?7:14,a=i?Math.floor(36/2):36,s=o?6:12,c=o?Math.floor(16/2):16,d=Math.floor(Math.random()*(a-r+1))+r,p=Math.floor(Math.random()*(c-s+1))+s;return wt(i,o,mi({minTarget:t,maxTarget:n,xMax:d,yMax:p}))}if(e==="lines")return wt(i,o,ui(kt(60,80,i,o)));if(e==="rings")return wt(i,o,fi(kt(70,120,i,o)));if(e==="areas")return wt(i,o,Mi(kt(60,100,i,o)));throw new Error("Invalid mode")}function Wo(i,o){let e=36,t=0,n=16,r=0;for(let[a,s,c]of i)a===o-1&&(e=Math.min(e,s),t=Math.max(t,s),n=Math.min(n,c),r=Math.max(r,c));return e>t||n>r?null:{minX:Math.max(0,e-2),maxX:Math.min(36,t+2),minY:Math.max(0,n-2),maxY:Math.min(16,r+2)}}function Zo(i,o,e){let t=[],n=[],r=[],a=o-1;for(let s=e.minY;s<=e.maxY;s++)for(let c=e.minX;c<=e.maxX;c++){let d=b(o,c,s);if(i.has(d)||!q(c,s,o))continue;let p=i.has(b(a,c,s)),m=i.has(b(a,c-1,s))&&i.has(b(a,c+1,s)),C=i.has(b(a,c-1,s-1))&&i.has(b(a,c+1,s-1))&&i.has(b(a,c-1,s+1))&&i.has(b(a,c+1,s+1));(p||m||C)&&(C?t.push([c,s]):m?n.push([c,s]):p&&r.push([c,s]))}return{bridgeLarge:t,bridgeSmall:n,direct:r}}function Qo(i,o,e){let t=[],n=o-1;if(Math.random()<.25)for(let r=e.minY;r<=e.maxY;r++)for(let a=e.minX;a<=e.maxX;a++){if(!i.has(b(n,a,r)))continue;let s=[[-1,0],[1,0],[0,-1],[0,1]],[c,d]=he(s),p=a+c,m=r+d;if(!q(p,m,o))continue;let C=b(o,p,m);i.has(C)||t.push([p,m])}return t}function Jo(i){let o=Math.trunc(Math.random()*i);return o-=o%2,Math.max(o,2)}function er(i,o,e,t,n,r,a,s,c){if(!Xe(i,o,e,t,n))return!1;if(r||a){let d=s(t),p=c(n);r&&d!==t&&Xe(i,o,e,d,n),a&&p!==n&&Xe(i,o,e,t,p),r&&a&&(d!==t||p!==n)&&Xe(i,o,e,d,p)}return!0}function tr(i,o,e,t){if(i.length>=144)return i;let n=Wo(i,o);if(!n)return i;let r=new Set(i.map(R=>b(R[0],R[1],R[2]))),{bridgeLarge:a,bridgeSmall:s,direct:c}=Zo(r,o,n),d=Qo(r,o,n),p=144-i.length,m=Jo(p),C=0,{mirX:E,mirY:w}=Oi(i),A=[...i],I=R=>{for(let[X,W]of R){if(C>=m||A.length>=144)return;er(r,A,o,X,W,e,t,E,w)&&C++}};return I(a),I(s),I(c),I(d),A}function nr(i,o,e){let t=i;for(let n=1;n<=5&&t.length<144;n++)t=tr(t,n,o,e);return t.length>144?t.slice(0,144):t}function Oi(i){let o=i.map(d=>d[1]),e=i.map(d=>d[2]),t=o.length>0?Math.min(...o):0,n=o.length>0?Math.max(...o):36,r=e.length>0?Math.min(...e):0,a=e.length>0?Math.max(...e):16,s=(t+n)/2,c=(r+a)/2;return{mirX:d=>Math.round(2*s-d),mirY:d=>Math.round(2*c-d)}}function ir(i,o,e,t,n,r,a,s,c){let d=[[t,n]];if(r){let p=s(t);p!==t&&d.push([p,n])}if(a){let p=c(n);if(d.some(m=>m[0]===t&&m[1]===p)||d.push([t,p]),r){let m=s(t),C=c(n);d.some(E=>E[0]===m&&E[1]===C)||d.push([m,C])}}for(let[p,m]of d){if(!q(p,m,e))return!1;let C=b(e,p,m);if(o.has(C)||!bt(o,e,p,m)||re(o,e,p,m))return!1}if(i.length+d.length>144)return!1;for(let[p,m]of d){let C=b(e,p,m);o.add(C),i.push([e,p,m])}return!0}function or(i,o,e){let t=new Set(i.map(s=>b(s[0],s[1],s[2]))),{mirX:n,mirY:r}=Oi(i),a=!0;for(;i.length<144&&a;){a=!1;for(let s=0;s<=5&&i.length<144;s++){let c=[];for(let d=0;d<=16;d++)for(let p=0;p<=36;p++)q(p,d,s)&&(t.has(b(s,p,d))||c.push([p,d]));for(let d=c.length-1;d>0;d--){let p=Math.floor(Math.random()*(d+1));[c[d],c[p]]=[c[p],c[d]]}for(let[d,p]of c){if(i.length>=144)break;ir(i,t,s,d,p,o,e,n,r)&&(a=!0)}}}return i}function rr(i){let o=36,e=0,t=16,n=0;for(let[,r,a]of i)o=Math.min(o,r),e=Math.max(e,r),t=Math.min(t,a),n=Math.max(n,a);return{minX:Math.max(0,o-2),maxX:Math.min(36,e+2),minY:Math.max(0,t-2),maxY:Math.min(16,n+2)}}function ar(i,o,e){for(let t=5;t>=0;t--)for(let n=e.minY;n<=e.maxY;n++)for(let r=e.minX;r<=e.maxX;r++){if(!q(r,n,t))continue;let a=b(t,r,n);if(!o.has(a)&&bt(o,t,r,n)&&!re(o,t,r,n))return o.add(a),i.push([t,r,n]),!0}return!1}function sr(i){let o=new Map;for(let[e,t,n]of i)o.set(b(e,t,n),0);for(let[e,t,n]of i){if(e===0)continue;let r=e-1,a=[b(r,t,n),b(r,t-1,n),b(r,t+1,n),b(r,t-1,n-1),b(r,t+1,n-1),b(r,t-1,n+1),b(r,t+1,n+1)];for(let s of a)o.has(s)&&o.set(s,(o.get(s)||0)+1)}return o}function lr(i,o){let e=-1,t=-1;for(let n=i.length-1;n>=0;n--){let[r,a,s]=i[n],c=b(r,a,s);(o.get(c)||0)===0&&r>=t&&(e=n,t=r)}return e}function cr(i){if(!pi(i.length))return i;let o=new Set(i.map(r=>b(r[0],r[1],r[2]))),e=rr(i);if(ar(i,o,e)||i.length===0)return i;let t=sr(i),n=lr(i,t);return n>=0?i.splice(n,1):i.pop(),i}function bi(i,o,e){let t=[...i],n=0;for(;t.length<144&&n<50;){n++;let r=t.length;if(t=nr(t,o,e),t.length===r)break}return t.length<144&&(t=or(t,o,e)),t.length>144&&(t=t.slice(0,144)),t=cr(t),t}var vi=100;function dr(i,o,e){let t=Pi(i,o,e);for(let n=0;n<vi;n++){let r=bi(t,i,o);if(r.length===144)return r}return[]}function xi(i,o,e){let t=i==="random"?Math.random()<.5:i==="true",n=o==="random"?Math.random()<.5:o==="true",r=e==="random"?gi():e,a=[],s=0;for(;a.length!==144||!hi(a);)if(a=dr(t,n,r),s++,s>vi)return[];return Yn(a)}var yi=(()=>{class i{constructor(){this.translate=k(De)}transform(e){let t=`CAT_${e.toUpperCase()}`,n=this.translate.instant(t);return n===t?e:n}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=xe({name:"translateGroup",type:i,pure:!0})}}return i})();var pr=["scrollHost"];function gr(i,o){if(i&1){let e=$();g(0,"a",4),v("click",function(){let n=x(e).$index,r=M(2);return y(r.scrollToGroup(n))}),f(1),u(2,"translateGroup"),h()}if(i&2){let e=o.$implicit;l(),O(_(2,1,e.name))}}function hr(i,o){if(i&1&&(g(0,"div",1),F(1,gr,3,3,"a",null,U),h()),i&2){let e=M();l(),N(e.groups)}}function mr(i,o){if(i&1&&f(0),i&2){let e=M(2).$implicit;z(" [",e.layouts.length,"] ")}}function ur(i,o){if(i&1){let e=$();g(0,"div",6),v("click",function(){x(e);let n=M().$implicit;return y(n.expanded=!n.expanded)}),S(1,"span",7),f(2),u(3,"translateGroup"),g(4,"span",8),T(5,mr,1,1),h()()}if(i&2){let e=M().$implicit;l(),Q("expanded",e.expanded),l(),z(" ",_(3,4,e.name)," "),l(3),L(e.isRandom?-1:5)}}function _r(i,o){if(i&1&&S(0,"app-layout-preview",27),i&2){let e=M().$implicit;P("svg",e.layout.previewSVG)("alt",e.layout.name)}}function fr(i,o){if(i&1&&S(0,"div",30),i&2){let e=M().$implicit;Q("selected",e.selected),P("id","item-"+e.layout.id)}}function Cr(i,o){if(i&1){let e=$();g(0,"div",26),v("keydown.enter",function(){let n=x(e).$implicit,r=M(4);return y(r.onStart(n))})("click",function(){let n=x(e).$implicit,r=M(4);return y(r.onStart(n))})("appDeferLoad",function(){let n=x(e).$implicit;return y(n.visible=!0)}),T(1,_r,1,2,"app-layout-preview",27)(2,fr,1,3,"div",28),g(3,"div",29),f(4),h()()}if(i&2){let e=o.$implicit;Q("selected",e.selected),P("id","item-"+e.layout.id),l(),L(e.visible?1:2),l(3),O(e.layout.name)}}function Mr(i,o){if(i&1){let e=$();g(0,"div",9),F(1,Cr,5,5,"div",11,U),g(3,"div",12)(4,"div",13)(5,"label",14),K(),g(6,"svg",15),S(7,"path",16),h(),f(8),u(9,"translate"),h(),He(),g(10,"select",17),v("change",function(n){x(e);let r=M(3);return y(r.randomMirrorXSet(n.target.value))}),g(11,"option",18),f(12),u(13,"translate"),h(),g(14,"option",19),f(15),u(16,"translate"),h(),g(17,"option",20),f(18),u(19,"translate"),h()()(),g(20,"div",13)(21,"label",21),K(),g(22,"svg",22),S(23,"path",23),h(),f(24),u(25,"translate"),h(),He(),g(26,"select",24),v("change",function(n){x(e);let r=M(3);return y(r.randomMirrorYSet(n.target.value))}),g(27,"option",18),f(28),u(29,"translate"),h(),g(30,"option",19),f(31),u(32,"translate"),h(),g(33,"option",20),f(34),u(35,"translate"),h()()(),g(36,"div")(37,"button",25),v("click",function(){x(e);let n=M(3);return y(n.generateRandomLayouts())})("keydown.enter",function(){x(e);let n=M(3);return y(n.generateRandomLayouts())}),f(38),u(39,"translate"),h()()()()}if(i&2){let e=M(2).$implicit,t=M();l(),N(e.layouts),l(7),z(" ",_(9,15,"MIRROR_X")," "),l(3),P("selected",t.randomMirrorX==="random"),l(),O(_(13,17,"RANDOM_MIRROR")),l(2),P("selected",t.randomMirrorX==="true"),l(),O(_(16,19,"YES")),l(2),P("selected",t.randomMirrorX==="false"),l(),O(_(19,21,"NO")),l(6),z(" ",_(25,23,"MIRROR_Y")," "),l(3),P("selected",t.randomMirrorY==="random"),l(),O(_(29,25,"RANDOM_MIRROR")),l(2),P("selected",t.randomMirrorY==="true"),l(),O(_(32,27,"YES")),l(2),P("selected",t.randomMirrorY==="false"),l(),O(_(35,29,"NO")),l(4),z(" ",_(39,31,"GENERATE")," ")}}function Pr(i,o){if(i&1&&S(0,"app-layout-preview",27),i&2){let e=M().$implicit;P("svg",e.layout.previewSVG)("alt",e.layout.name)}}function Or(i,o){if(i&1&&S(0,"div",34),i&2){let e=M().$implicit;Q("selected",e.selected)}}function br(i,o){if(i&1){let e=$();g(0,"div",32)(1,"span",35),u(2,"translate"),f(3),u(4,"duration"),h(),g(5,"a",36),u(6,"translate"),v("click",function(n){x(e);let r=M().$implicit,a=M(4);return y(a.clearBestTimeClick(n,r))}),S(7,"i",37),h()()}if(i&2){let e=M().$implicit;l(),P("title",j(_(2,5,"STATS_BEST"))),l(2),O(_(4,7,e.bestTime)),l(2),P("title",j(_(6,9,"BEST_TIME_CLEAR")))}}function vr(i,o){if(i&1){let e=$();g(0,"div",33),u(1,"translate"),g(2,"a",4),v("click",function(n){x(e);let r=M().$implicit,a=M(4);return y(a.removeCustomLayout(n,r))}),S(3,"i",38),h()()}i&2&&P("title",j(_(1,2,"CUSTOM_BOARD_DELETE")))}function xr(i,o){if(i&1){let e=$();g(0,"div",26),v("keydown.enter",function(){let n=x(e).$implicit,r=M(4);return y(r.onStart(n))})("click",function(){let n=x(e).$implicit,r=M(4);return y(r.onStart(n))})("appDeferLoad",function(){let n=x(e).$implicit;return y(n.visible=!0)}),T(1,Pr,1,2,"app-layout-preview",27)(2,Or,1,2,"div",31),T(3,br,8,11,"div",32),g(4,"div",29),f(5),h(),T(6,vr,4,4,"div",33),h()}if(i&2){let e=o.$implicit;Q("selected",e.selected),P("id","item-"+e.layout.id),l(),L(e.visible?1:2),l(2),L(e.bestTime?3:-1),l(2),O(e.layout.name),l(),L(e.layout.custom?6:-1)}}function yr(i,o){if(i&1&&(g(0,"div",10),F(1,xr,7,7,"div",11,U),h()),i&2){let e=M(2).$implicit;l(),N(e.layouts)}}function wr(i,o){if(i&1&&T(0,Mr,40,33,"div",9)(1,yr,3,0,"div",10),i&2){let e=M().$implicit;L(e.isRandom?0:1)}}function kr(i,o){if(i&1&&(g(0,"div",3),T(1,ur,6,6,"div",5),T(2,wr,2,1),h()),i&2){let e=o.$implicit,t=o.$index,n=M();P("id",J("group-",t)),l(),L(n.groups.length>1?1:-1),l(),L(e.expanded?2:-1)}}var wi=(()=>{class i{constructor(){this.layouts=V(),this.startEvent=Oe(),this.scrollHost=me.required("scrollHost"),this.groups=[],this.randomMirrorX="random",this.randomMirrorY="random",this.randomGroup={name:"",layouts:[],expanded:!0,isRandom:!0},this.storage=k(Be),this.translate=k(De),this.layoutService=k(Ce)}ngOnInit(){this.randomMirrorX=this.storage.getLastMirrorX()??"random",this.randomMirrorY=this.storage.getLastMirrorY()??"random",this.buildRandomGroup()}buildRandomGroup(){this.randomGroup.name=this.translate.instant("RANDOM_GROUP");let e=this.translate.instant("RANDOM_LAYOUT");for(let t=0;t<4;t++)this.randomGroup.layouts.push({layout:{id:`${mt}${t}`,name:`${e} ${t+1}`,category:this.randomGroup.name,mapping:[]},visible:!1,selected:!1});this.generateRandomLayouts()}randomMirrorXSet(e){this.randomMirrorX=e,this.storage.setLastMirrorX(e),this.generateRandomLayouts()}randomMirrorYSet(e){this.randomMirrorY=e,this.storage.setLastMirrorY(e),this.generateRandomLayouts()}generateRandomLayout(e){let t=xi(this.randomMirrorX,this.randomMirrorY,"random");e.layout.previewSVG=this.layoutService.generatePreview(t),e.layout.mapping=t}generateRandomLayouts(){for(let e of this.randomGroup.layouts)setTimeout(()=>{this.generateRandomLayout(e)})}ngOnChanges(e){this.refresh()}refresh(){let e=this.layouts();if(e){this.buildGroups();let t=this.storage.getLastPlayed(),n=this.layoutService.selectBoardID;this.layoutService.selectBoardID=void 0,n&&e.some(r=>r.id===n)&&(t=n),t&&setTimeout(()=>{this.select(t)})}}onStart(e){e?.visible&&this.startEvent.emit(e.layout)}buildGroups(){let e=[],t={},n=this.layouts()??this.layoutService.layouts.items;for(let r of n){t[r.category]||(t[r.category]={name:r.category,layouts:[],expanded:!0},e.push(t[r.category]));let a=this.storage.getScore(r.id)||{};t[r.category].layouts.push({layout:r,playCount:a.playCount,bestTime:a.bestTime,visible:!1})}e.push(this.randomGroup),this.groups=e}scrollToElement(e,t){if(!e||!t)return;let n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),a=n.top-r.top+t.scrollTop;t.scrollTo({top:a,behavior:"auto"})}scrollToGroup(e){let t=document.getElementById(`group-${e}`);t&&this.scrollToElement(t,this.scrollHost().nativeElement)}scrollToItem(e){let t=document.getElementById(`item-${e}`);t&&this.scrollToElement(t,this.scrollHost().nativeElement)}select(e){if(e){for(let t of this.groups)for(let n of t.layouts)n.selected=n.layout.id===e;this.scrollToItem(e)}}clearBestTimeClick(e,t){e.stopPropagation(),confirm(this.translate.instant("BEST_TIME_CLEAR_SURE"))&&(this.storage.clearScore(t.layout.id),t.bestTime=void 0,t.playCount=void 0)}removeCustomLayout(e,t){e.stopPropagation(),confirm(this.translate.instant("CUSTOM_BOARD_DELETE_SURE"))&&(this.layoutService.removeCustomLayout([t.layout.id]),this.refresh())}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-layout-list"]],viewQuery:function(t,n){t&1&&Ee(n.scrollHost,pr,5),t&2&&Te()},inputs:{layouts:[1,"layouts"]},outputs:{startEvent:"startEvent"},features:[Se],decls:5,vars:1,consts:[["scrollHost",""],[1,"headline-anchors"],[1,"groups"],[1,"group",3,"id"],[3,"click"],[1,"group-name"],[1,"group-name",3,"click"],[1,"group-expander"],[1,"group-count"],["appDeferLoadScrollHost","",1,"previews","previews-random"],["appDeferLoadScrollHost","",1,"previews"],["tabindex","0",1,"preview",3,"id","selected"],[1,"preview-random"],[1,"random-options"],["for","random-setting-vertical"],["width","20px","height","20px","viewBox","-2 0 20 20"],["id","focus_vertical-[#842]","d","M7,20 L7,0 L9,0 L9,20 Z M0,2 L5,2 L5,4 L2,4 L2,7 L0,7 Z M11,2 L16,2 L16,7 L14,7 L14,4 L11,4 Z M0,18 L0,13 L2,13 L2,16 L5,16 L5,18 Z M16,18 L11,18 L11,16 L14,16 L14,13 L16,13 Z"],["id","random-setting-vertical",3,"change"],["value","random",3,"selected"],["value","true",3,"selected"],["value","false",3,"selected"],["for","random-setting-horizontal"],["width","20px","height","20px","viewBox","0 -2 20 20"],["d","M0,9 L0,7 L20,7 L20,9 Z M2,5 L2,0 L7,0 L7,2 L4,2 L4,5 Z M18,0 L18,5 L16,5 L16,2 L13,2 L13,0 Z M2,16 L2,11 L4,11 L4,14 L7,14 L7,16 Z M18,16 L13,16 L13,14 L16,14 L16,11 L18,11 Z"],["id","random-setting-horizontal",3,"change"],[3,"click","keydown.enter"],["tabindex","0",1,"preview",3,"keydown.enter","click","appDeferLoad","id"],[1,"svg-board",3,"svg","alt"],[1,"preview-placeholder",3,"id","selected"],[1,"preview-name"],[1,"preview-placeholder",3,"id"],[1,"preview-placeholder",3,"selected"],[1,"preview-best-time"],[1,"preview-custom",3,"title"],[1,"preview-placeholder"],[3,"title"],[3,"click","title"],[1,"icon-cancel-squared"],[1,"icon-trash-empty"]],template:function(t,n){t&1&&(T(0,hr,3,0,"div",1),g(1,"div",2,0),F(3,kr,3,4,"div",3,U),h()),t&2&&(L(n.groups.length>1?0:-1),l(3),N(n.groups))},dependencies:[zn,ci,di,Ot,te,yi],styles:['[_nghost-%COMP%]{display:flex;overflow:hidden;flex-direction:column;flex:1;border:1px solid var(--card-layout-color-border);border-radius:4px}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{border-bottom:1px solid var(--card-layout-color-border);width:100%;display:flex;flex-wrap:wrap;padding-top:2px;padding-bottom:2px;color:var(--dialog-text-color);white-space:nowrap}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;flex:1 1 140px;padding:2px 4px;font-size:.9em;cursor:pointer;text-align:center}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--dialog-headline-color);background-color:var(--dialog-background-color-hover)}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{justify-content:center}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]{overflow:hidden auto;width:100%;flex:1}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{border-top:1px solid var(--card-layout-color-border);color:var(--main-content-text-color);padding-top:12px;padding-bottom:12px;height:48px;display:flex;justify-content:space-between;align-items:center;text-align:center;cursor:pointer}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]:hover{color:var(--dialog-headline-color);background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]{margin-left:20px;min-width:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]:after{content:"+";color:var(--main-content-text-color-muted);font-size:1.2em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander.expanded[_ngcontent-%COMP%]:after{content:"-"}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-count[_ngcontent-%COMP%]{font-size:.8em;color:var(--main-content-text-color-muted);margin-right:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]:first-of-type   .group-name[_ngcontent-%COMP%]{border-top:inherit}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{padding:20px 10px 10px;display:flex;flex-direction:column;gap:10px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;align-items:center;flex-direction:row;font-size:.9em;display:flex}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:var(--main-content-text-color)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{width:100%;display:flex;flex-flow:row wrap;justify-content:space-evenly;gap:4px;padding-bottom:12px;box-sizing:border-box}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:8px;width:300px;height:200px;cursor:pointer;border:1px solid var(--card-layout-color-border);background-color:var(--card-layout-color-bg);display:block;position:relative;overflow:clip;box-sizing:border-box}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{display:block;width:100%;height:200px;text-align:center;padding-bottom:1.5em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{position:absolute;right:0;background-color:var(--preview-overlay-background);color:var(--preview-overlay-text);text-shadow:1px 1px var(--preview-overlay-text-shadow);border-bottom-left-radius:3px;padding:3px 3px 3px 6px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;min-width:1.2em;text-align:right;transition:all .1s;margin-top:-1px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{transform:scale(1.3)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{position:absolute;width:100%;height:1.5em;display:block;bottom:0;background-color:var(--card-text-color-bg);color:var(--card-text-color);text-align:center;font-size:.8em;padding:2px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{top:0;display:flex;flex-direction:row;justify-content:center}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]{bottom:0;padding:2px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus{background-color:var(--card-layout-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-name[_ngcontent-%COMP%]{background-color:var(--card-text-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-custom[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]{border:1px solid var(--card-layout-color-border-selected);box-shadow:#00000029 0 3px 6px,#0000003b 0 3px 6px}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:200px;height:190px}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:49%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:96%}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%;height:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-1[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-2[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-3[_ngcontent-%COMP%]{display:none}}@supports (display: grid){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{display:grid;gap:4px;padding-right:4px;padding-bottom:12px;align-content:start;grid-template-columns:repeat(6,1fr);place-items:stretch stretch}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr 2fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:0;width:100%;max-width:none;min-width:0;box-sizing:border-box;height:200px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%;height:200px}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:190px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{height:190px}}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{grid-column:1/-1;flex-direction:row;justify-content:space-around}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-3[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-2[_ngcontent-%COMP%]{display:none}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{height:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:1fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr}}}']})}}return i})();function Sr(i,o){if(i&1&&(g(0,"option",5),f(1),u(2,"translate"),u(3,"translate"),h()),i&2){let e=o.$implicit,t=M();P("value",e.id)("selected",t.buildMode===e.id),l(),Ue("",_(2,4,e.id)," [",_(3,6,e.id+"_DESC"),"]")}}function Er(i,o){if(i&1&&(f(0),u(1,"translate")),i&2){let e=o.$implicit,t=o.$index,n=o.$count;Ue(" ",_(1,2,e.title),"",t!==n-1?", ":""," ")}}function Tr(i,o){if(i&1&&(f(0," ["),F(1,Er,2,4,null,null,U),f(3,"] ")),i&2){let e=M().$implicit;l(),N(e.features)}}function Lr(i,o){if(i&1&&(g(0,"option",5),f(1),u(2,"translate"),T(3,Tr,4,0),h()),i&2){let e=o.$implicit,t=M();P("value",e.id)("selected",t.gameMode()===e.id),l(),z("",_(2,4,e.id)," "),l(2),L(e.features.length>0?3:-1)}}var ki=(()=>{class i{constructor(){this.startEvent=Oe(),this.gameMode=it.required(),this.buildMode=ot,this.buildModes=Bn,this.gameModes=Vn,this.layoutService=k(Ce),this.storage=k(Be)}onStart(e){e&&(this.startEvent.emit({layout:e,buildMode:this.buildMode,gameMode:this.gameMode()}),this.storage.storeLastPlayed(e.id))}randomGame(){let e=Math.floor(Math.random()*this.layoutService.layouts.items.length);this.onStart(this.layoutService.layouts.items[e])}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-choose-layout"]],inputs:{gameMode:[1,"gameMode"]},outputs:{startEvent:"startEvent",gameMode:"gameModeChange"},decls:20,vars:10,consts:[[3,"startEvent","layouts"],[1,"choose-buttons"],[1,"generator"],["for","board-generator-select"],["id","board-generator-select",3,"change"],[3,"value","selected"],[1,"mode"],["for","game-mode-select"],["id","game-mode-select",3,"change"],[1,"start-links"],[3,"click"]],template:function(t,n){t&1&&(g(0,"app-layout-list",0),v("startEvent",function(a){return n.onStart(a)}),h(),g(1,"div",1)(2,"div",2)(3,"label",3),f(4),u(5,"translate"),h(),g(6,"select",4),v("change",function(a){return n.buildMode=a.target.value}),F(7,Sr,4,8,"option",5,U),h()(),g(9,"div",6)(10,"label",7),f(11),u(12,"translate"),h(),g(13,"select",8),v("change",function(a){return n.gameMode.set(a.target.value)}),F(14,Lr,4,6,"option",5,U),h()(),g(16,"div",9)(17,"button",10),v("click",function(){return n.randomGame()}),f(18),u(19,"translate"),h()()()),t&2&&(P("layouts",n.layoutService.layouts.items),l(4),z("",_(5,4,"BOARD_GENERATOR"),":"),l(3),N(n.buildModes),l(4),z("",_(12,6,"GAME_MODE"),":"),l(3),N(n.gameModes),l(4),O(_(19,8,"START_RANDOM")))},dependencies:[wi,te],styles:["[_nghost-%COMP%]{padding:0;margin:0;width:100%;height:100%;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{padding-top:10px;display:flex;flex-flow:row nowrap;align-items:flex-end;gap:8px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{text-align:right;display:inline-block}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:2px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:30%}@media only screen and (max-height:700px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:50%}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{padding-top:4px}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:5px}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:unset}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7em}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:unset}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{display:none}}"]})}}return i})();var St=class{constructor(){this.gestureIndicators=[]}hide(o){let e=o;e&&setTimeout(()=>{e.state="hidden",setTimeout(()=>{this.removeIndicator(o)},250)},500)}removeIndicator(o){for(let e=0;e<this.gestureIndicators.length;e++){let t=this.gestureIndicators[e];if(t.x===o.x&&t.y===o.y){this.gestureIndicators.splice(e,1);break}}}setSize(o,e){this.gestureIndicators[o].size=e,this.gestureIndicators[o].top=this.gestureIndicators[o].y-e/2,this.gestureIndicators[o].left=this.gestureIndicators[o].x-e/2}display(o,e,t){if(o>0&&e>0){let n={x:o,y:e,size:t,top:e-t/2,left:o-t/2,state:"hidden"};return this.gestureIndicators.push(n),setTimeout(()=>{n.state="visible"},100),n}}};var Si=(()=>{class i{transform(e,t){return`${t}${e??""}`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=xe({name:"prefix",type:i,pure:!0})}}return i})();var Ir=(i,o)=>o.source.z+":"+o.source.x+":"+o.source.y;function Dr(i,o){if(i&1&&(K(),g(0,"title"),f(1),u(2,"translate"),h()),i&2){let e=M().$implicit;l(),O(_(2,1,e.url))}}function Br(i,o){if(i&1){let e=$();K(),g(0,"g",9),v("mouseup",function(n){let r=x(e).$implicit,a=M();return y(a.onClickUp(n,r))})("touchend",function(n){let r=x(e).$implicit,a=M();return y(a.onTouchTileEnd(n,r))}),g(1,"g",10),T(2,Dr,3,3,":svg:title"),S(3,"rect",11)(4,"rect",12)(5,"use",13),u(6,"prefix"),S(7,"use",14),h()()}if(i&2){let e=o.$implicit,t=M();Q("selected",e.source.selected)("hidden",e.source.picked)("hinted",e.source.hinted)("wiggle",e.source.effects==null?null:e.source.effects.wiggle),ee("transform",e.pos.translate),l(2),L(e.url?2:-1),l(3),ee("href",Pn(6,15,e.url,t.urlPrefix),null,"xlink")("x",t.imagePos[0])("y",t.imagePos[1])("width",t.imagePos[2])("height",t.imagePos[3])}}function Ar(i,o){if(i&1&&S(0,"div",15),i&2){let e=o.$implicit;nt("top",e.top,"px")("left",e.left,"px")("width",e.size,"px")("height",e.size,"px")("transform",e.transform),Q("visible",e.state==="visible")}}var Ei=1470,Ti=960;function Et(i,o,e){return Math.min(Math.max(o,i),e)}var Li=(()=>{class i{constructor(){this.background=V(),this.theme=V(),this.imageSet=V(),this.kyodaiUrl=V(),this.pattern=V(),this.stones=V(),this.clickEvent=Oe(),this.indicators=new St,this.drawStones=[],this.rotate=!1,this.transformSVG="",this.transformStage="",this.viewport=`0 0 ${Ei} ${Ti}`,this.prefix="",this.urlPrefix="",this.imagePos=[1,1,69,88],this.imageCut=[0,0,65,90],this.scale=1,this.panX=0,this.panY=0,this.bounds=[0,0,Ei,Ti],this.lastPinch=0,this.touchPoints=[],this.initialDistance=0,this.initialScale=1,this.lastTouchX=0,this.lastTouchY=0,this.initialTouchX=0,this.initialTouchY=0,this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.lastMouseX=0,this.lastMouseY=0,this.initialMouseX=0,this.initialMouseY=0,this.isPanning=!1,this.isPinching=!1,this.app=k(ue),this.patternService=k(ri),this.element=k(Pe)}ngOnInit(){this.resize(window)}ngOnChanges(e){if(e.stones&&this.updateStones(e.stones.currentValue),e.background&&this.updateBackground(e.background.currentValue),e.theme||e.pattern){let t=this.background();t&&this.updateBackground(t)}if(e.imageSet){this.prefix=`b_${e.imageSet.currentValue}_`,this.urlPrefix=`#b_${e.imageSet.currentValue}_`;let t=ft(e.imageSet.currentValue);this.imagePos=t?[0,0,75,100]:[6,6,63,88],this.imageCut=t?[1,1,73,98]:[0,0,65,90]}}onWheel(e){e.preventDefault();let n=(e.deltaY<0?1:-1)===1?this.scale+.15:this.scale-.15;this.zoomSVGValue(n,e.clientX,e.clientY);let r=this.indicators.display(e.clientX,e.clientY,n*10);this.indicators.hide(r)}onResize(e){let t=e.target;t&&this.resize(t)}onMouseDown(e){this.scale>1&&(e.preventDefault(),this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,this.initialMouseX=e.clientX,this.initialMouseY=e.clientY)}onMouseMove(e){if(this.scale>1){if(!this.isPanning&&this.initialMouseX!==0&&this.initialMouseY!==0){let t=e.clientX-this.initialMouseX,n=e.clientY-this.initialMouseY;Math.hypot(t,n)>=10&&(this.isPanning=!0)}this.isPanning&&(e.preventDefault(),this.updatePanning(e))}}onMouseUp(e){let t=e.type==="mouseleave";if(this.isPanning)e.preventDefault(),this.updatePanning(e);else if(!t){if(this.scale===1)this.clickEvent.emit(void 0);else if(this.initialMouseX!==0&&this.initialMouseY!==0){let n=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY;Math.hypot(n,r)<4&&this.clickEvent.emit(void 0)}}this.stopPanning()}onTouchTileEnd(e,t){this.hasPinchChanged||this.hasTouchPanMoved||this.clickEvent.emit(t?.source)}onClickUp(e,t){this.initialMouseX=0,this.initialMouseY=0,this.isPanning?(this.updatePanning(e),this.stopPanning()):(this.clickEvent.emit(t?.source),e.stopPropagation())}onTouchStart(e){e.preventDefault(),this.touchPoints=[],this.hasTouchPanMoved=!1,this.hasPinchChanged=!1;let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});if(this.touchPoints.length===1)this.lastTouchX=this.touchPoints[0].x,this.lastTouchY=this.touchPoints[0].y,this.initialTouchX=this.touchPoints[0].x,this.initialTouchY=this.touchPoints[0].y,this.isPanning=!0;else if(this.touchPoints.length===2){this.isPanning=!1,this.isPinching=!0,this.initialDistance=this.getDistance(this.touchPoints[0],this.touchPoints[1]),this.initialScale=this.scale,this.indicators.gestureIndicators=[];let n=(this.touchPoints[0].x+this.touchPoints[1].x)/2,r=(this.touchPoints[0].y+this.touchPoints[1].y)/2;this.indicators.display(n,r,30),this.lastPinch=Date.now()}}onTouchMove(e){e.preventDefault(),this.touchPoints=[];let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});if(this.isPinching&&this.touchPoints.length===2){let r=this.getDistance(this.touchPoints[0],this.touchPoints[1])/this.initialDistance,a=(this.touchPoints[0].x+this.touchPoints[1].x)/2,s=(this.touchPoints[0].y+this.touchPoints[1].y)/2;if(this.indicators.gestureIndicators[0]){let d=this.indicators.gestureIndicators[0];d.x=a,d.y=s,d.top=s-d.size/2,d.left=a-d.size/2}else this.indicators.display(a,s,30);let c=Et(30*r,10,80);this.indicators.setSize(0,c),Math.abs(r-1)>=.1&&(this.hasPinchChanged=!0),this.lastPinch=Date.now()}else if(this.isPanning&&this.touchPoints.length===1&&this.scale>1&&Date.now()-this.lastPinch>600){let n=this.touchPoints[0].x,r=this.touchPoints[0].y,a=n-this.lastTouchX,s=r-this.lastTouchY;if(Math.hypot(n-this.initialTouchX,r-this.initialTouchY)>=10){this.hasTouchPanMoved=!0;let d=this.indicators.display(n,r,10);this.indicators.hide(d)}this.setPanValue(this.panX+a,this.panY+s),this.lastTouchX=n,this.lastTouchY=r}}onTouchEnd(e){if(e.preventDefault(),this.isPinching){let n=this.indicators.gestureIndicators.at(0);n&&this.indicators.hide(n);let r=Array.from(e.touches).map(c=>({x:c.clientX,y:c.clientY,identifier:c.identifier})),a=Array.from(e.changedTouches).map(c=>({x:c.clientX,y:c.clientY,identifier:c.identifier})),s=[];if(r.length>=2?s.push(r[0],r[1]):r.length===1&&a.length>0?s.push(r[0],a[0]):a.length>=2&&s.push(a[0],a[1]),s.length===2){let d=this.getDistance(s[0],s[1])/this.initialDistance,p=this.initialScale;Math.abs(d-1)>=.1&&(p=this.initialScale*d);let m=(s[0].x+s[1].x)/2,C=(s[0].y+s[1].y)/2;this.zoomSVGValue(p,m,C)}this.isPinching=!1,this.lastPinch=Date.now()}else this.isPanning&&(this.updateTransform(),this.isPanning=!1);this.touchPoints=[];let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});this.touchPoints.length===0&&(this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.initialTouchX=0,this.initialTouchY=0)}updatePanning(e){let t=e.clientX-this.lastMouseX,n=e.clientY-this.lastMouseY,r=this.indicators.display(e.clientX,e.clientY,10);this.indicators.hide(r),this.setPanValue(this.panX+t,this.panY+n),this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,this.updateTransform()}stopPanning(){this.isPanning=!1,this.initialMouseX=0,this.initialMouseY=0}setPanValue(e,t){let n=this.element.nativeElement.offsetWidth||0,r=this.element.nativeElement.offsetHeight||0,a=50,s=Math.max(0,(this.scale-1)*n),c=Math.max(0,(this.scale-1)*r),d=-s-a,p=a,m=-c-a,C=a;this.panX=Et(e,d,p),this.panY=Et(t,m,C)}zoomSVGValue(e,t,n){let r=this.scale,a=Et(e,1,2);if(a!==r){if(a<1.01)this.scale=1,this.panX=0,this.panY=0;else{let s=(t-this.panX)/this.scale,c=(n-this.panY)/this.scale,d=t-s*a,p=n-c*a;this.scale=a,this.setPanValue(d,p)}this.updateTransform()}}updateViewPort(){window.requestAnimationFrame(()=>{this.setViewPort()})}updateTransform(){window.requestAnimationFrame(()=>{this.setTransform()})}setTransform(){let e=this.scale>1?` scale(${this.scale})`:"";if(this.transformSVG=`translate(${this.panX}px, ${this.panY}px)${e}`,this.rotate){let[t,n,r,a]=Ut(this.bounds),s=t+r/2,c=n+a/2;this.transformStage=`rotate(90 ${s} ${c})`}else this.transformStage=""}getDistance(e,t){let n=t.x-e.x,r=t.y-e.y;return Math.hypot(n,r)}resize(e){let t=e.innerHeight>e.innerWidth;this.panX=0,this.panY=0,this.scale=1,this.updateTransform(),t!==this.rotate&&(this.rotate=t),this.updateViewPort()}setViewPort(){let[e,t,n,r]=Ut(this.bounds);if(this.rotate){let a=e+n/2,s=t+r/2,c=r,d=n;e=a-c/2,t=s-d/2,n=c,r=d}this.viewport=`${e} ${t} ${n} ${r}`}updateStones(e){if(!e)return;this.scale=1,this.panX=0,this.panY=0;let t=e.filter(n=>n!==void 0).map(n=>({z:n.z,x:n.x,y:n.y,v:n.v,visible:!0,url:n.img?.id,pos:Gn(n.z,n.x,n.y),source:n,className:n.effects?.wiggle?"wiggle":void 0}));this.bounds=Un(t),this.drawStones=Hn(t),this.setViewPort(),this.setTransform()}cssBarColors(){return(ze.find(t=>t.id===this.app.settings.theme)??ze[0]).colors}updateMahBackground(e){this.backgroundUrl="",e&&this.patternService.svgDataUrl(e,this.cssBarColors()).then(t=>this.backgroundUrl=t).catch(console.error)}updateBackground(e){let t=at.find(n=>n.img===e);if(!t){this.backgroundUrl=void 0;return}if(this.backgroundRepeat=!!t.repeat,t.type==="MAH"){this.updateMahBackground(this.pattern());return}this.backgroundUrl=`url("assets/img/${t.img}.${t.type??"jpg"}")`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-board"]],hostVars:4,hostBindings:function(t,n){t&1&&v("wheel",function(a){return n.onWheel(a)})("resize",function(a){return n.onResize(a)},_n)("mousedown",function(a){return n.onMouseDown(a)})("mousemove",function(a){return n.onMouseMove(a)})("mouseup",function(a){return n.onMouseUp(a)})("mouseleave",function(a){return n.onMouseUp(a)})("touchstart",function(a){return n.onTouchStart(a)})("touchmove",function(a){return n.onTouchMove(a)})("touchend",function(a){return n.onTouchEnd(a)})("touchcancel",function(a){return n.onTouchEnd(a)}),t&2&&(nt("background-image",n.backgroundUrl),Q("background-repeat",n.backgroundRepeat))},inputs:{background:[1,"background"],theme:[1,"theme"],imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],pattern:[1,"pattern"],stones:[1,"stones"]},outputs:{clickEvent:"clickEvent"},features:[Se],decls:14,vars:18,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid meet",1,"board-svg",3,"mouseup"],["id","front","width","300","height","400","viewBox","0 0 300 400"],["transform","translate(28,-614)","d","M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z",2,"fill","#ffffff","fill-opacity","0.3","fill-rule","evenodd","stroke","none","filter","blur(10px)"],["id","mah-image-clip"],["rx","10","ry","10","fill","#fff"],["app-image-set-loader","",3,"imageSet","kyodaiUrl","dark","prefix"],[1,"stage"],[1,"draw",3,"selected","hidden","hinted","wiggle"],[1,"gesture-indicator",3,"top","left","width","height","transform","visible"],[1,"draw",3,"mouseup","touchend"],[1,"tile"],["x","3","y","3","width","75","height","100","rx","10","ry","10",1,"shadow"],["x","0","y","0","width","75","height","100","rx","10","ry","10",1,"stone"],["clip-path","url(#mah-image-clip)"],[0,"xlink","href","#front","x","0","y","0","width","75","height","100",1,"front"],[1,"gesture-indicator"]],template:function(t,n){t&1&&(K(),g(0,"svg",0),v("mouseup",function(a){return n.onMouseUp(a)}),g(1,"defs")(2,"svg",1),S(3,"path",2),h(),g(4,"clipPath",3),S(5,"rect",4),h()(),g(6,"style"),f(7," g.tile { transform-origin: 50px 32.5px; opacity: 1; transition: transform 120ms ease-in-out; } @keyframes mah-wiggle { 0% { transform: rotate(0deg); } 20% { transform: rotate(-3deg); } 40% { transform: rotate(3deg); } 60% { transform: rotate(-1deg); } 80% { transform: rotate(1deg); } 100% { transform: rotate(0deg); } } g.wiggle g.tile { animation: mah-wiggle 250ms ease-in-out; } g.hinted g.tile { transform: scale(1.12); } g.hinted g.tile > rect { stroke: #9f0000; stroke-width: 3px; } @keyframes mah-select-pop { 0% { transform: scale(1); } 60% { transform: scale(1.08); } 100% { transform: scale(1.04); } } g.selected g.tile { transform: scale(1.04); animation: mah-select-pop 140ms ease-out; } g.selected g.tile rect.stone { stroke: black; fill: #F8EABB; } g.selected.hinted g.tile { transform: scale(1.14); animation: none; } g.selected.hinted g.tile rect.stone { stroke: #9f0000; stroke-width: 3px; } g.draw rect.shadow { fill: #191919; opacity: 0.6; stroke-width: 1; stroke: black; } g.draw rect.stone { fill: #FFF9E5; stroke-width: 1; stroke: black; } g.hidden { opacity: 0; } g.stage.contrast g.draw rect.stone { stroke-width: 2; } g.stage.contrast g.draw rect.shadow { opacity: 0.7; } g.stage.dark g.draw rect.shadow { opacity: 0.6; stroke-width: 1; fill: #9d948c; stroke: green; } g.stage.dark g.draw rect.stone { fill: #000; stroke-width: 1; stroke: #9d948c; } g.stage.dark g.selected g.tile rect.stone { stroke: #F8EABB; fill: black; } g.stage.dark g.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark g.selected.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark.contrast g.draw rect.stone { stroke-width: 2; } g.stage.dark.contrast g.draw rect.shadow { opacity: 0.7; } g.stage.dark .front { display: none; } g.stage.dark .front { display: unset; } @media (prefers-reduced-motion: reduce) { g.tile { transition: none; } g.wiggle g.tile { animation: none; } g.selected g.tile { animation: none; } } "),h(),S(8,"defs",5),g(9,"g",6),F(10,Br,8,18,":svg:g",7,Ir),h()(),F(12,Ar,1,12,"div",8,U)),t&2&&(nt("transform",n.transformSVG),Q("rotate",n.rotate),ee("viewBox",n.viewport),l(5),ee("x",n.imageCut[0])("y",n.imageCut[1])("width",n.imageCut[2])("height",n.imageCut[3]),l(3),P("imageSet",n.imageSet())("kyodaiUrl",n.kyodaiUrl())("dark",n.app.settings.dark)("prefix",n.prefix),l(),Q("dark",n.app.settings.dark)("contrast",n.app.settings.contrast),ee("transform",n.transformStage),l(),N(n.drawStones),l(2),N(n.indicators.gestureIndicators))},dependencies:[Mt,Si,te],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;background-repeat:repeat;background-size:cover}.background-repeat[_nghost-%COMP%]{background-size:unset}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;transform-origin:0 0 0;transform:translate(0) scale(1);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .gesture-indicator[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;position:fixed;top:0;left:0;height:50px;width:50px;display:block;border-radius:50%;text-align:center;line-height:45px;z-index:10;background-color:var(--gesture-indicator);transform:scale(0);transition:transform .15s ease-in-out}[_nghost-%COMP%]   .gesture-indicator.visible[_ngcontent-%COMP%]{transform:scale(1.5)}"]})}}return i})();var Ii=(()=>{class i{transform(e){return e===Ne}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=xe({name:"gameModeEasy",type:i,pure:!0})}}return i})(),Di=(()=>{class i{transform(e){return e===Ne||e===An}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=xe({name:"gameModeStandard",type:i,pure:!0})}}return i})();var Vr=["info"],Rr=["settings"],Fr=["help"],Nr=["newgame"];function $r(i,o){if(i&1){let e=$();g(0,"button",23),u(1,"translate"),v("click",function(){x(e);let n=M();return y(n.enterFullScreen())}),S(2,"i",38),h()}i&2&&P("title",j(_(1,2,"FULLSCREEN")))}function jr(i,o){i&1&&S(0,"app-help")}function Gr(i,o){i&1&&S(0,"app-tiles-info")}function Hr(i,o){i&1&&S(0,"app-settings")}function Ur(i,o){if(i&1){let e=$();g(0,"app-choose-layout",39),v("startEvent",function(n){x(e);let r=M();return y(r.startGame(n))}),h()}if(i&2){let e=M();P("gameMode",e.game.mode)}}function zr(i,o){if(i&1&&(g(0,"div"),f(1),u(2,"translate"),h()),i&2){let e=M(2);l(),O(_(2,1,e.game.message.messageID))}}function Yr(i,o){if(i&1&&(g(0,"div"),f(1),u(2,"duration"),h()),i&2){let e=M(2);l(),O(_(2,1,e.game.message.playTime))}}function Kr(i,o){if(i&1){let e=$();g(0,"div",41)(1,"button",42),v("click",function(n){x(e);let r=M(2);return y(r.onShuffleContinue(n))}),S(2,"i",13),g(3,"span",11),f(4),u(5,"translate"),h()(),g(6,"button",43),v("click",function(n){x(e);let r=M(2);return y(r.onSurrenderGame(n))}),S(7,"i",16),g(8,"span",11),f(9),u(10,"translate"),h()()()}i&2&&(l(4),O(_(5,2,"SHUFFLE")),l(5),O(_(10,4,"RESTART")))}function qr(i,o){if(i&1){let e=$();g(0,"div",40),v("click",function(){x(e);let n=M();return y(n.clickMessage())}),T(1,zr,3,3,"div"),T(2,Yr,3,3,"div"),T(3,Kr,11,6,"div",41),h()}if(i&2){let e=M();l(),L(e.game.message.messageID?1:-1),l(),L(e.game.message.playTime?2:-1),l(),L(e.game.message.askShuffle?3:-1)}}var Bi=(()=>{class i{constructor(){this.info=me.required("info"),this.settings=me.required("settings"),this.help=me.required("help"),this.newgame=me.required("newgame"),this.app=k(ue),this.fullScreenEnabled=!0,this.title="",this.workerService=k(ct),this.game=this.app.game,this.fullScreenEnabled=this.canFullscreen(),this.title=`${this.app.name} v${ne.version}`}showNewGame(){this.newgame().visible.set(!0)}handleKeyDownEventKey(e){switch(e){case"h":{this.help().toggle();break}case"i":{this.info().toggle();break}case"s":{this.settings().toggle();break}case"t":{this.game.hint();break}case"m":{this.game.shuffle();break}case"g":{this.debugSolve();break}case"u":{this.game.back();break}case"n":{this.game.pause(),this.newgame().toggle();break}case" ":case"space":case"Space":case"spacebar":case"Spacebar":case"p":{this.game.isRunning()?this.game.pause():this.game.isPaused()&&this.game.resume();break}default:return!1}return!0}handleKeyDownDialogExit(){let e=this.help();if(e.visible())return e.toggle(),!0;let t=this.newgame();if(t.visible())return t.toggle(),!0;let n=this.info();if(n.visible())return n.toggle(),!0;let r=this.settings();return r.visible()?(r.toggle(),!0):!1}handleKeyDownEvent(e){e.key==="Escape"&&this.handleKeyDownDialogExit()||(e.target?.nodeName??"").toLocaleLowerCase()==="input"||this.handleKeyDownEventKey(e.key)&&e.preventDefault()}stoneClick(e){this.game.click(e)}isFullscreenEnabled(){let e=window.document;if(typeof e.fullscreenEnabled=="boolean")return e.fullscreenEnabled;let t=document.documentElement;return!!(t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen)}canFullscreen(){return ne.mobile?!1:this.isFullscreenEnabled()}isFullscreen(){let e=window.document;return!!(e.fullscreenElement||e.webkitIsFullScreen||e.mozFullScreen)}exitFullscreen(){let e=window.document;e.exitFullscreen?e.exitFullscreen().catch(t=>{console.error(t)}):e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()}requestFullscreen(){let e=document.body;e.requestFullscreen?e.requestFullscreen().catch(t=>{console.error(t)}):e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}enterFullScreen(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()}newGame(){this.game.pause(),this.showNewGame()}startGame(e){this.newgame().visible.set(!1),this.game.reset(),this.game.start(e.layout,e.buildMode,e.gameMode)}toggleDialogState(e){e?this.app.game.isPaused()||this.app.game.pause():(this.app.settings.save(),this.app.game.isPaused()&&this.app.game.resume())}clickMessage(){if(this.game.isPaused()){if(this.game.message?.askShuffle)return;this.game.resume()}else this.game.reset(),this.showNewGame()}onShuffleContinue(e){e.stopPropagation(),this.game.gameOverEasyModeShuffle()}onSurrenderGame(e){e.stopPropagation(),this.game.surrender(),this.showNewGame()}debugSolve(){if(ne.production)return;let e=(t,n)=>{let r=n[t],a=n[t+1];if(!r||!a)return;let s=this.game.board.stones.filter(c=>c.z===r[0]&&c.x===r[1]&&c.y===r[2]||c.z===a[0]&&c.x===a[1]&&c.y===a[2]);if(s.length>1){for(let c of s)c.selected=!0;setTimeout(()=>{this.game.board.pick(s[0],s[1]),e(t+2,n)},300)}};this.workerService.solveGame(this.game.board.stones.filter(t=>!t.picked).map(t=>t.toPosition()),t=>{e(0,t.order)})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-game-component"]],viewQuery:function(t,n){t&1&&Ee(n.info,Vr,5)(n.settings,Rr,5)(n.help,Fr,5)(n.newgame,Nr,5),t&2&&Te(4)},hostBindings:function(t,n){t&1&&v("keydown",function(a){return n.handleKeyDownEvent(a)},Je)},decls:90,vars:102,consts:[["help",""],["info",""],["settings",""],["newgame",""],[1,"controls","controls-top"],[1,"ctrl","ctrl-name"],[1,"button",3,"click","title"],[1,"icon-logo"],[1,"name"],[1,"ctrl","ctrl-game"],[1,"icon-pause"],[1,"label"],[1,"button","feature",3,"click","title"],[1,"icon-spin1"],[1,"icon-undo"],[1,"icon-lightbulb"],[1,"icon-loop"],[1,"board",3,"clickEvent","stones","theme","imageSet","kyodaiUrl","background","pattern"],[1,"controls","controls-bottom"],[1,"ctrl","ctrl-stats"],["title","Menu","aria-haspopup","true",1,"button","menu-button"],[1,"icon-menu"],["role","menu",1,"menu"],["role","menuitem",1,"button",3,"click","title"],[1,"icon-cog"],[1,"icon-volume-low"],[1,"icon-calendar"],["role","menuitem",1,"button",3,"title"],[1,"ctrl","ctrl-time"],[1,"label","text"],[1,"time"],["className","overlay-help",3,"clickEvent","title"],["className","overlay-info",3,"clickEvent","title"],["className","overlay-settings",3,"clickEvent","title"],["className","overlay-newgame",3,"clickEvent","title"],[1,"choose",3,"gameMode"],["className","overlay-message",3,"clickEvent","visible","noCloseButton"],[1,"overlay-message-message"],[1,"icon-resize-full-alt"],[1,"choose",3,"startEvent","gameMode"],[1,"overlay-message-message",3,"click"],[1,"overlay-message-actions"],[1,"button","feature",3,"click"],[1,"button",3,"click"]],template:function(t,n){if(t&1){let r=$();g(0,"div",4)(1,"div",5)(2,"button",6),u(3,"translate"),v("click",function(){x(r);let s=Le(74);return y(s.toggle())}),S(4,"i",7),g(5,"span",8),f(6),h()()(),g(7,"div",9)(8,"button",6),u(9,"translate"),v("click",function(){return x(r),y(n.game.toggle())}),S(10,"i",10),g(11,"span",11),f(12),u(13,"translate"),h()(),g(14,"button",12),u(15,"gameModeEasy"),u(16,"translate"),v("click",function(){return x(r),y(n.game.shuffle())}),S(17,"i",13),g(18,"span",11),f(19),u(20,"translate"),h()(),g(21,"button",12),u(22,"gameModeStandard"),u(23,"translate"),v("click",function(){return x(r),y(n.game.back())}),S(24,"i",14),g(25,"span",11),f(26),u(27,"translate"),h()(),g(28,"button",12),u(29,"gameModeStandard"),u(30,"translate"),v("click",function(){return x(r),y(n.game.hint())}),S(31,"i",15),g(32,"span",11),f(33),u(34,"translate"),h()(),g(35,"button",6),u(36,"translate"),v("click",function(){return x(r),y(n.newGame())}),S(37,"i",16),g(38,"span",11),f(39),u(40,"translate"),h()()()(),g(41,"app-board",17),v("clickEvent",function(s){return x(r),y(n.stoneClick(s))}),h(),g(42,"div",18)(43,"div",19)(44,"button",20),S(45,"i",21),h(),g(46,"div",22)(47,"button",23),u(48,"translate"),v("click",function(){x(r);let s=Le(81);return y(s.toggle())}),S(49,"i",24),h(),g(50,"button",23),u(51,"translate"),v("click",function(){return x(r),y(n.app.toggleSound())}),S(52,"i",25),h(),g(53,"button",23),u(54,"translate"),v("click",function(){x(r);let s=Le(77);return y(s.toggle())}),S(55,"i",26),h(),T(56,$r,3,4,"button",27),h()(),g(57,"div",28)(58,"span",29)(59,"small"),f(60),u(61,"translate"),h(),g(62,"span"),f(63),h()(),g(64,"span",29)(65,"small"),f(66),u(67,"translate"),h(),g(68,"span"),f(69),h()(),g(70,"span",30),f(71),u(72,"duration"),h()()(),g(73,"app-dialog",31,0),v("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(75,jr,1,0,"app-help"),h(),g(76,"app-dialog",32,1),u(78,"translate"),v("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(79,Gr,1,0,"app-tiles-info"),h(),g(80,"app-dialog",33,2),u(82,"translate"),v("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(83,Hr,1,0,"app-settings"),h(),g(84,"app-dialog",34,3),u(86,"translate"),v("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(87,Ur,1,1,"app-choose-layout",35),h(),g(88,"app-dialog",36),v("clickEvent",function(){return x(r),y(n.clickMessage())}),T(89,qr,4,3,"div",37),h()}if(t&2){let r=Le(74),a=Le(77),s=Le(81),c=Le(85);l(2),P("title",j(_(3,56,"OPEN_HELP"))),l(4),O(n.app.name),l(2),P("title",j(_(9,58,"PAUSE_LONG"))),l(4),O(_(13,60,"PAUSE")),l(2),Q("enabled",_(15,62,n.game.mode)),P("title",j(_(16,64,"SHUFFLE_LONG"))),l(5),O(_(20,66,"SHUFFLE")),l(2),Q("enabled",_(22,68,n.game.mode)),P("title",j(_(23,70,"UNDO_LONG"))),ee("disabled",n.game.board.undo.length===0?!0:null),l(5),O(_(27,72,"UNDO")),l(2),Q("enabled",_(29,74,n.game.mode)),P("title",j(_(30,76,"HINT_LONG"))),l(5),O(_(34,78,"HINT")),l(2),P("title",j(_(36,80,"RESTART_LONG"))),l(4),O(_(40,82,"RESTART")),l(2),P("stones",n.game.board.stones)("theme",n.app.settings.theme)("imageSet",n.app.settings.tileset)("kyodaiUrl",n.app.settings.kyodaiUrl)("background",n.app.settings.background)("pattern",n.app.settings.pattern),l(6),P("title",j(_(48,84,"OPEN_SETTINGS"))),l(3),Q("inactive",!n.app.settings.sounds),P("title",j(_(51,86,"AUDIO_SOUNDS"))),l(3),P("title",j(_(54,88,"TILES_INFO"))),l(3),L(n.fullScreenEnabled?56:-1),l(4),z("",_(61,90,"STONES"),":"),l(3),O(n.game.board.count),l(3),z("",_(67,92,"FREE"),":"),l(3),O(n.game.board.free.length),l(2),O(_(72,94,n.game.clock.elapsed)),l(2),P("title",n.title),l(2),L(r.visible()?75:-1),l(),P("title",_(78,96,"TILES")),l(3),L(a.visible()?79:-1),l(),P("title",_(82,98,"SETTINGS")),l(3),L(s.visible()?83:-1),l(),P("title",_(86,100,"SELECT_BOARD")),l(3),L(c.visible()?87:-1),l(),P("visible",!!n.game.message)("noCloseButton",!0),l(),L(n.game.message?89:-1)}},dependencies:[Li,Wn,ii,li,ki,Xn,Ot,Di,Ii,te],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column nowrap;width:100%;height:100%;background-color:var(--main-bg-color)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{min-width:170px;display:flex;justify-content:space-between;padding-left:12px;padding-right:12px}@media only screen and (min-width:3000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:4em}}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.6em}}@media only screen and (max-width:1900px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.3em}}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.2em}}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{color:var(--main-text-color);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{padding:.3em .9em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{text-decoration:none;font-weight:500;color:var(--main-text-color);padding:.3em .9em;border-radius:10px;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease,transform .05s ease}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] + .label[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--main-text-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[disabled][_ngcontent-%COMP%]{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;border-radius:10px;font-family:Kulim Park,Tahoma,sans-serif;color:var(--main-text-color);padding:.3em .9em;cursor:pointer;border:1px solid transparent;background-clip:padding-box;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease,transform .05s ease;background-color:transparent;font-size:inherit}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-image:linear-gradient(to bottom,color-mix(in oklab,var(--main-bg-color-lt) 35%,transparent),color-mix(in oklab,var(--main-bg-color) 90%,transparent));border:1px solid color-mix(in oklab,var(--main-bg-color-lt) 70%,transparent);background-color:color-mix(in oklab,var(--main-bg-color) 78%,transparent);color:var(--main-text-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:inset 0 1px 1px #00000026,0 0 #0000}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:focus-visible{outline:none;box-shadow:0 0 0 2px var(--main-bg-color),0 0 0 4px var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[disabled][_ngcontent-%COMP%]{opacity:.55;cursor:not-allowed;pointer-events:none;filter:saturate(.75)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature.enabled[_ngcontent-%COMP%]{display:unset}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]{font-weight:600;cursor:pointer}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]   .icon-logo[_ngcontent-%COMP%]{color:red}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]:hover{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]{cursor:default;gap:24px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-variant-numeric:lining-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-family:Kulim Park,Tahoma,sans-serif;min-width:98px;display:inline-block;text-align:center;font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:none;width:2.2em;height:2.2em;padding:0;border-radius:999px;justify-content:center;align-items:center}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.05em}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{border-bottom:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{border-top:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .board[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1;overflow:hidden}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1.2em;padding:.3em}[_nghost-%COMP%]   .time[_ngcontent-%COMP%]{padding:.3em}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1.1em}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{min-width:unset}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1em}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:.9em}}@media only screen and (max-width:350px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   span.name[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:280px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{gap:2px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:none;position:absolute;bottom:100%;right:0;background:var(--dialog-background-color);border:1px solid var(--dialog-border-color);border-radius:8px;flex-direction:column;z-index:10;gap:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{padding:0;margin-left:0;width:2.2em;height:2.2em;border-radius:8px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.05em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:hover   .menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:focus-within   .menu[_ngcontent-%COMP%]{display:flex}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]{flex-direction:row;position:relative;padding-left:calc(52px + env(safe-area-inset-left));padding-right:calc(52px + env(safe-area-inset-right))}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl-name[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl-name[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{flex-direction:column;min-width:unset;max-width:52px;height:calc(100% - env(safe-area-inset-top) - env(safe-area-inset-bottom));position:absolute;left:env(safe-area-inset-left);border-bottom:unset}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{flex-direction:column;min-width:98px;max-width:98px;height:calc(100% - env(safe-area-inset-top) - env(safe-area-inset-bottom));position:absolute;right:env(safe-area-inset-right);align-items:flex-end;border-top:unset}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{align-items:flex-end}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{padding-right:.3em;min-width:unset}}@media only screen and (width>=400px)and (height<=260px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{padding:.1em}}"]})}}return i})();var Xr=["gameComponent"],Wr=["editorPlaceholder"];function Zr(i,o){if(i&1&&S(0,"app-game-component",3,1),i&2){let e=M();fe("theme-"+e.app.settings.theme),P("hidden",e.loading)}}function Qr(i,o){}var Ai=(()=>{class i{constructor(){this.gameComponent=me.required("gameComponent"),this.editorPlaceholder=me.required("editorPlaceholder",{read:Vt}),this.app=k(ue),this.loading=!0,this.editorVisible=!1,this.layoutService=k(Ce),this.meta=k(En),this.updateName(),this.registerWindowListeners()}ngOnInit(){this.init().catch(e=>{console.error(e)})}handleKeyDownEvent(e){(e.target?.nodeName??"").toLocaleLowerCase()!=="input"&&ne.editor&&e.key==="e"&&(this.toggleEditor(),e.preventDefault())}loadEditor(){ne.editor&&import("./chunk-SOM22CEX.js").then(({EditorComponent:e})=>{let t=this.editorPlaceholder().createComponent(e);this.editorSubscription=t.instance.closeEvent.subscribe(()=>{this.toggleEditor()})}).catch(e=>{console.error(e)})}toggleEditor(){ne.editor&&(this.editorVisible=!this.editorVisible,this.editorVisible?(this.app.game.pause(),this.loadEditor()):(this.editorSubscription&&(this.editorSubscription.unsubscribe(),this.editorSubscription=void 0),this.editorPlaceholder().clear()))}init(){return pe(this,null,function*(){yield this.layoutService.get(),this.loading=!1;let e=new URLSearchParams(window.location.search),t=yield this.checkImport(e.get("mah"));this.layoutService.selectBoardID=t[0]||e.get("board"),window.location.search&&this.clearSearchParameters(),(this.app.game.isIdle()||this.layoutService.selectBoardID)&&this.gameComponent().showNewGame()})}clearSearchParameters(){try{window.history.replaceState(null,"",window.location.pathname)}catch(e){console.error(e)}}checkImport(e){return pe(this,null,function*(){if(!e)return[];try{let t=[],n=JSON.parse(atob(e)),r=[];for(let a of n.boards){let s=this.layoutService.expandLayout(a,!0);t.push(s.id),!this.layoutService.layouts.items.some(c=>c.id===s.id)&&!r.some(c=>c.id===s.id)&&r.push(Ce.layout2loadLayout(s,a.map))}return r.length>0&&this.layoutService.storeCustomBoards(r),t}catch(t){return console.error(t),[]}})}registerWindowListeners(){window.addEventListener("beforeunload",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1),window.addEventListener("blur",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1)}updateName(){let e=this.meta.getTag("name=application-name");this.app.name=e?e.content:this.app.name}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=H({type:i,selectors:[["app-root"]],viewQuery:function(t,n){t&1&&Ee(n.gameComponent,Xr,5)(n.editorPlaceholder,Wr,5,Vt),t&2&&Te(2)},hostBindings:function(t,n){t&1&&v("keydown",function(a){return n.handleKeyDownEvent(a)},Je)},decls:3,vars:1,consts:[["editorPlaceholder",""],["gameComponent",""],[3,"hidden","class"],[3,"hidden"]],template:function(t,n){t&1&&(T(0,Zr,2,3,"app-game-component",2),fn(1,Qr,0,0,"ng-template",null,0,On)),t&2&&L(n.editorVisible?-1:0)},dependencies:[Bi],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}"]})}}return i})();var Zt=new gn("TRANSLATE_HTTP_LOADER_CONFIG"),Jr=(()=>{class i{http;config;constructor(){this.config=sn({prefix:"/assets/i18n/",suffix:".json",enforceLoading:!1,useHttpBackend:!1},k(Zt)),this.http=this.config.useHttpBackend?new Ie(k(Rt)):k(Ie)}getTranslation(e){let t=this.config.enforceLoading?`?enforceLoading=${Date.now()}`:"";return this.http.get(`${this.config.prefix}${e}${this.config.suffix}${t}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Me({token:i,factory:i.\u0275fac})}return i})();function Vi(i={}){let o=i.useHttpBackend??!1;return[{provide:Zt,useValue:i},{provide:Tn,useClass:Jr,deps:[o?Rt:Ie,Zt]}]}ne.production&&void 0;yn(Ai,{providers:[bn(),hn(wn,vn,...ne.modules),Ln({loader:Vi({prefix:"./assets/i18n/",suffix:".json"}),fallbackLang:"en"}),ue,Ce,ct,Ge,Ct,kn(Sn())]}).catch(console.error);
