import{A as Zn,b as Sn,c as En,d as Tn,e as Ln,f as jt,g as Ie,h as In,i as Bn,j as Dn,k as An,l as Be,m as Z,n as Rn,o as De,p as Kt,t as Yn,u as qn,v as Yt,x as Xn,y as Pe,z as Wn}from"./chunk-46TAORT7.js";import{$a as xn,Aa as it,B as un,Ba as ye,Bb as Vn,Ca as bn,Cb as Fn,D as k,Db as lt,Eb as Nn,F as _n,Fb as Ne,Ga as Re,Ha as ne,Hb as pe,Ia as T,Ib as je,J as x,Ja as L,Jb as jn,K as y,Kb as Gt,L as Y,La as U,Lb as Gn,M as Ke,Ma as N,Mb as $t,N as fn,Na as j,Nb as qe,Oa as O,Ob as $n,P as Vt,Pa as p,Pb as ct,Q as Cn,Qa as m,Qb as Hn,Ra as S,Rb as dt,S as Ft,Sa as B,Sb as Ve,Ta as D,Tb as Ht,U as Ee,Ua as de,Ub as Un,Va as A,Vb as Ut,W as be,Wa as ot,Wb as zt,Xa as b,Xb as zn,Ya as ge,Yb as Ge,Za as C,Zb as Kn,_ as Mn,_a as vn,a as dn,ab as Te,b as ce,bb as Le,cb as ve,d as pn,db as rt,eb as ee,fb as Me,gb as f,hb as M,ib as K,jb as Ye,kb as G,la as Pn,lb as te,m as gn,ma as tt,na as On,nb as yn,oa as nt,ob as h,p as mn,pb as u,qa as l,qb as at,rb as wn,sb as me,tb as R,ub as _e,vb as st,w as hn,wb as kn,xa as Nt,ya as $,z as Oe}from"./chunk-XEHCUY67.js";var $e={APP_VERSION:"1.17.0",APP_NAME:"Mah",APP_FEATURE_EDITOR:!0,APP_FEATURE_KYODAI:!0,APP_FEATURE_MOBILE:!1};var Q={production:!0,version:$e.APP_VERSION,name:$e.APP_NAME,mobile:$e.APP_FEATURE_MOBILE,editor:$e.APP_FEATURE_EDITOR,kyodai:$e.APP_FEATURE_KYODAI,modules:[],openExternal:void 0,onWindowBlur:void 0};var He=class{constructor(){this.free=[],this.stones=[],this.count=0,this.hints={groups:[],current:void 0},this.selected=void 0,this.undo=[]}clearSelection(){this.selected&&(this.selected.selected=!1),this.selected=void 0}setStoneSelected(o){this.clearSelection(),o&&(o.selected=!0,this.selected=o)}clearHints(){if(this.hints.current)for(let o of this.hints.current.stones)o.hinted=!1;this.hints={groups:[],current:void 0}}hint(){if(this.hintNext()||(this.clearHints(),this.free.length===0))return;let o=this.collectHints();if(this.selected){let t=this.selected.groupNr;o.sort((n,r)=>n.group===t?-1:r.group===t?1:0)}let e=o[0];this.hints={groups:o,current:e};for(let t of e.stones)t.hinted=!0}reset(){this.clearSelection(),this.clearHints(),this.free=[],this.count=0,this.stones=[],this.undo=[]}canRemove(o){return o.group.some(e=>!e.picked&&!e.isBlocked())}update(){let o=[],e=0;for(let t of this.stones)t.state={blocked:!t.picked&&t.isBlocked(),removable:!1},e+=t.picked?0:1;for(let t of this.stones)t.state.removable=!t.picked&&!t.state.blocked&&this.canRemove(t),t.state.removable&&o.push(t);this.free=o,this.count=e}back(){if(this.undo.length<2)return;this.clearSelection(),this.clearHints();let o=this.undo.pop(),e=this.undo.pop();if(!(!o||!e)){for(let t of this.stones)(t.z===o[0]&&t.x===o[1]&&t.y===o[2]||t.z===e[0]&&t.x===e[1]&&t.y===e[2])&&(t.picked=!1);this.update()}}shuffle(){this.clearSelection(),this.clearHints();let o=this.stones.filter(c=>c.picked),e=this.stones.filter(c=>!c.picked),t=new Kn(e),n=e.map(c=>[c.z,c.x,c.y]),a=new Ne(t).build(lt,n);if(!a)return;let s=[...a,...o];Fn.fillStones(s,new Ge(this.stones.length)),this.stones=s,this.update()}load(o,e){if(!o)return;this.undo=e;let n=new Ne(new Ge(o.length+e.length)).load(o);if(n){for(let r of e){let a=Vn(n,r[0],r[1],r[2]);a&&(a.picked=!0)}this.stones=n,this.update()}}save(){return this.stones.map(o=>[o.z,o.x,o.y,o.v])}applyMapping(o,e){let t=new Ne(new Ge(o.length));this.stones=t.build(e,o)||[]}pick(o,e){this.clearSelection(),this.undo.push([o.z,o.x,o.y],[e.z,e.x,e.y]),this.clearHints(),o.picked=!0,e.picked=!0,this.update()}countUnblocked(){return this.stones.filter(o=>!o.picked&&!o.isBlocked()).length}hintNext(){if(!this.hints.current)return!1;for(let e of this.hints.current.stones)e.hinted=!1;let o=this.hints.groups.indexOf(this.hints.current);if(o>=0&&(o++,o>=this.hints.groups.length&&(o=0),o<this.hints.groups.length)){this.hints.current=this.hints.groups[o];for(let e of this.hints.current.stones)e.hinted=!0;return!0}return!1}collectHints(){let o={};for(let e of this.free){let t=e.groupNr.toString();o[t]=o[t]||[],o[t].push(e)}return Object.keys(o).map(e=>({group:o[e][0].groupNr,stones:o[e]}))}};var pt=class{constructor(){this.elapsed=0,this.lastTime=0,this.timer=void 0}start(){this.timer||(this.elapsed=this.elapsed||0)}reset(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0),this.lastTime=0,this.elapsed=0}run(){this.timer||(this.lastTime=Date.now(),this.timer=window.setTimeout(()=>{this.step()},1e3))}pause(){this.timer&&(window.clearTimeout(this.timer),this.timer=void 0,this.elapsed+=Date.now()-this.lastTime)}step(){let o=Date.now();this.elapsed+=o-this.lastTime,this.lastTime=o,this.timer=window.setTimeout(()=>{this.step()},1e3)}};function Qn(...i){return Ji.play(...i)}var Ji={volume:.3,sampleRate:44100,audioContext:new AudioContext,play:function(...i){return this.playSamples([this.buildSamples(...i)])},playSamples:function(i,o=1,e=1,t=0,n=!1){let r=i.length,a=i[0].length,s=this.audioContext.createBuffer(r,a,this.sampleRate),c=this.audioContext.createBufferSource();i.forEach((_,P)=>s.getChannelData(P).set(_)),c.buffer=s,c.playbackRate.value=e,c.loop=n;let d=this.audioContext.createGain();d.gain.value=this.volume*o,d.connect(this.audioContext.destination);let g=new StereoPannerNode(this.audioContext,{pan:t});return c.connect(g).connect(d),c.start(),c},buildSamples:function(i=1,o=.05,e=220,t=0,n=0,r=.1,a=0,s=1,c=0,d=0,g=0,_=0,P=0,E=0,w=0,V=0,I=0,F=1,X=0,W=0,xe=0){let J=this.sampleRate,ue=Math.PI*2,It=Math.abs,Bt=Qi=>Qi<0?-1:1,Hi=c*=500*ue/J/J,tn=e*=(1+o*2*Math.random()-o)*ue/J,Ui=0,zi=0,Ki=0,Je=1,Fe,Dt=[],Se=0,le=0,Ce=0,At,Yi=2,nn=ue*It(xe)*2/J,Rt=Math.cos(nn),on=Math.sin(nn)/2/Yi,et=1+on,qi=-2*Rt/et,Xi=(1-on)/et,rn=(1+Bt(xe)*Rt)/2/et,Wi=-(Bt(xe)+Rt)/et,Zi=rn,an=0,sn=0,ln=0,cn=0;for(t=t*J||9,X*=J,n*=J,r*=J,I*=J,d*=500*ue/J**3,w*=ue/J,g*=ue/J,_*=J,P=P*J|0,i*=this.volume,Fe=t+X+n+r+I|0;le<Fe;Dt[le++]=Ce*i)++Ki%(V*100|0)||(Ce=a?a>1?a>2?a>3?a>4?(Se/ue%1<s/2)*2-1:Math.sin(Se**3):Math.max(Math.min(Math.tan(Se),1),-1):1-(2*Se/ue%2+2)%2:1-4*It(Math.round(Se/ue)-Se/ue):Math.sin(Se),Ce=(P?1-W+W*Math.sin(ue*le/P):1)*(a>4?Ce:Bt(Ce)*It(Ce)**s)*(le<t?le/t:le<t+X?1-(le-t)/X*(1-F):le<t+X+n?F:le<Fe-I?(Fe-le-I)/r*F:0),Ce=I?Ce/2+(I>le?0:(le<Fe-I?1:(Fe-le)/I)*Dt[le-I|0]/2/i):Ce,xe&&(Ce=cn=Zi*an+Wi*(an=sn)+rn*(sn=Ce)-Xi*ln-qi*(ln=cn))),At=(e+=c+=d)*Math.cos(w*Ui++),Se+=At+At*E*Math.sin(le**5),Je&&++Je>_&&(e+=g,tn+=g,Je=0),P&&!(++zi%P)&&(e=tn,c=Hi,Je||=1);return Dt},getNote:function(i=0,o=440){return o*2**(i/12)}};var ie={NOPE:[],SELECT:[2,.2,400,,,.02,,3,-50,,,,,,16,,,,,,500,1],MATCH:[2,.2,800,,,.02,,3,-50,,,,,,16,,,,,,500,1],OVER:[2,,146,.02,.23,.04,3,2.47,-1.3,,,,,,-112,,.2,.99,.04],UNDO:[1,.1,260,.24,,.05,,.7,64,,135,.22,.01,.1,,,.07,,.01,.54],HINT:[1,.1,201,.09,.04,.08,1,1.87,,-25,,,,,55,,,.4,.01],SHUFFLE:[1,0,288,.05,.01,,,2,-10,,,,,,,,,.5,.1],WIN:[2,.05,6,.09,.14,.46,1,.28,0,0,-54,.09,.06,0,0,0,.15,.54,.04,0]},gt=class{constructor(){this.enabled=!0}play(o){if(this.enabled)try{Qn(...o)}catch(e){}}};var mt=class{constructor(){this.enabled=!1}play(){}pause(){}toggle(){}toggleMusic(){}};var ht="random-";var ut=class{constructor(o){this.storage=o,this.clock=new pt,this.board=new He,this.sound=new gt,this.music=new mt,this.state=pe.idle,this.layoutID=void 0,this.mode=$t,this.saveTimer=void 0}init(){this.load(),this.board.update(),this.state===pe.run&&this.pause(),this.message={messageID:this.isPaused()?"MSG_CONTINUE_SAVE":"MSG_START"}}click(o){return o?!this.isRunning()||o.state.blocked?(this.sound.play(ie.NOPE),this.wiggleStone(o),!0):(this.clock.elapsed===0&&this.clock.run(),this.board.selected&&o&&o!==this.board.selected&&o.groupNr===this.board.selected.groupNr?(this.resolveMatchingStone(o),!0):(this.board.setStoneSelected(this.board.selected===o?void 0:o),this.sound.play(ie.SELECT),!0)):(this.board.clearSelection(),!1)}wiggleStone(o){o&&(o.effects=o.effects||{},o.effects.wiggle=!0,setTimeout(()=>{o.effects&&(o.effects.wiggle=!1)},300))}isRunning(){return this.state===pe.run}isPaused(){return this.state===pe.pause}isIdle(){return this.state===pe.idle}resume(){this.run(),this.clock.run(),this.music.play()}run(){this.board.clearHints(),this.board.update(),this.setState(pe.run)}toggle(){this.state===pe.run?this.pause():this.state===pe.pause&&this.resume()}pause(){this.clock.pause(),this.setState(pe.pause,"MSG_CONTINUE_PAUSE"),this.save(),this.music.pause()}reset(){this.clock.reset(),this.setState(pe.idle),this.board.reset()}start(o,e,t){this.layoutID=o.id,this.mode=t,this.board.applyMapping(o.mapping,e),this.board.update(),this.run()}hint(){this.mode!==Gt&&(this.board.hint(),this.sound.play(ie.HINT))}shuffle(){this.mode===je&&(this.board.shuffle(),this.sound.play(ie.SHUFFLE))}back(){this.mode!==Gt&&this.isRunning()&&(this.board.back(),this.sound.play(ie.UNDO))}load(){try{let o=this.storage.getState();if(o?.stones)return this.clock.elapsed=o.elapsed??0,this.layoutID=o.layout,this.mode=o.gameMode??$t,this.state=o.state??pe.idle,this.board.load(o.stones,o.undo??[]),!0}catch(o){console.error("load state failed",o)}return!1}save(){if(this.layoutID)try{this.storage.storeState({elapsed:this.clock.elapsed,state:this.state,layout:this.layoutID,gameMode:this.mode,undo:this.board.undo,stones:this.board.save()})}catch(o){console.error("storing state failed",o)}}isStorableLayoutId(){return this.layoutID!==void 0&&!this.layoutID.startsWith(ht)}storeLostGame(){if(this.isStorableLayoutId()){let o=this.layoutID??"unknown",e=this.storage.getScore(o)??{};e.playCount=(e.playCount??0)+1,this.storage.storeScore(o,e)}}gameOverLosing(){this.storeLostGame(),this.sound.play(ie.OVER),this.gameOver("MSG_FAIL")}gameOverEasyModeShuffle(){for(let o=0;o<10;o++)if(this.shuffle(),this.board.free.length>0){this.resume();return}this.gameOverEasyMode()}surrender(){this.storeLostGame(),this.sound.play(ie.OVER),this.setState(pe.idle),this.clock.reset()}checkGameState(){if(this.board.count<2)this.gameOverWinning();else if(this.board.free.length===0){if(this.mode===je&&this.board.countUnblocked()>1)return this.gameOverEasyMode(),!1;this.gameOverLosing()}else return this.sound.play(ie.MATCH),this.delayedSave(),!0;return!1}gameOverWinning(){let o=this.clock.elapsed;if(!this.isStorableLayoutId()){this.gameOver("MSG_GOOD",o);return}let e=this.layoutID??"unknown",t=this.storage.getScore(e)??{};t.playCount=(t.playCount??0)+1,!t.bestTime||t.bestTime>o?(t.bestTime=o,this.gameOver("MSG_BEST",o)):this.gameOver("MSG_GOOD",o),this.storage.storeScore(e,t),this.sound.play(ie.WIN)}delayedSave(){clearTimeout(this.saveTimer),this.saveTimer=setTimeout(()=>{this.save()},300)}gameOverEasyMode(){this.clock.pause(),this.message={messageID:"MSG_FAIL",askShuffle:!0},this.state=pe.pause,this.delayedSave(),this.music.pause()}resolveMatchingStone(o){let e=this.board.selected;e&&(this.board.pick(e,o),this.checkGameState())}gameOver(o,e){this.setState(pe.idle,o,e),this.clock.reset(),this.delayedSave()}setState(o,e,t){this.message=e?{messageID:e,playTime:t}:void 0,this.state=o}};var Xe={en:"English",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",ca:"Catal\xE0",cs:"\u010Ce\u0161tina",da:"Dansk",de:"Deutsch",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",es:"Espa\xF1ol",eu:"Euskara",fa:"\u0641\u0627\u0631\u0633\u06CC",fi:"Suomi",fil:"Filipino",fr:"Fran\xE7ais",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",hu:"Magyar",id:"Bahasa Indonesia",it:"Italiano",jp:"\u65E5\u672C\u8A9E",ko:"\uD55C\uAD6D\uC5B4",ms:"Bahasa Melayu",nl:"Nederlands",no:"Norsk",pl:"Polski",pt:"Portugu\xEAs",ro:"Rom\xE2n\u0103",ru:"\u0440\u0443\u0441\u0441\u043A\u0438\u0439",sv:"Svenska",sw:"Kiswahili",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t",zh:"\u4E2D\u6587"};var _t=class{constructor(o){this.storageProvider=o,this.lang=Ut,this.sounds=!0,this.tileset=Ve,this.music=!1,this.contrast=!1,this.dark=!1,this.background="",this.theme=Ht,this.tutorialCompleted=!1,this.stats={games:0,bestTime:0}}load(){try{let o=this.storageProvider.getSettings();return o&&(this.lang=o.lang??Ut,this.tileset=o.tileset??Ve,this.background=o.background??this.background,this.pattern=o.pattern,this.theme=o.theme??Ht,this.contrast=o.contrast??!1,this.dark=o.dark??!1,this.sounds=o.sounds??this.sounds,this.music=o.music??this.music,this.kyodaiUrl=o.kyodaiUrl,this.tutorialCompleted=o.tutorialCompleted??!0),!0}catch(o){console.error("load settings failed",o)}return!1}save(){try{return this.storageProvider.storeSettings({lang:this.lang,sounds:this.sounds,music:this.music,contrast:this.contrast,dark:this.dark,background:this.background,pattern:this.pattern,theme:this.theme,tileset:this.tileset,kyodaiUrl:this.kyodaiUrl,tutorialCompleted:this.tutorialCompleted}),!0}catch(o){console.error("storing settings failed",o)}return!1}};var he=(()=>{class i{constructor(){this.name="Mah Jong",this.cache={},this.storage=k(De),this.translate=k(Be),this.game=new ut(this.storage),this.settings=new _t(this.storage),this.settings.load(),this.setLang(),this.game.init(),this.game.sound.enabled=this.settings.sounds,this.game.music.enabled=this.settings.music}getCachedValue(e){return this.cache[e]}cacheValue(e,t){if(t===void 0){delete this.cache[e];return}this.cache[e]=t}setLang(){let e=!this.settings.lang||this.settings.lang===Un?(navigator.language.split("-")[0]||"en").toLowerCase():this.settings.lang;Object.keys(Xe).includes(e)?this.translate.use(e):this.translate.use("en")}toggleSound(){this.settings.sounds=!this.settings.sounds,this.game.sound.enabled=this.settings.sounds,this.settings.save()}toggleMusic(){this.settings.music=!this.settings.music,this.game.music.enabled=this.settings.music,this.game.music.toggle(),this.settings.save()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Oe({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var eo=["*"];function to(i,o){if(i&1&&(B(0,"h1"),de(1,"i",5),f(2),D()),i&2){let e=C(2);l(2),M(e.title())}}function no(i,o){if(i&1){let e=A();B(0,"a",6),h(1,"translate"),ge("click",function(){x(e);let n=C(2);return y(n.toggle())}),de(2,"i",7),D()}i&2&&ot("title",G(u(1,2,"CLOSE")))}function io(i,o){if(i&1){let e=A();B(0,"div",1),ge("click",function(){x(e);let n=C();return y(n.toggleOverlay())}),B(1,"div",2),ge("click",function(n){return x(e),y(n.stopPropagation())}),B(2,"div",3),T(3,to,3,1,"h1"),T(4,no,3,4,"a",4),D(),xn(5),D()()}if(i&2){let e=C();Me(te("overlay ",e.className())),l(3),L(e.title()?3:-1),l(),L(e.noCloseButton()?-1:4)}}var ei=(()=>{class i{constructor(){this.title=R(),this.className=R(),this.visible=st(!1),this.noCloseButton=R(!1),this.allowCloseOverlay=R(!0),this.clickEvent=me()}toggleOverlay(){this.allowCloseOverlay()&&this.toggle()}toggle(){this.visible.set(!this.visible()),this.clickEvent.emit(this.visible())}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-dialog"]],inputs:{title:[1,"title"],className:[1,"className"],visible:[1,"visible"],noCloseButton:[1,"noCloseButton"],allowCloseOverlay:[1,"allowCloseOverlay"]},outputs:{visible:"visibleChange",clickEvent:"clickEvent"},ngContentSelectors:eo,decls:1,vars:1,consts:[[3,"class"],[3,"click"],[1,"overlay-popup",3,"click"],[1,"dialog-header"],["role","button",1,"close",3,"title"],[1,"icon-logo"],["role","button",1,"close",3,"click","title"],[1,"icon-cancel-circled2"]],template:function(t,n){t&1&&(vn(),T(0,io,6,5,"div",0)),t&2&&L(n.visible()?0:-1)},dependencies:[Z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;color:var(--main-content-text-color)}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;color:var(--dialog-headline-color);margin-top:-8px;margin-bottom:10px;line-height:1.3em}@media only screen and (max-width:700px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2em}}@media only screen and (max-width:400px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1em}}"]})}}return i})();function Ue(i){if(Q.openExternal){i.preventDefault();try{let o=i.target;for(;o&&!(o instanceof HTMLAnchorElement);)o=o.parentElement;if(o&&o instanceof HTMLAnchorElement){let e=o.getAttribute("href")??"";Q.openExternal(e)}}catch(o){console.error(o)}}}function oo(i,o){if(i&1&&(B(0,"li")(1,"div")(2,"span",15),f(3),D(),de(4,"i"),B(5,"span",5),f(6),h(7,"translate"),D()(),B(8,"span",16),f(9),h(10,"translate"),D()()),i&2){let e=o.$implicit;l(3),M(e.key),l(),Me(e.icon),l(2),M(u(7,5,e.name)),l(3),M(u(10,7,e.name+"_LONG"))}}var ti=(()=>{class i{constructor(){this.showTutorial=me(),this.shortcuts=[{icon:"icon-lightbulb",key:"T",name:"HINT"},{icon:"icon-spin1",key:"M",name:"SHUFFLE"},{icon:"icon-undo",key:"U",name:"UNDO"},{icon:"icon-loop",key:"N",name:"RESTART"},{icon:"icon-pause",key:"P",name:"PAUSE"},{icon:"icon-calendar",key:"I",name:"INFO"},{icon:"icon-cog",key:"S",name:"SETTINGS"},{icon:"icon-logo",key:"H",name:"HELP"}],this.clickExternalHref=Ue}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-help"]],outputs:{showTutorial:"showTutorial"},decls:81,vars:48,consts:[[1,"top"],[1,"help"],["role","button",1,"tutorial-link",3,"click"],[1,"license"],[1,"license-list"],[1,"name"],[1,"info"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/tree/main/src/assets/svg/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/sounds/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/fonts/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/img/README.md",3,"click"],["rel","noopener","target","_blank","href","https://github.com/ffalt/mah/blob/main/src/assets/patterns/README.md",3,"click"],[1,"keyboard"],[1,"keyboard-list"],[1,"key"],[1,"func"]],template:function(t,n){t&1&&(B(0,"div",0)(1,"fieldset",1)(2,"legend"),f(3),h(4,"translate"),D(),B(5,"p"),f(6),h(7,"translate"),D(),B(8,"p")(9,"b"),f(10),h(11,"translate"),D(),f(12),h(13,"translate"),D(),B(14,"p")(15,"b"),f(16),h(17,"translate"),D(),f(18),h(19,"translate"),D(),B(20,"p"),f(21),h(22,"translate"),D(),B(23,"p")(24,"a",2),ge("click",function(){return n.showTutorial.emit()}),f(25),h(26,"translate"),D()()(),B(27,"fieldset",3)(28,"legend"),f(29),h(30,"translate"),D(),B(31,"div",4)(32,"div")(33,"div",5),f(34),h(35,"translate"),D(),B(36,"div",6)(37,"a",7),ge("click",function(a){return n.clickExternalHref(a)}),f(38,"MIT"),D()()(),B(39,"div")(40,"div",5),f(41),h(42,"translate"),D(),B(43,"div",6)(44,"a",8),ge("click",function(a){return n.clickExternalHref(a)}),f(45,"Free | Public Domain | CCA4.0 | GNU"),D()()(),B(46,"div")(47,"div",5),f(48),h(49,"translate"),D(),B(50,"div",6)(51,"a",9),ge("click",function(a){return n.clickExternalHref(a)}),f(52,"MIT"),D()()(),B(53,"div")(54,"div",5),f(55),h(56,"translate"),D(),B(57,"div",6)(58,"a",10),ge("click",function(a){return n.clickExternalHref(a)}),f(59,"SIL"),D()()(),B(60,"div")(61,"div",5),f(62),h(63,"translate"),D(),B(64,"div",6)(65,"a",11),ge("click",function(a){return n.clickExternalHref(a)}),f(66,"Public Domain"),D()()(),B(67,"div")(68,"div",5),f(69),h(70,"translate"),D(),B(71,"div",6)(72,"a",12),ge("click",function(a){return n.clickExternalHref(a)}),f(73,"MIT"),D()()()()()(),B(74,"fieldset",13)(75,"legend"),f(76),h(77,"translate"),D(),B(78,"ul",14),N(79,oo,11,9,"li",null,U),D()()),t&2&&(l(3),M(u(4,16,"HOW_TO_PLAY")),l(3),M(u(7,18,"HOW_GOAL")),l(4),M(u(11,20,"HOW_OPEN")),l(2),K(": ",u(13,22,"HOW_OPEN_DESC")),l(4),M(u(17,24,"HOW_PAIR")),l(2),K(": ",u(19,26,"HOW_PAIR_DESC")),l(3),M(u(22,28,"HOW_DO")),l(4),M(u(26,30,"TUTORIAL_SHOW")),l(4),M(u(30,32,"LICENSE")),l(5),M(u(35,34,"GAME")),l(7),M(u(42,36,"DESIGNS")),l(7),M(u(49,38,"SOUNDS")),l(7),M(u(56,40,"FONTS")),l(7),M(u(63,42,"BACKGROUNDS")),l(7),M(u(70,44,"PATTERN_SETTINGS")),l(7),M(u(77,46,"SHORTCUTS")),l(3),j(n.shortcuts))},dependencies:[Z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;flex:1;overflow:hidden auto;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{border:1px solid var(--main-bg-color-lt);border-radius:8px;padding:8px 12px 12px;flex:1}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{padding:0 6px;font-weight:700}[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{flex:1;padding-right:6px;display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   .help[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:4px}[_nghost-%COMP%]   .help[_ngcontent-%COMP%]   .tutorial-link[_ngcontent-%COMP%]{cursor:pointer;color:var(--main-content-link-color);text-decoration:underline}[_nghost-%COMP%]   .help[_ngcontent-%COMP%]   .tutorial-link[_ngcontent-%COMP%]:hover{color:var(--main-content-link-hover-color)}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .license-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:40%;max-width:40%}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]{padding:0;list-style:none;columns:2}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{break-inside:avoid;margin-bottom:14px}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .func[_ngcontent-%COMP%]{margin-top:8px;font-size:.8em;display:block}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{vertical-align:middle}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:8px;vertical-align:middle;color:var(--main-content-text-color)}[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;padding-left:4px;padding-right:4px;border:2px solid #ddd;border-radius:6px;min-height:20px;min-width:28px;font-size:.7em;vertical-align:top;display:inline-block;letter-spacing:1px;background:#000;color:#ddd;box-shadow:0 5px #000;text-align:center}@media only screen and (max-width:700px){[_nghost-%COMP%]   .keyboard[_ngcontent-%COMP%]   .keyboard-list[_ngcontent-%COMP%]{columns:1}}@media only screen and (max-width:1000px){[_nghost-%COMP%]{flex-flow:column nowrap}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .top[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .top[_ngcontent-%COMP%]{flex-flow:column nowrap}[_nghost-%COMP%]   .help[_ngcontent-%COMP%], [_nghost-%COMP%]   .license[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .license-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex-wrap:wrap;margin-bottom:8px}[_nghost-%COMP%]   .license[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:100%;max-width:100%}}"]})}}return i})();function ft(i){return["kyodai","kyodai-black"].includes(i)}var ii=[{name:"Traditional",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191758/https://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/79546_orig.jpg"},{name:"Cards",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/4962942_orig.jpg"},{name:"Board Games",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3862268_orig.jpg"},{name:"Motorcycles",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8438984_orig.jpg"},{name:"NHL",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/630927_orig.jpg"},{name:"Social Media",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/241535_orig.jpg"},{name:"Monopoly",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191753im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9084861_orig.jpg"},{name:"Horror Films",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/849930_orig.jpg"},{name:"Animated Movies",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2303366_orig.jpg"},{name:"Stephen King",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/4168429_orig.jpg"},{name:"Lord of the Rings",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3966297_orig.jpg"},{name:"007",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9617288_orig.jpg"},{name:"Disney Princess",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191738im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2281343_orig.jpg"},{name:"Religions",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191748im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2620625_orig.jpg"},{name:"Happy Eastern",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1396173_orig.jpg"},{name:"Halloween",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8455923_orig.jpg"},{name:"Neck Ties",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9349600_orig.jpg"},{name:"Floral",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/3178635_orig.jpg"},{name:"Easter Eggs",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8685131_orig.jpg"},{name:"St. Patricks Day",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/7310933_orig.jpg"},{name:"Valentine's Day",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1140822_orig.jpg"},{name:"Christmas",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191728im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/1525811_orig.jpg"},{name:"Canada Flower & Birds",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2953105_orig.jpg"},{name:"Canada Scenery",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/8401335_orig.jpg"},{name:"Nova Scotia",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2933195_orig.jpg"},{name:"Canada Birds",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170903191743im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/9756515_orig.jpg"},{name:"Arabic Alphabet & Numbers",author:"My Kyodai Mahjongg",source:"https://web.archive.org/web/20170902065732im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/5652995_orig.jpg"},{name:"Mahjongg Platinum 2 Dark",author:"Pavel Osharin",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2479283_orig.jpg"},{name:"Mahjongg Platinum 2 Red",author:"Pavel Osharin",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/2090721_orig.jpg"},{name:"Mahjongg Titans",author:"Microsoft Vista",source:"https://web.archive.org/web/20170903191723im_/http://kyodaimahjongg.weebly.com/uploads/9/5/2/9/9529146/6604294_orig.jpg"},{name:"Viking Artifacts 1",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/VikingArtifacts.jpg"},{name:"Viking Artifacts 2",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/VikingArtifacts2.jpg"},{name:"Art of the Scythians",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/ScythianArt.jpg"},{name:"Waite-Rider Tarot",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/WaiteRiderTarot.jpg"},{name:"Waite-Rider Tarot Images",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725im_/http://www.vikinganswerlady.com/kyodai/WaiteRiderTarotImagesThumbnail.jpg"},{name:"Morgan-Greer Tarot",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/MorganGreerTarot.jpg"},{name:"Xena: Tarot of the Bitter Suite",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/BitterSuite.jpg"},{name:"A Rainbow of Bearded Irises",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/RainbowIris.jpg"},{name:"Antique Roses",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/AntiqueRoses.jpg"},{name:"Flags of the World",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725im_/http://www.vikinganswerlady.com/kyodai/FlagsThumbnail.jpg"},{name:"X-Men",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/XMen.jpg"},{name:"Age of Empires II: Age of Kings",author:"vikinganswerlady",source:"https://web.archive.org/web/20030919052725/http://www.vikinganswerlady.com/kyodai/AOEII.jpg"}];function ro(i){return ce(this,null,function*(){return new Promise((o,e)=>{let t=new Image;t.addEventListener("load",()=>{o(t)}),t.addEventListener("error",n=>{console.error(n),e(new Error(`Image ${i} could not be loaded.`))}),t.src=i})})}function ni(i,o,e,t){let n="";for(let[r,a]of i.entries()){let s=r*e;for(let[c,d]of a.entries()){let g=c*t;n+=`<svg preserveAspectRatio="xMidYMid slice" id="${d}" width="75" height="100" viewBox="${g} ${s} ${t} ${e}"><use xlink:href="#${o}"></use></svg>`}}return n}function oi(i){return ce(this,null,function*(){if(!i)return"<svg><defs></defs></svg>";let o=(d,g)=>[...Array.from({length:g}).keys()].map(_=>_+d),e=[o(1,9).map(d=>`do${d}`),o(1,9).map(d=>`ba${d}`),o(1,9).map(d=>`ch${d}`),["se_winter","se_spring","se_summer","se_fall","wi_north","wi_south","wi_east","wi_west"],["fl_bamboo","fl_plum","fl_orchid","fl_chrysanthemum","dr_green","dr_white","dr_red"]].map(d=>d.map(g=>`t_${g}`)),t=[o(1,9).map(d=>`g${d}`),o(10,9).map(d=>`g${d}`),o(1,9).map(d=>`e${d}`)].map(d=>d.map(g=>`t_${g}`)),n=yield ro(i),r=n.height/5,a=n.width/9,s=Kt(i),c=Kt("kyodai-extra");return`<svg><defs>
<image id="${s}" xlink:href="${i}" x="0" y="0" height="${n.height}" width="${n.width}"/>
<image id="${c}" xlink:href="/assets/svg/kyodai-extra.png" x="0" y="0" height="300" width="675"/>
${ni(e,s,r,a)}
${ni(t,c,100,75)}
</defs></svg>
`})}var Ct=(()=>{class i{constructor(){this.http=k(Ie),this.cache={}}get(e,t){return ce(this,null,function*(){if(ft(e))return oi(t);let n=this.cache[e];if(n){if(n.data)return n.data;if(n.request!==void 0)return n.request}n={};let r=new Promise((a,s)=>{setTimeout(()=>{this.http.get(`assets/svg/${e}.svg`,{responseType:"text"}).subscribe({next:c=>{n.data=c,n.request=void 0,a(c)},error:c=>{s(c)}})})});return n.request=r,this.cache[e]=n,r})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Oe({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ri='<svg id="mah-error-icon" width="60" height="60" shape-rendering="geometricPrecision" text-rendering="geometricPrecision"image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="10 0 560 431.15"><g fill-rule="nonzero"><path fill="#D92D27" d="M492.56 431.15H19.42v-.05c-14.72.03-24.33-16.08-16.78-29.12L234.51 9.64c7.35-12.57 25.75-13.05 33.42-.23l240.41 390.96c9.12 12.64.2 30.78-15.78 30.78z"/><path fill="#fff" d="M41.15 399.63h431.88L252.71 47.08c-.63-.99-1.38-.98-1.97 0L40.02 397.9c-.63 1.12-.31 1.74 1.13 1.73z"/><path d="M243.18 246.58h25.46v20.32h-25.46v-20.32zm-78.9 102.8h-17.43v7.87h21.35v12.7h-38.78v-54.47h38.35l-2.18 12.69h-18.74v8.58h17.43v12.63zm58.16 20.57h-19.16l-7.15-16.21h-5v16.21h-16.18v-54.47h27.45c12.49 0 18.74 6.36 18.74 19.08 0 8.72-2.7 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.26c2.09 0 3.62-.23 4.57-.66.95-.43 1.44-1.44 1.44-3v-4.82c0-1.57-.49-2.58-1.44-3.01-.95-.43-2.49-.66-4.57-.66h-5.26zm84.25 41.78h-19.17l-7.15-16.21h-4.99v16.21h-16.18v-54.47h27.45c12.49 0 18.74 6.36 18.74 19.08 0 8.72-2.7 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.25c2.1 0 3.63-.23 4.58-.66.95-.43 1.44-1.44 1.44-3v-4.82c0-1.57-.49-2.58-1.44-3.01-.95-.43-2.5-.66-4.58-.66h-5.25zm34.14 14.59c0-9.94 1.86-17.18 5.58-21.74 3.71-4.57 10.43-6.85 20.13-6.85s16.41 2.28 20.13 6.85c3.72 4.56 5.58 11.8 5.58 21.74 0 4.94-.4 9.09-1.18 12.46-.78 3.37-2.14 6.3-4.05 8.8-1.92 2.5-4.57 4.33-7.93 5.49-3.37 1.16-7.551.74-12.55 1.74-4.99 0-9.18-.58-12.55-1.74-3.37-1.16-6.01-2.99-7.93-5.49s-3.27-5.43-4.05-8.8c-.79-3.37-1.18-7.52-1.18-12.46zm18.74-9.07v22.66h7.23c2.38 0 4.11-.27 5.19-.831.07-.55 1.61-1.81 1.61-3.79v-22.66h-7.33c-2.32 0-4.02.28-5.09.83-1.07.55-1.61 1.81-1.61 3.79zm85.62 36.26H363.4l-7.15-16.21h-4.99v16.21h-16.18v-54.47h27.44c12.5 0 18.756.36 18.75 19.08 0 8.72-2.71 14.47-8.11 17.26l9.41 18.13zm-31.31-41.78v12.15h5.25c2.1 0 3.63-.23 4.58-.66.95-.43 1.43-1.44 1.43-3v-4.82c0-1.57-.48-2.58-1.43-3.01-.95-.43-2.5-.66-4.58-.66h-5.25zm-82.62-93h-25.46c-1.82-22.29-4.73-26.26-5.95-40.78-1.25-14.61-2.12-35.58 18.73-35.58 21.86 0 20.1 23.36 18.45 38.47-1.37 12.45-4.05 17.16-5.77 37.89z"/></g></svg>',ai='<svg id="mah-tile-spinner" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g><rect x="11" y="1" width="2" height="5" opacity=".14"/><rect x="11" y="1" width="2" height="5" transform="rotate(30 12 12)" opacity=".29"/><rect x="11" y="1" width="2" height="5" transform="rotate(60 12 12)" opacity=".43"/><rect x="11" y="1" width="2" height="5" transform="rotate(90 12 12)" opacity=".57"/><rect x="11" y="1" width="2" height="5" transform="rotate(120 12 12)" opacity=".71"/><rect x="11" y="1" width="2" height="5" transform="rotate(150 12 12)" opacity=".86"/><rect x="11" y="1" width="2" height="5" transform="rotate(180 12 12)"/><animateTransform attributeName="transform" type="rotate" calcMode="discrete" dur="0.75s" values="0 12 12;30 12 12;60 12 12;90 12 12;120 12 12;150 12 12;180 12 12;210 12 12;240 12 12;270 12 12;300 12 12;330 12 12;360 12 12" repeatCount="indefinite"/></g></svg>';var ao=["app-image-set-loader",""],Mt=(()=>{class i{constructor(){this.imageSet=R(),this.kyodaiUrl=R(),this.prefix=R(),this.dark=R(!1),this.elementRef=k(be),this.svgDef=k(Ct)}ngOnChanges(e){this.getImageSet()}setLoading(){let e=[ai];for(let t of zt)for(let n of t)e.push(`<svg id="${n}" width="75" height="100"><use xlink:href="#mah-tile-spinner" transform="translate(26,42)"></use></svg>`);this.setImageSet(`<svg><defs>${e.join("")}</defs></svg>`)}prepareDefs(e){let t=e.indexOf("<defs>"),n=e.lastIndexOf("</defs>");return(t!==-1&&n!==-1&&n>t+6?e.slice(t+6,n):"").replace(/xlink:href="\./g,'xlink:href="assets/svg').replace(/ id="t_/g,` id="${this.prefix()}t_`)}setError(){let e=[ri];for(let t of zt)for(let n of t)e.push(`<svg id="${n}" width="75" height="100"><use xlink:href="#mah-error-icon" transform="translate(8,18)"></use></svg>`);this.setImageSet(`<svg><defs>${e.join("")}</defs></svg>`)}setImageSet(e){this.elementRef.nativeElement.innerHTML="";let t=this.prepareDefs(e);setTimeout(()=>{this.elementRef.nativeElement.innerHTML=t},0)}loadImageSet(){let e=this.imageSet()+(this.dark()?"-black":"");this.svgDef.get(e,this.kyodaiUrl()).then(t=>{this.setImageSet(t)}).catch(t=>{this.setError(),console.error(t)})}getImageSet(){this.imageSet()&&(this.setLoading(),setTimeout(()=>this.loadImageSet(),0))}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["","app-image-set-loader",""]],inputs:{imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],prefix:[1,"prefix"],dark:[1,"dark"]},features:[Ee],attrs:ao,decls:1,vars:0,template:function(t,n){t&1&&(Y(),de(0,"defs"))},encapsulation:2})}}return i})();var si=(()=>{class i{constructor(){this.imageSet=R(),this.kyodaiUrl=R(),this.tile=R.required(),this.index=R(),this.isDark=R(!1)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-tile"]],inputs:{imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],tile:[1,"tile"],index:[1,"index"],isDark:[1,"isDark"]},decls:6,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 75 100","preserveAspectRatio","xMidYMid meet"],["app-image-set-loader","",3,"imageSet","kyodaiUrl","dark","prefix"],["x","6","y","6","width","63","height","88"]],template:function(t,n){t&1&&(Y(),p(0,"svg",0),S(1,"defs",1),p(2,"title"),f(3),h(4,"translate"),m(),S(5,"use",2),m()),t&2&&(ee("dark",n.isDark()),l(),O("imageSet",n.imageSet())("kyodaiUrl",n.kyodaiUrl())("dark",n.isDark())("prefix","t_"+n.imageSet()+"_"+n.index()+"_"),l(2),M(u(4,8,n.tile())),l(2),ne("href","#t_"+n.imageSet()+"_"+n.index()+"_"+n.tile(),null,"xlink"))},dependencies:[Mt,Z],styles:["[_nghost-%COMP%]{display:block;width:75px;height:100px;margin:0 auto}[_nghost-%COMP%] > svg[_ngcontent-%COMP%]{height:100%;width:auto;background-color:var(--tile-color);border:1px solid var(--tile-color-border)}[_nghost-%COMP%] > svg.dark[_ngcontent-%COMP%]{background-color:var(--tile-color-dark);border:1px solid var(--tile-color-border-dark)}"]})}}return i})();function so(i,o){i&1&&(Y(),de(0,"path",3))}function lo(i,o){i&1&&(Y(),de(0,"path",4))}function co(i,o){i&1&&(Y(),de(0,"path",5))}function po(i,o){i&1&&(Y(),de(0,"path",6))}function go(i,o){i&1&&(Y(),de(0,"path",7))}function mo(i,o){i&1&&(Y(),de(0,"path",8))}var Pt=(()=>{class i{constructor(){this.link=R.required(),this.licenseKey=R.required(),this.licenses=Hn,this.clickExternalHref=Ue}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-license-link"]],inputs:{link:[1,"link"],licenseKey:[1,"licenseKey"]},decls:9,vars:3,consts:[["target","_blank","rel","noopener",3,"click","href","title"],["xmlns","http://www.w3.org/2000/svg",0,"xml","space","preserve","fill-rule","evenodd","stroke-linecap","round","clip-rule","evenodd","viewBox","0 0 1067 1067"],["fill","#fff","fill-rule","nonzero","stroke","#000","stroke-width","62.55","d","M1034.158 535.104c0 276.808-224.169 501.207-500.698 501.207-276.535 0-500.703-224.398-500.703-501.207S256.926 33.897 533.46 33.897c276.535 0 500.694 224.398 500.694 501.207h.005Z"],["fill-rule","nonzero","d","m463.156 546.582 68.977 28.564q-6.95 39.752-21.892 66.412t-37.095 40.228q-22.152 13.568-56.381 13.568-41.526 0-67.848-16.544-26.322-16.543-45.435-58.2-19.112-41.657-19.112-106.641 0-86.646 33.62-133.182t95.126-46.536q48.127 0 75.667 26.66t40.917 81.885l-69.499 21.185q-3.649-15.948-7.645-23.328-6.603-12.378-16.158-19.043t-21.371-6.665q-26.757 0-41.004 29.517-10.773 21.9-10.772 68.793 0 58.082 12.857 79.623 12.858 21.543 36.139 21.542 22.587 0 34.141-17.377t16.767-50.464Zm276.778 0 68.977 28.564q-6.95 39.752-21.892 66.412t-37.095 40.228-56.381 13.568q-41.526 0-67.848-16.544-26.322-16.543-45.435-58.2-19.112-41.657-19.112-106.641 0-86.646 33.62-133.182t95.126-46.536q48.127 0 75.667 26.66t40.917 81.885l-69.499 21.185q-3.649-15.948-7.645-23.328-6.603-12.378-16.158-19.043t-21.371-6.665q-26.757 0-41.004 29.517-10.773 21.9-10.772 68.793 0 58.082 12.857 79.623 12.858 21.543 36.139 21.542 22.587 0 34.141-17.377t16.767-50.464Z"],["fill-rule","nonzero","d","M288.297 575.269v-72.601H409.92v148.773q-34.923 32.611-61.767 44.394t-63.678 11.783q-45.348 0-73.929-21.185t-44.305-63.08q-15.724-41.894-15.724-96.167 0-57.13 17.201-99.38 17.2-42.251 50.387-64.151 25.889-16.9 69.672-16.901 42.22 0 63.157 10.474t34.749 32.492 20.763 55.82l-75.927 18.567q-4.691-19.756-15.898-30.231-11.207-10.474-28.581-10.474-25.889 0-41.265 24.637t-15.377 77.957q0 56.653 15.55 80.933t43.35 24.28q13.205 0 25.193-5.237t27.452-17.853V575.27zM456.31 352.704h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089v129.492H456.31zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm178.264-148.773h78.707v263.031h122.839v85.931H713.629z"],["fill-rule","nonzero","d","M156.426 390.204h151.806v58.494h-90.135v47.538h76.987v54.965h-76.987v111.231h-61.671zm185.691 272.228V390.205H444.45q28.464 0 43.509 6.685t24.262 24.79 9.217 44.102q0 22.655-7.048 39.089-7.049 16.434-19.382 26.647-7.862 6.5-21.551 10.77 10.978 5.013 15.994 10.027 3.389 3.342 9.827 14.298t8.607 16.898l29.683 78.92h-69.397L435.37 579.24q-6.235-16.155-11.114-20.983-6.642-6.314-15.045-6.314h-5.422v110.488zm61.671-161.925h25.888q4.202 0 16.265-3.714 6.1-1.67 9.962-8.542 3.863-6.87 3.863-15.784 0-13.184-6.099-20.241-6.1-7.056-22.906-7.056h-26.973zm153.296-110.303H721.63v58.122H618.619v43.267h95.556v55.522h-95.556v53.666h105.993v61.65H557.084zm200.465 0h164.546v58.122H819.084v43.267h95.556v55.522h-95.556v53.666h105.993v61.65H757.549z"],["fill-rule","nonzero","d","M309.898 348.538h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm177.916-148.773H697.7q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85-7.993-11.426-30.058-11.426h-22.413v77.838Z"],["fill-rule","nonzero","d","M309.898 348.538h130.831q42.741 0 64.026 27.85t21.284 79.266q0 52.844-23.195 82.599t-70.802 29.755h-43.089V697.5h-79.055zm79.055 148.773h19.286q22.76 0 31.969-10.831t9.209-27.731q0-16.425-7.992-27.85t-30.058-11.426h-22.413v77.838Zm179.306-148.773h116.932q34.575 0 55.86 12.854t35.184 36.896 20.155 55.939 6.255 67.603q0 55.938-9.295 86.765t-25.801 51.654-35.444 27.731q-25.888 9.521-46.912 9.521H568.261V348.539Zm78.707 79.028v190.668h19.286q24.672 0 35.097-7.498t16.332-26.184 5.907-60.58q0-55.462-13.205-75.934-13.205-20.47-43.784-20.471h-19.633Z"],["fill-rule","nonzero","transform","scale(4.5) translate(30 90)","d","M0 .003h25.679l9.912 38.43L45.46.003h25.59v63.16H55.109V14.997L42.746 63.163H28.311L15.987 14.997v48.166H0zM84.28.003h19.56v63.168H84.28zM113.408.003h59.329V15.6H152.83v47.563h-19.516V15.6h-19.906z"]],template:function(t,n){if(t&1&&(B(0,"a",0),ge("click",function(a){return n.clickExternalHref(a)}),Y(),B(1,"svg",1),de(2,"path",2),T(3,so,1,0,":svg:path",3)(4,lo,1,0,":svg:path",4)(5,co,1,0,":svg:path",5)(6,po,1,0,":svg:path",6)(7,go,1,0,":svg:path",7)(8,mo,1,0,":svg:path",8),D()()),t&2){let r;ot("href",n.link(),tt)("title",n.licenses[n.licenseKey()]||"?"),l(3),L((r=n.licenseKey())==="cca"?3:r==="gpl"?4:r==="free"?5:r==="per"?6:r==="pub"?7:r==="mit"?8:-1)}},styles:["[_nghost-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;object-fit:contain;vertical-align:middle}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{margin-left:3px;line-height:30px;font-size:.8em}"]})}}return i})();function ho(i,o){if(i&1&&(p(0,"div",14)(1,"div"),S(2,"app-tile",15),m(),S(3,"div",16),h(4,"translate"),m()),i&2){let e=o.$implicit,t=o.$index,n=C(3);l(2),O("tile",e)("imageSet",n.tileset)("kyodaiUrl",n.kyodaiUrl)("index",t)("isDark",n.isDark),l(),O("innerHTML",u(4,6,e),Pn)}}function uo(i,o){if(i&1&&(p(0,"div")(1,"div",13),f(2),h(3,"translate"),m(),p(4,"div"),N(5,ho,5,8,"div",14,U),m()()),i&2){let e=o.$implicit;Me(te("tiles-section tiles-section-",e.tiles.length)),l(2),M(u(3,7,e.name)),l(2),Me(te("tiles-set tiles-set-",e.tiles.length)),l(),j(e.tiles)}}function _o(i,o){if(i&1&&N(0,uo,7,9,"div",12,U),i&2){let e=o.$implicit;j(e.groups)}}function fo(i,o){if(i&1&&S(0,"app-license-link",4),i&2){let e=C();O("link",te("https://github.com/ffalt/mah/blob/main/src/assets/svg/README.md#",e.selectedSet.id,"svg"))("licenseKey",e.selectedSet.license)}}function Co(i,o){if(i&1&&(p(0,"option",6),f(1),m()),i&2){let e=o.$implicit,t=C();O("value",e.id)("selected",t.tileset===e.id),l(),M(e.name)}}function Mo(i,o){if(i&1&&(p(0,"option",7),f(1),h(2,"translate"),m()),i&2){let e=C();O("selected",e.tileset==="kyodai"),l(),M(u(2,2,"KYODAI_TILESET"))}}var li=(()=>{class i{get selectedSet(){return this.sets.find(e=>e.id===this.tileset)}applyTileset(){this.app.settings.tileset=this.tileset,this.app.settings.dark=this.isDark,this.app.settings.save()}constructor(){this.TILES_INFOS=zn,this.sets=dt,this.tileset=Ve,this.isDark=!1,this.canKyodai=Q.kyodai,this.app=k(he),this.clickExternalHref=Ue,this.tileset=this.app.settings.tileset,this.isDark=this.app.settings.dark,this.kyodaiUrl=this.app.settings.kyodaiUrl}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-tiles-info"]],decls:23,vars:17,consts:[[1,"tiles-content"],[1,"tiles-footer"],[1,"tiles-form"],[1,"tiles-select"],[3,"link","licenseKey"],[3,"change"],[3,"value","selected"],["value","kyodai",3,"selected"],["type","checkbox",3,"change","checked"],["type","button",3,"click","disabled"],[1,"tiles-reference"],["rel","noopener","target","_blank",3,"click","href"],[3,"class"],[1,"tiles-title"],[1,"tile"],[3,"tile","imageSet","kyodaiUrl","index","isDark"],[3,"innerHTML"]],template:function(t,n){t&1&&(p(0,"div",0),N(1,_o,2,0,null,null,U),m(),p(3,"div",1)(4,"form",2)(5,"div",3),T(6,fo,1,3,"app-license-link",4),p(7,"select",5),b("change",function(a){return n.tileset=a.target.value}),N(8,Co,2,3,"option",6,U),T(10,Mo,3,4,"option",7),m()(),p(11,"label")(12,"input",8),b("change",function(){return n.isDark=!n.isDark}),m(),f(13),h(14,"translate"),m(),p(15,"button",9),b("click",function(){return n.applyTileset()}),f(16),h(17,"translate"),m()(),p(18,"div",10)(19,"a",11),h(20,"translate"),b("click",function(a){return n.clickExternalHref(a)}),f(21),h(22,"translate"),m()()()),t&2&&(l(),j(n.TILES_INFOS),l(5),L(n.selectedSet?6:-1),l(2),j(n.sets),l(2),L(n.canKyodai&&n.kyodaiUrl?10:-1),l(2),O("checked",n.isDark),l(),M(u(14,9,"TILES_DARK")),l(2),O("disabled",!n.selectedSet||n.selectedSet.id===n.app.settings.tileset&&n.isDark===n.app.settings.dark),l(),K("",u(17,11,"USE_NOW")," "),l(3),O("href",G(u(20,13,"READ_MORE_WIKIPEDIA_URL")),tt),l(2),M(u(22,15,"READ_MORE_WIKIPEDIA")))},dependencies:[si,Pt,Z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden;height:100%}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;color:var(--dialog-text-color);margin-top:0;margin-bottom:.2em;line-height:1em}@media only screen and (max-width:400px){[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2em}}[_nghost-%COMP%]   .tiles-content[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;flex:1;border:1px solid var(--card-layout-color-border);border-radius:4px;overflow-y:auto}[_nghost-%COMP%]   .tile[_ngcontent-%COMP%]{flex:1;text-align:center;word-break:normal;margin-top:5px;margin-bottom:5px;display:flex;flex-direction:column;padding-left:5px;padding-right:5px}[_nghost-%COMP%]   .tile[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;font-size:.9em}[_nghost-%COMP%]   .tiles-title[_ngcontent-%COMP%]{flex:1;margin-top:.5em;margin-bottom:.2em;font-weight:700;text-align:center;letter-spacing:2px;border-bottom:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .tiles-section[_ngcontent-%COMP%]{padding:0 6px}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]{flex:50%}[_nghost-%COMP%]   .tiles-set[_ngcontent-%COMP%]{display:flex;justify-content:space-around}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:20%}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]{flex:100%}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:50%}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:33%}}@media only screen and (max-width:280px){[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]{flex-wrap:wrap}[_nghost-%COMP%]   .tiles-section-9[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-5[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-4[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .tiles-section-3[_ngcontent-%COMP%]   .tiles-set[_ngcontent-%COMP%]   .tile[_ngcontent-%COMP%]{flex:50%}}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]{padding-top:8px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center;gap:8px;width:100%;margin-bottom:8px}@media only screen and (max-width:500px){[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]{justify-content:space-around}}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   .tiles-select[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:center;gap:8px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;height:100%;flex:1}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .tiles-footer[_ngcontent-%COMP%]   .tiles-reference[_ngcontent-%COMP%]{text-align:center}"]})}}return i})();function ci(){let i={adjointed:["circles","diamonds"],african:[[1,5]],batik:[[1,7]],blobs:[],"brick-wall":[[1,2]],"candy-cane":[1],chainlink:[[1,3]],checkerboard:[],chevron:[1,2,3,4,5,7,8,11,13,14,15],chinese:[[1,14]],"christmas-bells":[1],"christmas-gift":[],"christmas-pattern":[[1,7]],"christmas-tree":[1,"balls"],circles:[[1,17],19,20,22,"and-diamonds"],"concentric-circles":[[1,6]],"cross-section":[],cubes:[[1,6]],diamonds:[[1,15],17,18,19,20,21],doodle:[[1,2]],"double-bubble":[[1,4]],egyptian:[1,2,3,4,6,8,9,10,12],"ethnic-pattern":[[1,3]],eyes:[[1,4]],flower:[[1,7]],geometric:[[1,10]],"greek-key":[],halloween:[[1,7]],hearts:[3,5,9],herringbone:[[1,8]],hexagon:[[1,11],13],"interlocked-hexagons":[[1,4]],"inverted-triangles":[],"japanese-pattern":[1,2,3,4,5,6,7,8,12],jigsaw:[],lanterns:[1],leaves:[[1,10]],lines:[1,2,3,4,5,6,8],memphis:[1,2,3,4,5,6,10],"mexican-pattern":[[1,2]],moroccan:[[1,2]],new:[[1,17]],octagons:[[1,2]],"overlapping-hexagons":[],patches:[],pipes:[],"plaid-pattern":[[1,6]],plus:[[1,6]],"quarter-circles":[[1,2]],railroad:[],"rectangles-and-squares":[1],rope:[1],"santa-claus":[],scales:[[1,9]],semicircles:[1],snowflakes:[1],songket:[1],sprinkles:[1],squares:[[1,9]],"squares-and-plus":[1,2],"squares-and-squares":[1,2],"squares-and-triangles":[1,2],"squares-and-stars":[1,2],"squares-and-diamonds":[],"squares-and-diamonds-2":[],"squares-and-circles":[[1,3]],squiggle:[1],"stained-glass":[],stars:[[1,8]],"stars-and-lines":[1,2],"straight-lines":[],stripes:[[1,2]],terrazzo:[1],tiles:[[1,3]],triangles:[[1,25],27,28],tribal:[[1,5]],waves:[[1,20],22,24],zebra:[]},o=[];for(let[e,t]of Object.entries(i)){t.length===0&&o.push({id:e});for(let n of t)if(Array.isArray(n)){let[r,a]=n;for(let s=r;s<=a;s++)o.push({id:`${e}-${s}`})}else o.push({id:`${e}-${n}`})}return o.map(e=>({id:e.id,title:e.id.split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join(" ")}))}function Po(i){let o=i.replace(/\s+/g," ").replace(/>\s+</g,"><").trim();return encodeURIComponent(o)}function Oo(i,o,e,t,n,r,a,s,c,d,g,_,P,E,w){let V="";r==="stroke-join"&&(V=P==2?"stroke-linejoin='round' stroke-linecap='round' ":"stroke-linecap='square' ");function I(W){let xe=a[W+1];t===0&&n>2&&(s===3&&n===4&&W===2||s===4&&n===5&&W===3||s===3&&n===5&&W===3||s===3&&n===5&&W===2||s===2)&&(xe=a[1]);let J;r==="stroke-join"?J=` stroke='${xe}' fill='none'`:r==="stroke"?J=` stroke='${xe}' fill='none'`:J=` stroke='none' fill='${xe}'`;let ue=g[0]/2===0?"":` transform='translate(${g[0]/2},${t})'`;return`<path d='${i[W]}' stroke-width='${c}'${J} ${ue}${V}/>`}let F=[],X=Math.min(i.length,t===0&&n>2?n-1:s);for(let W=0;W<X;W++)F.push(I(W));return["<svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg'>","<defs>",`<pattern id='a' patternUnits='userSpaceOnUse' width='${o+g[0]}' height='${e-t*(n-s)+g[1]}' patternTransform='scale(${d}) rotate(${_})'>`,...F,"</pattern></defs>",`<rect width='800%' height='800%' transform='translate(${d*E},${d*w})' fill='url(#a)'/>`,"</svg>"].join("")}var di=(()=>{class i{constructor(){this.http=k(Ie),this.cache={}}get(e){return ce(this,null,function*(){let t=this.cache[e];if(t){if(t.data)return t.data;if(t.request!==void 0)return t.request}t={};let n=new Promise((r,a)=>{setTimeout(()=>{this.http.get(`assets/patterns/${e}.json`,{responseType:"text"}).subscribe({next:s=>{t.data=s,t.request=void 0,r(s)},error:s=>{a(s)}})})});return t.request=n,this.cache[e]=t,n})}svgDataUrl(e,t){return ce(this,null,function*(){let n=yield this.get(e);return`url("data:image/svg+xml;utf8,${this.svgBackground(n,t)}")`})}svgBackground(e,t){let n=JSON.parse(e),r=Oo(n.path,n.width,n.height,n.vHeight??0,n.path.length+1,n.mode,["",...t],t.length+1,1,1,n.spacing??[0,0],0,1,0,0);return Po(r)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Oe({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var bo=["kyodaiInput"],pi=(i,o)=>o.id,vo=(i,o)=>o.source;function xo(i,o){if(i&1){let e=A();p(0,"input",29),b("change",function(){let n=x(e).$implicit,r=C();return y(r.setSelectedTab(n.id))}),m()}if(i&2){let e=o.$implicit,t=C();O("id",`tab-${e.id}`)("checked",t.selectedTab===e.id)}}function yo(i,o){if(i&1&&(p(0,"label",3),f(1),h(2,"translate"),m()),i&2){let e=o.$implicit;O("id",`tab-${e.id}-label`)("for",`tab-${e.id}`),l(),M(u(2,3,e.name))}}function wo(i,o){if(i&1){let e=A();p(0,"li")(1,"input",30),b("change",function(){let n=x(e).$implicit,r=C();return r.app.settings.lang=n.key,y(r.app.setLang())}),m(),p(2,"label",31),f(3),m()()}if(i&2){let e=o.$implicit,t=o.$index,n=C();l(),O("id","lang"+(t+1))("value",e.key)("checked",n.app.settings.lang===e.key),ne("aria-label",e.title),l(),O("for","lang"+(t+1)),l(),M(e.title)}}function ko(i,o){if(i&1){let e=A();p(0,"li")(1,"input",32),b("change",function(){let n=x(e).$implicit,r=C();return r.app.settings.tileset=n.id,y(r.app.settings.save())}),m(),p(2,"label",31),f(3),m(),S(4,"app-license-link",33),m()}if(i&2){let e=o.$implicit,t=o.$index,n=C();l(),O("id",te("imageset",t))("value",e.id)("checked",n.app.settings.tileset===e.id),ne("aria-label",e.name),l(),O("for",te("imageset",t)),l(),K(" ",e.name," "),l(),O("link",te("https://github.com/ffalt/mah/blob/main/src/assets/svg/README.md#",e.id,"svg"))("licenseKey",e.license)}}function So(i,o){if(i&1){let e=A();p(0,"li")(1,"input",34),h(2,"translate"),b("change",function(){x(e);let n=C();return n.app.settings.tileset="kyodai",y(n.app.settings.save())}),m(),p(3,"label",35),f(4),h(5,"translate"),m()()}if(i&2){let e=C();l(),O("checked",e.app.settings.tileset==="kyodai"),ne("aria-label",u(2,3,"KYODAI_TILESET")),l(3),M(u(5,5,"KYODAI_TILESET"))}}function Eo(i,o){if(i&1&&(p(0,"option",45),f(1),m()),i&2){let e=o.$implicit;O("value",e.source),l(),Ye("",e.name," - ",e.author)}}function To(i,o){if(i&1){let e=A();p(0,"fieldset",13)(1,"legend",36),f(2),h(3,"translate"),m(),p(4,"div",37)(5,"textarea",38,0),h(7,"translate"),b("change",function(n){x(e);let r=C();return y(r.updateKyodaiUrl(n))}),m(),p(8,"button",39),h(9,"translate"),h(10,"translate"),b("click",function(){x(e);let n=C();return y(n.clearKyodaiUrl())}),Y(),p(11,"svg",40),S(12,"path",41)(13,"path",42),m()(),Ke(),p(14,"select",43),h(15,"translate"),b("change",function(n){x(e);let r=C();return y(r.setKyodaiUrl(n))}),p(16,"option",44),f(17),h(18,"translate"),m(),N(19,Eo,2,3,"option",45,vo),m()(),p(21,"button",46),h(22,"translate"),b("click",function(){x(e);let n=C();return y(n.applyKyodaiUrl())}),f(23),h(24,"translate"),m()()}if(i&2){let e=C();l(2),M(u(3,14,"KYODAI_TILESET_SETTINGS")),l(3),O("placeholder",G(u(7,16,"KYODAI_TILESET_URL_PLACEHOLDER")))("value",e.app.settings.kyodaiUrl?e.app.settings.kyodaiUrl:""),l(3),O("title",G(u(9,18,"KYODAI_TILESET_CLEAR"))),Re("aria-label",G(u(10,20,"KYODAI_TILESET_CLEAR"))),l(6),Re("aria-label",G(u(15,22,"KYODAI_TILESET_EXAMPLES"))),l(3),M(u(18,24,"KYODAI_TILESET_EXAMPLES")),l(2),j(e.kyodaiTileSets),l(2),Re("aria-label",G(u(22,26,"KYODAI_TILESET_LOAD"))),l(2),K(" ",u(24,28,"KYODAI_TILESET_LOAD")," ")}}function Lo(i,o){if(i&1){let e=A();p(0,"li")(1,"input",47),h(2,"translate"),b("change",function(){let n=x(e).$implicit,r=C();return r.app.settings.theme=n.id||"",y(r.app.settings.save())}),m(),p(3,"label",31),f(4),h(5,"translate"),m(),p(6,"div",48),S(7,"div",49),m()()}if(i&2){let e=o.$implicit,t=o.$index,n=C();l(),O("id",te("color",t))("value",e.id)("checked",n.app.settings.theme===e.id),ne("aria-label",u(2,10,e.name)),l(2),O("for",te("color",t)),l(),M(u(5,12,e.name)),l(3),Me("theme-"+e.id)}}function Io(i,o){if(i&1&&S(0,"app-license-link",51),i&2){let e=C(2).$implicit;O("licenseKey",e.license)}}function Bo(i,o){if(i&1&&S(0,"app-license-link",33),i&2){let e=C(2).$implicit;O("link",te("https://github.com/ffalt/mah/blob/main/src/assets/img/README.md#",e.img,"jpg"))("licenseKey",e.license)}}function Do(i,o){if(i&1&&T(0,Io,1,1,"app-license-link",51)(1,Bo,1,3,"app-license-link",33),i&2){let e=C().$implicit;L(e.type==="MAH"?0:1)}}function Ao(i,o){if(i&1){let e=A();p(0,"li")(1,"input",50),h(2,"translate"),b("change",function(){let n=x(e).$implicit,r=C();return y(r.setBackground(n.img))}),m(),p(3,"label",31),f(4),h(5,"translate"),m(),T(6,Do,2,1),m()}if(i&2){let e=o.$implicit,t=o.$index,n=C();l(),O("id",te("back",t))("value",e.img)("checked",n.app.settings.background===e.img),ne("aria-label",u(2,9,e.name)),l(2),O("for",te("back",t)),l(),M(u(5,11,e.name)),l(2),L(e.license?6:-1)}}function Ro(i,o){if(i&1){let e=A();p(0,"li")(1,"input",54),b("change",function(){let n=x(e).$implicit,r=C(2);return r.app.settings.pattern=n.id,y(r.app.settings.save())}),m(),p(2,"label",31),f(3),m()()}if(i&2){let e=o.$implicit,t=o.$index,n=C(2);l(),O("id",te("pattern",t))("value",e.id)("checked",n.app.settings.pattern===e.id),ne("aria-label",e.title),l(),O("for",te("pattern",t)),l(),M(e.title)}}function Vo(i,o){if(i&1&&(p(0,"fieldset",24)(1,"legend",52),f(2),h(3,"translate"),m(),p(4,"ul",53),N(5,Ro,4,8,"li",null,U),m()()),i&2){let e=C();l(2),M(u(3,1,"PATTERN_SETTINGS")),l(3),j(e.patterns)}}var gi=[{id:"lang",name:"LANG"},{id:"stones",name:"TILESET"},{id:"theme",name:"THEME"},{id:"background",name:"BACKGROUND"},{id:"data",name:"DATA"}],mi=(()=>{class i{constructor(){this.kyodaiInput=_e.required("kyodaiInput"),this.canKyodai=Q.kyodai,this.kyodaiTileSets=ii,this.sets=dt,this.backs=ct,this.themes=qe,this.PatternBackground=$n,this.languages=Object.keys(Xe).map(e=>({key:e,title:Xe[e]})),this.app=k(he),this.tabs=gi,this.patterns=ci(),this.selectedTab=this.app.getCachedValue("settings.selectedTab")??gi[0].id,this.element=k(be),this.storage=k(De),this.layoutService=k(Pe),this.translate=k(Be)}ngAfterViewInit(){this.element?.nativeElement&&this.restoreScroll(this.element.nativeElement)}setBackground(e){this.app.settings.background=e,this.app.settings.save()}updateKyodaiUrl(e){this.app.settings.kyodaiUrl=e.target.value,this.app.settings.save()}clearKyodaiUrl(){this.app.settings.kyodaiUrl=void 0,this.app.settings.tileset=Ve,this.app.settings.save()}setKyodaiUrl(e){let t=this.kyodaiInput();t.nativeElement&&(e.preventDefault(),e.stopPropagation(),t.nativeElement.value=e.target.value)}applyKyodaiUrl(){let e=this.kyodaiInput();e.nativeElement&&(this.app.settings.kyodaiUrl=e.nativeElement.value,this.app.settings.save())}setSelectedTab(e){this.selectedTab=e,this.app.cacheValue("settings.selectedTab",e)}restoreScroll(e){if(!e)return;let t=this.app.getCachedValue("settings.scrollTop");setTimeout(()=>e.scrollTop=t??0,0)}onScroll(e){let t=e.target.scrollTop;this.app.cacheValue("settings.scrollTop",t)}clearTimes(){return ce(this,null,function*(){let e=yield this.layoutService.get();for(let t of e.items)this.storage.clearScore(t.id)})}clearTimesClick(){confirm(this.translate.instant("BEST_TIMES_CLEAR_SURE"))&&this.clearTimes().catch(e=>console.error(e))}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-settings"]],viewQuery:function(t,n){t&1&&Te(n.kyodaiInput,bo,5),t&2&&Le()},hostBindings:function(t,n){t&1&&b("scroll",function(a){return n.onScroll(a)})},decls:76,vars:51,consts:[["kyodaiInput",""],["type","radio","name","settings-tab",1,"tabs-input",3,"id","checked"],["role","tablist","aria-label","Settings Tabs",1,"tabs-labels"],["role","tab",3,"id","for"],[1,"tabs-panels","panels"],["id","panel-lang","role","tabpanel","aria-labelledby","tab-lang-label",1,"panel"],["id","lang-legend"],["role","group","aria-labelledby","lang-legend",1,"radio","radio-lang"],["type","radio","name","lang","id","lang0","value","auto",3,"change","checked"],["for","lang0"],["id","panel-stones","role","tabpanel","aria-labelledby","tab-stones-label",1,"panel"],["id","tileset-legend"],["role","group","aria-labelledby","tileset-legend",1,"radio","radio-tilesets"],[1,"kyodai-settings"],["id","tiles-legend"],["role","group","aria-labelledby","tiles-legend",1,"checks"],[1,"check"],["type","checkbox",3,"change","checked","aria-label"],["id","panel-theme","role","tabpanel","aria-labelledby","tab-theme-label",1,"panel"],["id","theme-legend"],["role","group","aria-labelledby","theme-legend",1,"radio","radio-themes"],["id","panel-background","role","tabpanel","aria-labelledby","tab-background-label",1,"panel"],["id","background-legend"],["role","group","aria-labelledby","background-legend",1,"radio"],[1,"pattern-settings"],["id","panel-data","role","tabpanel","aria-labelledby","tab-data-label",1,"panel"],["id","times-legend"],[1,"button-group"],[1,"clear-times",3,"click","aria-label"],["type","radio","name","settings-tab",1,"tabs-input",3,"change","id","checked"],["type","radio","name","lang",3,"change","id","value","checked"],[3,"for"],["type","radio","name","imageset",3,"change","id","value","checked"],[3,"link","licenseKey"],["type","radio","name","imageset","value","kyodai","id","imageset-kyodai",3,"change","checked"],["for","imageset-kyodai"],["id","kyodai-legend"],[1,"input-wrapper"],["type","text","name","kyodai","aria-labelledby","kyodai-legend","aria-describedby","kyodai-help",3,"change","value","placeholder"],[1,"clear-kyodai",3,"click","title","aria-label"],["width","17px","height","17px","viewBox","0 0 35 35","aria-hidden","true"],["d","M28.814,30.064a1.247,1.247,0,0,1-.884-.367L5.3,7.07A1.249,1.249,0,0,1,7.07,5.3L29.7,27.93a1.251,1.251,0,0,1-.884,2.134Z"],["d","M6.186,30.064A1.251,1.251,0,0,1,5.3,27.93L27.93,5.3A1.25,1.25,0,0,1,29.7,7.07L7.07,29.7A1.247,1.247,0,0,1,6.186,30.064Z"],[1,"example-kyodai",3,"change","aria-label"],["value",""],[3,"value"],[3,"click","aria-label"],["type","radio","name","color",3,"change","id","value","checked"],[1,"theme-preview-wrapper"],[1,"theme-preview"],["type","radio","name","back",3,"change","id","value","checked"],["link","https://github.com/ffalt/mah/blob/main/src/assets/patterns/README.md",3,"licenseKey"],["id","pattern-legend"],["role","group","aria-labelledby","pattern-legend",1,"radio","radio-patterns"],["type","radio","name","pattern",3,"change","id","value","checked"]],template:function(t,n){t&1&&(N(0,xo,1,2,"input",1,pi),p(2,"div",2),N(3,yo,3,5,"label",3,pi),m(),p(5,"div",4)(6,"section",5)(7,"fieldset")(8,"legend",6),f(9),h(10,"translate"),m(),p(11,"ul",7)(12,"li")(13,"input",8),h(14,"translate"),b("change",function(){return n.app.settings.lang="auto",n.app.setLang()}),m(),p(15,"label",9),f(16),h(17,"translate"),m()(),N(18,wo,4,6,"li",null,U),m()()(),p(20,"section",10)(21,"fieldset")(22,"legend",11),f(23),h(24,"translate"),m(),p(25,"ul",12),N(26,ko,5,11,"li",null,U),T(28,So,6,7,"li"),m()(),T(29,To,25,30,"fieldset",13),p(30,"fieldset")(31,"legend",14),f(32),h(33,"translate"),m(),p(34,"ul",15)(35,"li")(36,"label",16)(37,"input",17),h(38,"translate"),b("change",function(){return n.app.settings.contrast=!n.app.settings.contrast,n.app.settings.save()}),m(),p(39,"span"),f(40),h(41,"translate"),m()()(),p(42,"li")(43,"label",16)(44,"input",17),h(45,"translate"),b("change",function(){return n.app.settings.dark=!n.app.settings.dark,n.app.settings.save()}),m(),p(46,"span"),f(47),h(48,"translate"),m()()()()()(),p(49,"section",18)(50,"fieldset")(51,"legend",19),f(52),h(53,"translate"),m(),p(54,"ul",20),N(55,Lo,8,14,"li",null,U),m()()(),p(57,"section",21)(58,"fieldset")(59,"legend",22),f(60),h(61,"translate"),m(),p(62,"ul",23),N(63,Ao,7,13,"li",null,U),m()(),T(65,Vo,7,3,"fieldset",24),m(),p(66,"section",25)(67,"fieldset")(68,"legend",26),f(69),h(70,"translate"),m(),p(71,"div",27)(72,"button",28),h(73,"translate"),b("click",function(){return n.clearTimesClick()}),f(74),h(75,"translate"),m()()()()()),t&2&&(j(n.tabs),l(3),j(n.tabs),l(6),M(u(10,23,"LANG")),l(4),O("checked",n.app.settings.lang==="auto"),ne("aria-label",u(14,25,"LANG_AUTO")),l(3),M(u(17,27,"LANG_AUTO")),l(2),j(n.languages),l(5),M(u(24,29,"TILESET")),l(3),j(n.sets),l(2),L(n.canKyodai?28:-1),l(),L(n.canKyodai&&n.app.settings.tileset==="kyodai"?29:-1),l(3),M(u(33,31,"TILES")),l(5),Re("aria-label",G(u(38,33,"HIGHER_CONTRAST"))),O("checked",n.app.settings.contrast),l(3),M(u(41,35,"HIGHER_CONTRAST")),l(4),Re("aria-label",G(u(45,37,"TILES_DARK"))),O("checked",n.app.settings.dark),l(3),M(u(48,39,"TILES_DARK")),l(5),M(u(53,41,"THEME")),l(3),j(n.themes),l(5),M(u(61,43,"BACKGROUND")),l(3),j(n.backs),l(2),L(n.app.settings.background===n.PatternBackground?65:-1),l(4),M(u(70,45,"BEST_TIMES")),l(3),Re("aria-label",G(u(73,47,"BEST_TIMES_CLEAR"))),l(2),K(" ",u(75,49,"BEST_TIMES_CLEAR")," "))},dependencies:[Pt,Z],styles:['[_nghost-%COMP%]{flex:1;overflow-y:auto;width:100%;height:100%;display:flex;flex-direction:column;position:relative}@media only screen and (max-width:1000px){[_nghost-%COMP%]{gap:8px;padding:4px}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{border:1px solid var(--main-bg-color-lt);border-radius:8px;padding:12px;margin:0;background-color:var(--dialog-background-color);transition:all .2s ease}@media only screen and (max-width:700px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]{padding:10px}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{padding:0 8px;font-weight:600;color:var(--primary-text-colddor);margin-left:-4px;font-size:.95em;display:none}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:0;display:flex;gap:6px;height:40px;min-height:40px;line-height:40px;align-items:center;border-radius:6px;transition:background-color .15s ease;box-sizing:border-box;break-inside:avoid;flex:1}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:focus-within{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{columns:2;text-align:left;list-style:none;padding:0;margin:0;vertical-align:text-bottom}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{vertical-align:middle;line-height:1.2;-webkit-user-select:none;user-select:none;white-space:normal;text-overflow:ellipsis;cursor:pointer;flex:1;font-size:.95em;height:100%;display:flex;align-items:center}@media only screen and (max-width:400px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{-webkit-hyphens:auto;hyphens:auto;word-break:break-all}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex-shrink:0}@media only screen and (max-width:350px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]{list-style:none;padding:0 0 0 13px;margin:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-left:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:8px;padding:8px;margin:-8px;border-radius:6px;transition:background-color .15s ease;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:focus-within{background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{padding:2px;display:flex;align-items:center;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;flex-shrink:0}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .checks[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95em}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]{background-color:var(--dialog-background-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;position:relative;border:1px solid var(--input-border-color);background-color:var(--input-background-color);border-radius:6px;margin:8px 0;overflow:hidden;transition:border-color .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;border:none;resize:none;outline:none;font-size:10px;background-color:var(--input-background-color);color:var(--input-text-color);padding:10px;font-family:monospace;line-height:1.4}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus-visible{outline:none}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]:after{position:absolute;content:"";right:18px;top:calc(50% - 4px);width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:10px solid var(--input-text-color);pointer-events:none}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]{background-image:unset;background-color:var(--input-background-color);color:var(--input-background-color);border:1px solid var(--input-border-color);border-left:1px solid var(--input-border-color);width:44px;padding:0;display:flex;align-items:center;justify-content:center;appearance:none;cursor:pointer}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .example-kyodai[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]{background-color:var(--input-background-color);color:var(--input-text-color);border:1px solid var(--input-border-color);border-left:1px solid var(--input-border-color);width:44px;padding:0;margin-left:-1px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--input-text-color);transition:fill .2s ease}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:hover{background-color:var(--input-background-color-hover);border-color:var(--dialog-headline-color)}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-text-color);outline-offset:-2px}[_nghost-%COMP%]   fieldset.kyodai-settings[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .clear-kyodai[_ngcontent-%COMP%]:active{background-color:var(--dialog-background-color)}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-lang[_ngcontent-%COMP%]{columns:3}@media only screen and (max-width:700px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-lang[_ngcontent-%COMP%]{columns:2}}@media only screen and (max-width:500px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-lang[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]{columns:2}@media only screen and (max-width:500px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{flex-wrap:nowrap;align-items:center;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-tilesets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   app-license-link[_ngcontent-%COMP%]{margin-left:auto;flex-shrink:0}@media only screen and (max-width:500px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview-wrapper[_ngcontent-%COMP%]{display:block;border:1px solid #000}@media(prefers-color-scheme:dark){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview-wrapper[_ngcontent-%COMP%]{border-color:#6e6e6e}}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-themes[_ngcontent-%COMP%]   .theme-preview[_ngcontent-%COMP%]{background-color:var(--main-bg-color);display:block;width:20px;height:20px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:3}@media only screen and (max-width:700px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:2}}@media only screen and (max-width:400px){[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   .radio-patterns[_ngcontent-%COMP%]{columns:1}}[_nghost-%COMP%]   .tabs-input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:1px;height:1px;margin:-1px;padding:0;border:0;overflow:hidden;white-space:nowrap}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;justify-content:center;margin-top:2px;margin-bottom:16px;padding-bottom:8px}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]{background:transparent;color:var(--input-text-color);padding:8px 0;border-radius:0;border:none;border-bottom:2px solid transparent;font-weight:600;cursor:pointer;min-width:auto;text-align:center;position:relative;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:focus-visible{color:var(--dialog-headline-color);outline:none;border-bottom-color:var(--gesture-indicator)}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.35}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]   label[role=tab][_ngcontent-%COMP%]:hover:not(:disabled){color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color);opacity:.9}[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{flex:1;padding-right:8px}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{background:var(--dialog-background-color);display:none;width:100%;height:100%;flex-direction:column;justify-content:center;gap:8px}[_nghost-%COMP%]   #lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]{color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color);font-weight:700}[_nghost-%COMP%]   #lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]:hover{color:var(--text-highlight-color);border-bottom-color:var(--text-highlight-color)}@media(prefers-color-scheme:dark){[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{border-bottom-color:var(--input-border-color)}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]{color:var(--dialog-headline-color);border-bottom-color:var(--dialog-headline-color)}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-lang][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-stones][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-theme][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-background][_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-labels[_ngcontent-%COMP%]   label[for=tab-data][_ngcontent-%COMP%]:hover{color:var(--main-text-color);border-bottom-color:var(--main-text-color)}}[_nghost-%COMP%]   #tab-lang[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-lang[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-background[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-background[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-stones[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-stones[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-theme[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-theme[_ngcontent-%COMP%], [_nghost-%COMP%]   #tab-data[_ngcontent-%COMP%]:checked ~ .tabs-panels[_ngcontent-%COMP%]   #panel-data[_ngcontent-%COMP%]{display:flex}@media only screen and (max-height:400px){[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .tabs-panels[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}[_nghost-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .panel[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .tabs-labels[_ngcontent-%COMP%]{display:none}}']})}}return i})();function qt(i){return(i<10?"0":"")+i.toString()}var Ot=(()=>{class i{transform(e){if(Number.isNaN(e)||e===0)return"-";let t=Math.floor(e/1e3),n=Math.floor(t/3600),r=Math.floor((t-n*3600)/60),a=t-n*3600-r*60;return`${n>0?`${qt(n)}:`:""}${qt(r)}:${qt(a)}`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ye({name:"duration",type:i,pure:!0})}}return i})();var we=class i{static{this.empty=new i(0,0,0,0)}constructor(o,e,t,n){this.left=o,this.top=e,this.right=t,this.bottom=n}static fromElement(o){let{left:e,top:t,right:n,bottom:r}=o.getBoundingClientRect();return new i(e,t,n,r)}static fromWindow(o){return new i(0,0,o.innerWidth,o.innerHeight)}inflate(o){this.left-=o,this.top-=o,this.right+=o,this.bottom+=o}intersectsWith(o){return o.left<this.right&&this.left<o.right&&o.top<this.bottom&&this.top<o.bottom}intersectsWithY(o){return o.top<this.bottom&&this.top<o.bottom}getIntersectionWith(o){let e=Math.max(this.left,o.left),t=Math.max(this.top,o.top),n=Math.min(this.right,o.right),r=Math.min(this.bottom,o.bottom);return n>=e&&r>=t?new i(e,t,n,r):i.empty}};var ze=(()=>{class i{constructor(){this.scrollNotify=new Vt,this.observeNotify=new Vt,this.currentViewport=new we(0,0,0,0),this.scrollSubject=new pn,this.platformId=k(Mn),this.isBrowser=En(this.platformId),this.hasIntersectionObserver=i.checkIntersectionObserver();let e=this.scrollSubject.asObservable();this.scrollObservable=gn(e.pipe(hn(300)),e.pipe(mn(100))),this.scrollObservable.subscribe(t=>{this.scrollNotify.emit(t)}),this.currentViewport=we.fromWindow(window)}getObserver(){return this.intersectionObserver?this.intersectionObserver:(this.intersectionObserver=new IntersectionObserver(e=>{this.observeNotify.next(e)},{threshold:0}),this.intersectionObserver)}notifyScroll(e){if(this.hasIntersectionObserver)return;let t=e.element?we.fromElement(e.element):we.fromWindow(window),n=t.bottom-t.top;t.bottom+=n,t.top-=n,this.currentViewport=t,this.scrollSubject.next({rect:t})}static checkIntersectionObserver(){let e="IntersectionObserver"in window,n=window.navigator.userAgent.match(/Edge\/(\d*)\./i),r=!!n&&n.length>1,a=r&&!!n&&Number.parseInt(n[1],10)>15;return e&&(!r||a)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=Oe({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var hi=(()=>{class i{constructor(){this.scrollTo=R(),this.element=k(be),this.scrollNotify=k(ze)}ngOnChanges(e){if(e.scrollTo?.currentValue){let t=e.scrollTo.currentValue;if(t.id&&t.id.length>0){let n=document.getElementById(t.id);n&&(this.element.nativeElement.scrollTop=n.offsetTop-n.offsetHeight)}}}scrollTrack(e){this.scrollNotify.notifyScroll({name:"scroll-host",element:this.element.nativeElement})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=it({type:i,selectors:[["","appDeferLoadScrollHost",""]],hostBindings:function(t,n){t&1&&b("scroll",function(a){return n.scrollTrack(a)})},inputs:{scrollTo:[1,"scrollTo"]},features:[Ee]})}}return i})();var ui=(()=>{class i{constructor(){this.preRender=R(!1),this.appDeferLoad=me(),this.timeoutLoadMS=20,this.elementRef=k(be),this.deferLoadService=k(ze)}ngAfterViewInit(){this.deferLoadService.isBrowser?this.deferLoadService.hasIntersectionObserver?this.registerIntersectionObserver():this.addScrollListeners():this.preRender()&&this.load()}ngOnDestroy(){this.removeListeners()}static getScrollPosition(){return window.scrollY+(document.documentElement.clientHeight||document.body.clientHeight)}loadAndUnobserve(){this.load(),this.unobserve(),this.removeListeners()}cancelDelayLoad(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}delayLoad(){this.timeoutId||(this.timeoutId=setTimeout(()=>{this.loadAndUnobserve(),this.cancelDelayLoad()},this.timeoutLoadMS))}manageIntersection(e){this.checkIfIntersecting(e)?this.delayLoad():this.cancelDelayLoad()}registerIntersectionObserver(){this.intersectionObserver||(this.intersectionObserver=this.deferLoadService.getObserver(),this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.observe(this.elementRef.nativeElement),this.observeSubscription=this.deferLoadService.observeNotify.subscribe(e=>{this.checkForIntersection(e)})))}checkForIntersection(e){for(let t of e)t.target===this.elementRef.nativeElement&&this.manageIntersection(t)}checkIfIntersecting(e){return e?.time?e.isIntersecting:this.isVisible()}load(){this.removeListeners(),this.appDeferLoad.emit()}loadFromScroll(){setTimeout(()=>{this.load()})}addScrollListeners(){this.scrollSubscription=this.deferLoadService.scrollNotify.subscribe(e=>{this.checkInView(e.rect)&&this.loadFromScroll()}),setTimeout(()=>{this.checkInView(this.deferLoadService.currentViewport)&&this.loadFromScroll()})}unobserve(){this.intersectionObserver&&this.elementRef.nativeElement&&(this.intersectionObserver.unobserve(this.elementRef.nativeElement),this.intersectionObserver=void 0)}removeListeners(){this.scrollSubscription&&(this.scrollSubscription.unsubscribe(),this.scrollSubscription=void 0),this.unobserve(),this.observeSubscription&&(this.observeSubscription.unsubscribe(),this.observeSubscription=void 0)}checkInView(e){return we.fromElement(this.elementRef.nativeElement).intersectsWithY(e)}isVisible(){let e=i.getScrollPosition();return this.elementRef.nativeElement.offsetTop<=e}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=it({type:i,selectors:[["","appDeferLoad",""]],inputs:{preRender:[1,"preRender"]},outputs:{appDeferLoad:"appDeferLoad"}})}}return i})();function v(i,o,e){return`${i}|${o}|${e}`}function Ze(i,o){return Math.floor(Math.random()*(o-i+1))+i}function fe(i){return i[Math.floor(Math.random()*i.length)]}function H(i){for(let o=i.length-1;o>0;o--){let e=Math.floor(Math.random()*(o+1));[i[o],i[e]]=[i[e],i[o]]}return i}function q(i,o,e){return i>=0&&i<=36&&o>=0&&o<=16&&e>=0&&e<=5}function ae(i,o,e,t){return i.has(v(o,e-1,t-1))||i.has(v(o,e,t-1))||i.has(v(o,e+1,t-1))||i.has(v(o,e-1,t))||i.has(v(o,e+1,t))||i.has(v(o,e-1,t+1))||i.has(v(o,e,t+1))||i.has(v(o,e+1,t+1))}function bt(i,o,e,t){if(o===0)return!0;let n=o-1;return i.has(v(n,e,t))||i.has(v(n,e-1,t))&&i.has(v(n,e+1,t))?!0:i.has(v(n,e-1,t-1))&&i.has(v(n,e+1,t-1))&&i.has(v(n,e-1,t+1))&&i.has(v(n,e+1,t+1))}function Qe(i,o,e,t,n){if(!q(t,n,e))return!1;let r=v(e,t,n);return i.has(r)||!bt(i,e,t,n)||ae(i,e,t,n)?!1:(i.add(r),o.push([e,t,n]),!0)}function _i(i){return i%2!==0}function fi(){return fe(["lines","lines","lines","checker","checker","areas","areas","rings"])}function vt(i,o){let e=[];for(let t=0;t<=o;t+=2)for(let n=0;n<=i;n+=2)e.push([n,t]);return e}function xt(i,o,e,t=0){for(let[n,r]of i)for(let a=-o;a<=o;a++)for(let s=-o;s<=o;s++){let c=n+s,d=r+a;q(c,d,t)&&e.add(v(t,c,d))}}function ke(i,o,e,t=2){let n=[];for(let r=0;r<=e;r+=t)for(let a=0;a<=o;a+=t)i.has(v(0,a,r))&&n.push([0,a,r]);return n}function yt(i,o,e=1){let t=[];for(let r=0;r<=i;r+=e)t.push(r);let n=[];for(let r=0;r<=o;r+=e)n.push(r);return{xs:t,ys:n}}function Ae(i,o,e,t,n,r){let a=i;for(let[s,c]of o){if(a>=n)break;for(let[d,g]of e){if(a>=n)break;let _=r(d,g,s,c);if(_>0&&(a+=_,a>=t&&a<=n))break}if(a>=t&&a<=n)break}return a}function Ci(i){return i.some(o=>o[0]>0)}function Fo(i,o,e,t,n,r){let a=Ze(n,r),s=a*4,c=[];for(let g of t)for(let _ of e)c.push([_,g]);H(c);let d=0;for(;d<a&&s-- >0&&c.length>0;){let[g,_]=c.pop();if(g===e[0]||g===e.at(-1)||_===t[0]||_===t.at(-1))continue;let P=v(o,g,_);if(!i.has(P))continue;let E=Math.random()<.5?"h":"v",w=[];E==="h"?(w.push(P),g+1<=e.at(-1)&&w.push(v(o,g+1,_))):(w.push(P),_+1<=t.at(-1)&&w.push(v(o,g,_+1)));let V=!1;for(let I of w)i.delete(I)&&(V=!0);V&&d++}}function No(i,o,e){for(let t of e)for(let n of o)n%2!==0||t%2!==0||i.add(v(0,n,t))}function jo(){let i=Math.random()<.5?0:fe([0,0,2,2,4]),o=Math.random()<.5?0:fe([0,0,2,2,4]),e=Math.random()<.5?0:fe([0,2,2,4]),t=Math.random()<.5?0:fe([0,2,2,4]);return{left:i,right:o,top:e,bottom:t}}function Go(i,o,e,t,n,r){let{left:a,right:s,top:c,bottom:d}=r;for(let g of e)for(let _ of o)(_<a||_>t-s||g<c||g>n-d)&&i.delete(v(0,_,g))}function $o(i,o,e){return Math.min(Math.max(o,Math.floor(i*.45)),e)}function Ho(i,o,e){let t=o.length;if(t<=e)return t;let n=H([...o]);for(;t>e&&n.length>0;){let r=n.pop();i.delete(v(0,r[1],r[2]))&&t--}return t}function Uo(i,o,e){let t=[];for(let n of e)for(let r of o)i.has(v(0,r,n))||t.push([0,r,n]);return t}function zo(i,o,e,t){H(o);let n=e;for(;n<t&&o.length>0;){let[,r,a]=o.pop();ae(i,0,r,a)||(i.add(v(0,r,a)),n++)}return n}function Mi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,{xs:r,ys:a}=yt(e,t,1);No(n,r,a);let s=jo();Go(n,r,a,e,t,s),Fo(n,0,r,a,6,32);let c=ke(n,e,t,1),d=c.length,g=$o(d,i,o);if(d>g)Ho(n,c,g);else if(d<g){let _=Uo(n,r,a);zo(n,_,d,g)}return ke(n,e,t,1)}function Xt(i,o,e,t,n,r=!1){if(t%2!==0||n%2!==0||!q(t,n,0))return!1;let a=v(0,t,n);return i.has(a)||ae(i,0,t,n)?!1:(i.add(a),o.push([0,t,n]),r&&e.add(a),!0)}function Ko(i,o,e,t,n){let r=Math.floor(t/2),a=Math.floor(n/2);return r-=r%2,a-=a%2,q(r,a,0)||(r=0,a=0),Xt(i,o,e,r,a,!0),{sx:r,sy:a}}function Yo(i,o){let e=i+o,t=Math.max(40,Math.floor(e*.8)),n=Math.max(t+100,Math.floor(e*2));return Ze(t,n)}function qo(i,o){let e=[i[0],i[1]],t=[-i[0],-i[1]],n=i[0]===0?[[1,0],[-1,0]]:[[0,1],[0,-1]],r=[e,...n,t];return Math.random()<o&&(r=H(r)),Math.random()<.2&&(r=[...H([...n]),e,t]),r}function Xo(i,o,e,t,n,r,a){let s=qo(r,a);for(let[c,d]of s){let g=t+c*2,_=n+d*2;if(q(g,_,0)&&Xt(i,o,e,g,_,!0))return{x:g,y:_,direction:[c,d]}}return null}function Wo(i,o,e,t,n){let r=H([[1,0],[-1,0],[0,1],[0,-1]]);for(let[a,s]of r){let c=t+a*2,d=n+s*2;if(!(!q(c,d,0)||ae(i,0,c,d)||i.has(v(0,c,d)))&&Xt(i,o,e,c,d,!0))return{x:c,y:d,direction:[a,s]}}return null}function Zo(i,o,e,t,n,r){let a=Math.random()<.4?fe([0,0,2]):0,s=Math.random()<.4?fe([0,0,2]):0,c=Math.random()<.4?fe([0,2]):0,d=Math.random()<.4?fe([0,2]):0;for(let g of t)for(let _ of e)if(_<a||_>n-s||g<c||g>r-d){let P=v(0,_,g);o.has(P)||i.delete(P)}}function Qo(i,o,e,t){let n=o.length,r=H([...o].filter(a=>!e.has(v(0,a[1],a[2]))));for(;n>t&&r.length>0;){let a=r.pop();i.delete(v(0,a[1],a[2]))&&n--}return n}function Jo(i,o,e,t,n,r){let a=[],s=[];for(let g of t)for(let _ of e)i.has(v(0,_,g))||([[_-2,g],[_+2,g],[_,g-2],[_,g+2]].some(([w,V])=>o.has(v(0,w,V)))?a:s).push([0,_,g]);H(a),H(s);let c=[a,s],d=n;for(let g of c)for(;d<r&&g.length>0;){let[_,P,E]=g.pop();P%2===0&&E%2===0&&!ae(i,0,P,E)&&(i.add(v(_,P,E)),d++)}return d}function er(i,o,e,t,n,r,a,s){let c=ke(i,a,s,1),d=c.length,g=Math.min(Math.max(n,Math.floor(d*.9)),r);d>g?Qo(i,c,o,g):d<g&&Jo(i,o,e,t,d,g)}function tr(i,o,e){let t=[];for(let n of e)for(let r of o)i.has(v(0,r,n))&&t.push([0,r,n]);return t}function Pi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=[],a=new Set,{xs:s,ys:c}=yt(e,t,1),{sx:d,sy:g}=Ko(n,r,a,e,t),_=d,P=g,w=[[1,0],[-1,0],[0,1],[0,-1]][Math.floor(Math.random()*4)],V=Yo(e,t);for(let I=0;I<V;I++){let F=I%Ze(6,12)===0?Math.random()*.6+.2:Math.random()*.3,X=Xo(n,r,a,_,P,w,F);if(X){_=X.x,P=X.y,w=X.direction;continue}let W=Wo(n,r,a,_,P);if(W){_=W.x,P=W.y,w=W.direction;continue}break}return Zo(n,a,s,c,e,t),er(n,a,s,c,i,o,e,t),tr(n,s,c)}function Oi(i,o,e,t){let n=i+(e-1)*2,r=o+(t-1)*2,a=[];for(let s=i;s<=n;s+=2)a.push([s,o]);for(let s=o+2;s<=r;s+=2)a.push([n,s]);for(let s=n-2;s>=i;s-=2)a.push([s,r]);for(let s=r-2;s>o;s-=2)a.push([i,s]);return a}function Wt(i,o,e,t,n,r,a){let s=`${e}x${t}`;if(a.has(s))return!1;let c=i+(e-1)*2,d=o+(t-1)*2;if(!q(c,d,0))return!1;let g=Oi(i,o,e,t);for(let[_,P]of g){if(_%2!==0||P%2!==0||!q(_,P,0))return!1;let E=v(0,_,P);if(n.has(E)||r.has(E)||ae(n,0,_,P))return!1}return!0}function Zt(i,o,e,t,n,r,a){let s=Oi(i,o,e,t);for(let[c,d]of s)n.add(v(0,c,d));return xt(s,2,r,0),a.add(`${e}x${t}`),s.length}function bi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=new Set,a=new Set,s=[];for(let g=3;g<=8;g++)for(let _=3;_<=8;_++)s.push([g,_]);H(s);let c=vt(e,t);H(c);let d=0;if(d=Ae(d,s,c,i,o,(g,_,P,E)=>Wt(g,_,P,E,n,r,a)?Zt(g,_,P,E,n,r,a):0),d<i){let g=s.filter(([_,P])=>!a.has(`${_}x${P}`));H(g),H(c),d=Ae(d,g,c,i,o,(_,P,E,w)=>Wt(_,P,E,w,n,r,a)?Zt(_,P,E,w,n,r,a):0)}if(d<o){let g=!0,_=!1;for(;g&&d<o;){g=!1;let P=_?[...s]:s.filter(([E,w])=>!a.has(`${E}x${w}`));if(P.length===0&&!_){_=!0;continue}H(P),H(c),d=Ae(d,P,c,i,o,(E,w,V,I)=>{if(!Wt(E,w,V,I,n,r,a))return 0;let F=Zt(E,w,V,I,n,r,a);return F>0&&(g=!0),F})}}return ke(n,e,t,2)}function vi(i,o,e,t){let n=i+(e-1)*2,r=o+(t-1)*2,a=[];for(let s=o;s<=r;s+=2)for(let c=i;c<=n;c+=2)a.push([c,s]);return a}function Qt(i,o,e,t,n,r,a){let s=`${e}x${t}`;if(a.has(s))return!1;let c=i+(e-1)*2,d=o+(t-1)*2;if(!q(c,d,0))return!1;let g=vi(i,o,e,t);for(let[_,P]of g){if(_%2!==0||P%2!==0||!q(_,P,0))return!1;let E=v(0,_,P);if(n.has(E)||r.has(E)||ae(n,0,_,P))return!1}return!0}function Jt(i,o,e,t,n,r,a){let s=vi(i,o,e,t);for(let[c,d]of s)n.add(v(0,c,d));return xt(s,2,r,0),a.add(`${e}x${t}`),s.length}function xi({minTarget:i,maxTarget:o,xMax:e,yMax:t}){let n=new Set,r=new Set,a=new Set,s=[];for(let g=2;g<=5;g++)for(let _=2;_<=5;_++)s.push([g,_]);H(s);let c=vt(e,t);H(c);let d=Ae(0,s,c,i,o,(g,_,P,E)=>Qt(g,_,P,E,n,r,a)?Jt(g,_,P,E,n,r,a):0);if(d<i){let g=s.filter(([_,P])=>!a.has(`${_}x${P}`));H(g),H(c),d=Ae(d,g,c,i,o,(_,P,E,w)=>Qt(_,P,E,w,n,r,a)?Jt(_,P,E,w,n,r,a):0)}if(d<o){let g=!0,_=!1;for(;g&&d<o;){g=!1;let P=_?[...s]:s.filter(([E,w])=>!a.has(`${E}x${w}`));if(P.length===0&&!_){_=!0;continue}H(P),H(c),d=Ae(d,P,c,i,o,(E,w,V,I)=>{if(!Qt(E,w,V,I,n,r,a))return 0;let F=Jt(E,w,V,I,n,r,a);return F>0&&(g=!0),F})}}return ke(n,e,t,2)}function wt(i,o,e){if(!i&&!o||e.length===0)return e;let t=Math.max(...e.map(w=>w[1])),n=Math.max(...e.map(w=>w[2])),r=t*2+2,a=n*2+2,s=Math.min(36,r+4),c=Math.min(16,a+4);s%2!==0&&s--,c%2!==0&&c--,s<r&&(s=Math.max(t*2,Math.min(36-36%2,r))),c<a&&(c=Math.max(n*2,Math.min(16-16%2,a)));let d=w=>s-w,g=w=>c-w,_=[...e],P=new Set(_.map(([w,V,I])=>v(w,V,I))),E=(w,V,I)=>{if(!q(V,I,w))return;let F=v(w,V,I);P.has(F)||ae(P,w,V,I)||(P.add(F),_.push([w,V,I]))};if(i){let w=[..._];for(let[V,I,F]of w){let X=d(I);X!==I&&E(V,X,F)}}if(o){let w=[..._];for(let[V,I,F]of w){let X=g(F);X!==F&&E(V,I,X)}}return _}function kt(i,o,e,t){let n=e&&t,r=e&&!t||!e&&t,a;n?a=.25:r?a=.5:a=1;let s=Math.max(1,Math.floor(i*a)),c=Math.max(s,Math.floor(o*a)),d=e?Math.floor(36/2):36,g=t?Math.floor(16/2):16;return{minTarget:s,maxTarget:c,xMax:d,yMax:g}}function yi(i,o,e){if(e==="checker"){let{minTarget:t,maxTarget:n}=kt(70,120,i,o),r=i?7:14,a=i?Math.floor(36/2):36,s=o?6:12,c=o?Math.floor(16/2):16,d=Math.floor(Math.random()*(a-r+1))+r,g=Math.floor(Math.random()*(c-s+1))+s;return wt(i,o,Mi({minTarget:t,maxTarget:n,xMax:d,yMax:g}))}if(e==="lines")return wt(i,o,Pi(kt(60,80,i,o)));if(e==="rings")return wt(i,o,bi(kt(70,120,i,o)));if(e==="areas")return wt(i,o,xi(kt(60,100,i,o)));throw new Error("Invalid mode")}function nr(i,o){let e=36,t=0,n=16,r=0;for(let[a,s,c]of i)a===o-1&&(e=Math.min(e,s),t=Math.max(t,s),n=Math.min(n,c),r=Math.max(r,c));return e>t||n>r?null:{minX:Math.max(0,e-2),maxX:Math.min(36,t+2),minY:Math.max(0,n-2),maxY:Math.min(16,r+2)}}function ir(i,o,e){let t=[],n=[],r=[],a=o-1;for(let s=e.minY;s<=e.maxY;s++)for(let c=e.minX;c<=e.maxX;c++){let d=v(o,c,s);if(i.has(d)||!q(c,s,o))continue;let g=i.has(v(a,c,s)),_=i.has(v(a,c-1,s))&&i.has(v(a,c+1,s)),P=i.has(v(a,c-1,s-1))&&i.has(v(a,c+1,s-1))&&i.has(v(a,c-1,s+1))&&i.has(v(a,c+1,s+1));(g||_||P)&&(P?t.push([c,s]):_?n.push([c,s]):g&&r.push([c,s]))}return{bridgeLarge:t,bridgeSmall:n,direct:r}}function or(i,o,e){let t=[],n=o-1;if(Math.random()<.25)for(let r=e.minY;r<=e.maxY;r++)for(let a=e.minX;a<=e.maxX;a++){if(!i.has(v(n,a,r)))continue;let s=[[-1,0],[1,0],[0,-1],[0,1]],[c,d]=fe(s),g=a+c,_=r+d;if(!q(g,_,o))continue;let P=v(o,g,_);i.has(P)||t.push([g,_])}return t}function rr(i){let o=Math.trunc(Math.random()*i);return o-=o%2,Math.max(o,2)}function ar(i,o,e,t,n,r,a,s,c){if(!Qe(i,o,e,t,n))return!1;if(r||a){let d=s(t),g=c(n);r&&d!==t&&Qe(i,o,e,d,n),a&&g!==n&&Qe(i,o,e,t,g),r&&a&&(d!==t||g!==n)&&Qe(i,o,e,d,g)}return!0}function sr(i,o,e,t){if(i.length>=144)return i;let n=nr(i,o);if(!n)return i;let r=new Set(i.map(F=>v(F[0],F[1],F[2]))),{bridgeLarge:a,bridgeSmall:s,direct:c}=ir(r,o,n),d=or(r,o,n),g=144-i.length,_=rr(g),P=0,{mirX:E,mirY:w}=wi(i),V=[...i],I=F=>{for(let[X,W]of F){if(P>=_||V.length>=144)return;ar(r,V,o,X,W,e,t,E,w)&&P++}};return I(a),I(s),I(c),I(d),V}function lr(i,o,e){let t=i;for(let n=1;n<=5&&t.length<144;n++)t=sr(t,n,o,e);return t.length>144?t.slice(0,144):t}function wi(i){let o=i.map(d=>d[1]),e=i.map(d=>d[2]),t=o.length>0?Math.min(...o):0,n=o.length>0?Math.max(...o):36,r=e.length>0?Math.min(...e):0,a=e.length>0?Math.max(...e):16,s=(t+n)/2,c=(r+a)/2;return{mirX:d=>Math.round(2*s-d),mirY:d=>Math.round(2*c-d)}}function cr(i,o,e,t,n,r,a,s,c){let d=[[t,n]];if(r){let g=s(t);g!==t&&d.push([g,n])}if(a){let g=c(n);if(d.some(_=>_[0]===t&&_[1]===g)||d.push([t,g]),r){let _=s(t),P=c(n);d.some(E=>E[0]===_&&E[1]===P)||d.push([_,P])}}for(let[g,_]of d){if(!q(g,_,e))return!1;let P=v(e,g,_);if(o.has(P)||!bt(o,e,g,_)||ae(o,e,g,_))return!1}if(i.length+d.length>144)return!1;for(let[g,_]of d){let P=v(e,g,_);o.add(P),i.push([e,g,_])}return!0}function dr(i,o,e){let t=new Set(i.map(s=>v(s[0],s[1],s[2]))),{mirX:n,mirY:r}=wi(i),a=!0;for(;i.length<144&&a;){a=!1;for(let s=0;s<=5&&i.length<144;s++){let c=[];for(let d=0;d<=16;d++)for(let g=0;g<=36;g++)q(g,d,s)&&(t.has(v(s,g,d))||c.push([g,d]));for(let d=c.length-1;d>0;d--){let g=Math.floor(Math.random()*(d+1));[c[d],c[g]]=[c[g],c[d]]}for(let[d,g]of c){if(i.length>=144)break;cr(i,t,s,d,g,o,e,n,r)&&(a=!0)}}}return i}function pr(i){let o=36,e=0,t=16,n=0;for(let[,r,a]of i)o=Math.min(o,r),e=Math.max(e,r),t=Math.min(t,a),n=Math.max(n,a);return{minX:Math.max(0,o-2),maxX:Math.min(36,e+2),minY:Math.max(0,t-2),maxY:Math.min(16,n+2)}}function gr(i,o,e){for(let t=5;t>=0;t--)for(let n=e.minY;n<=e.maxY;n++)for(let r=e.minX;r<=e.maxX;r++){if(!q(r,n,t))continue;let a=v(t,r,n);if(!o.has(a)&&bt(o,t,r,n)&&!ae(o,t,r,n))return o.add(a),i.push([t,r,n]),!0}return!1}function mr(i){let o=new Map;for(let[e,t,n]of i)o.set(v(e,t,n),0);for(let[e,t,n]of i){if(e===0)continue;let r=e-1,a=[v(r,t,n),v(r,t-1,n),v(r,t+1,n),v(r,t-1,n-1),v(r,t+1,n-1),v(r,t-1,n+1),v(r,t+1,n+1)];for(let s of a)o.has(s)&&o.set(s,(o.get(s)||0)+1)}return o}function hr(i,o){let e=-1,t=-1;for(let n=i.length-1;n>=0;n--){let[r,a,s]=i[n],c=v(r,a,s);(o.get(c)||0)===0&&r>=t&&(e=n,t=r)}return e}function ur(i){if(!_i(i.length))return i;let o=new Set(i.map(r=>v(r[0],r[1],r[2]))),e=pr(i);if(gr(i,o,e)||i.length===0)return i;let t=mr(i),n=hr(i,t);return n>=0?i.splice(n,1):i.pop(),i}function ki(i,o,e){let t=[...i],n=0;for(;t.length<144&&n<50;){n++;let r=t.length;if(t=lr(t,o,e),t.length===r)break}return t.length<144&&(t=dr(t,o,e)),t.length>144&&(t=t.slice(0,144)),t=ur(t),t}var Si=100;function _r(i,o,e){let t=yi(i,o,e);for(let n=0;n<Si;n++){let r=ki(t,i,o);if(r.length===144)return r}return[]}function Ei(i,o,e){let t=i==="random"?Math.random()<.5:i==="true",n=o==="random"?Math.random()<.5:o==="true",r=e==="random"?fi():e,a=[],s=0;for(;a.length!==144||!Ci(a);)if(a=_r(t,n,r),s++,s>Si)return[];return Zn(a)}var Ti=(()=>{class i{constructor(){this.translate=k(Be)}transform(e){let t=`CAT_${e.toUpperCase()}`,n=this.translate.instant(t);return n===t?e:n}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ye({name:"translateGroup",type:i,pure:!0})}}return i})();var fr=["scrollHost"];function Cr(i,o){if(i&1){let e=A();p(0,"a",4),b("click",function(){let n=x(e).$index,r=C(2);return y(r.scrollToGroup(n))}),f(1),h(2,"translateGroup"),m()}if(i&2){let e=o.$implicit;l(),M(u(2,1,e.name))}}function Mr(i,o){if(i&1&&(p(0,"div",1),N(1,Cr,3,3,"a",null,U),m()),i&2){let e=C();l(),j(e.groups)}}function Pr(i,o){if(i&1&&f(0),i&2){let e=C(2).$implicit;K(" [",e.layouts.length,"] ")}}function Or(i,o){if(i&1){let e=A();p(0,"div",6),b("click",function(){x(e);let n=C().$implicit;return y(n.expanded=!n.expanded)}),S(1,"span",7),f(2),h(3,"translateGroup"),p(4,"span",8),T(5,Pr,1,1),m()()}if(i&2){let e=C().$implicit;l(),ee("expanded",e.expanded),l(),K(" ",u(3,4,e.name)," "),l(3),L(e.isRandom?-1:5)}}function br(i,o){if(i&1&&S(0,"app-layout-preview",27),i&2){let e=C().$implicit;O("svg",e.layout.previewSVG)("alt",e.layout.name)}}function vr(i,o){if(i&1&&S(0,"div",30),i&2){let e=C().$implicit;ee("selected",e.selected),O("id","item-"+e.layout.id)}}function xr(i,o){if(i&1){let e=A();p(0,"div",26),b("keydown.enter",function(){let n=x(e).$implicit,r=C(4);return y(r.onStart(n))})("click",function(){let n=x(e).$implicit,r=C(4);return y(r.onStart(n))})("appDeferLoad",function(){let n=x(e).$implicit;return y(n.visible=!0)}),T(1,br,1,2,"app-layout-preview",27)(2,vr,1,3,"div",28),p(3,"div",29),f(4),m()()}if(i&2){let e=o.$implicit;ee("selected",e.selected),O("id","item-"+e.layout.id),l(),L(e.visible?1:2),l(3),M(e.layout.name)}}function yr(i,o){if(i&1){let e=A();p(0,"div",9),N(1,xr,5,5,"div",11,U),p(3,"div",12)(4,"div",13)(5,"label",14),Y(),p(6,"svg",15),S(7,"path",16),m(),f(8),h(9,"translate"),m(),Ke(),p(10,"select",17),b("change",function(n){x(e);let r=C(3);return y(r.randomMirrorXSet(n.target.value))}),p(11,"option",18),f(12),h(13,"translate"),m(),p(14,"option",19),f(15),h(16,"translate"),m(),p(17,"option",20),f(18),h(19,"translate"),m()()(),p(20,"div",13)(21,"label",21),Y(),p(22,"svg",22),S(23,"path",23),m(),f(24),h(25,"translate"),m(),Ke(),p(26,"select",24),b("change",function(n){x(e);let r=C(3);return y(r.randomMirrorYSet(n.target.value))}),p(27,"option",18),f(28),h(29,"translate"),m(),p(30,"option",19),f(31),h(32,"translate"),m(),p(33,"option",20),f(34),h(35,"translate"),m()()(),p(36,"div")(37,"button",25),b("click",function(){x(e);let n=C(3);return y(n.generateRandomLayouts())})("keydown.enter",function(){x(e);let n=C(3);return y(n.generateRandomLayouts())}),f(38),h(39,"translate"),m()()()()}if(i&2){let e=C(2).$implicit,t=C();l(),j(e.layouts),l(7),K(" ",u(9,15,"MIRROR_X")," "),l(3),O("selected",t.randomMirrorX==="random"),l(),M(u(13,17,"RANDOM_MIRROR")),l(2),O("selected",t.randomMirrorX==="true"),l(),M(u(16,19,"YES")),l(2),O("selected",t.randomMirrorX==="false"),l(),M(u(19,21,"NO")),l(6),K(" ",u(25,23,"MIRROR_Y")," "),l(3),O("selected",t.randomMirrorY==="random"),l(),M(u(29,25,"RANDOM_MIRROR")),l(2),O("selected",t.randomMirrorY==="true"),l(),M(u(32,27,"YES")),l(2),O("selected",t.randomMirrorY==="false"),l(),M(u(35,29,"NO")),l(4),K(" ",u(39,31,"GENERATE")," ")}}function wr(i,o){if(i&1&&S(0,"app-layout-preview",27),i&2){let e=C().$implicit;O("svg",e.layout.previewSVG)("alt",e.layout.name)}}function kr(i,o){if(i&1&&S(0,"div",34),i&2){let e=C().$implicit;ee("selected",e.selected)}}function Sr(i,o){if(i&1){let e=A();p(0,"div",32)(1,"span",35),h(2,"translate"),f(3),h(4,"duration"),m(),p(5,"a",36),h(6,"translate"),b("click",function(n){x(e);let r=C().$implicit,a=C(4);return y(a.clearBestTimeClick(n,r))}),S(7,"i",37),m()()}if(i&2){let e=C().$implicit;l(),O("title",G(u(2,5,"STATS_BEST"))),l(2),M(u(4,7,e.bestTime)),l(2),O("title",G(u(6,9,"BEST_TIME_CLEAR")))}}function Er(i,o){if(i&1){let e=A();p(0,"div",33),h(1,"translate"),p(2,"a",4),b("click",function(n){x(e);let r=C().$implicit,a=C(4);return y(a.removeCustomLayout(n,r))}),S(3,"i",38),m()()}i&2&&O("title",G(u(1,2,"CUSTOM_BOARD_DELETE")))}function Tr(i,o){if(i&1){let e=A();p(0,"div",26),b("keydown.enter",function(){let n=x(e).$implicit,r=C(4);return y(r.onStart(n))})("click",function(){let n=x(e).$implicit,r=C(4);return y(r.onStart(n))})("appDeferLoad",function(){let n=x(e).$implicit;return y(n.visible=!0)}),T(1,wr,1,2,"app-layout-preview",27)(2,kr,1,2,"div",31),T(3,Sr,8,11,"div",32),p(4,"div",29),f(5),m(),T(6,Er,4,4,"div",33),m()}if(i&2){let e=o.$implicit;ee("selected",e.selected),O("id","item-"+e.layout.id),l(),L(e.visible?1:2),l(2),L(e.bestTime?3:-1),l(2),M(e.layout.name),l(),L(e.layout.custom?6:-1)}}function Lr(i,o){if(i&1&&(p(0,"div",10),N(1,Tr,7,7,"div",11,U),m()),i&2){let e=C(2).$implicit;l(),j(e.layouts)}}function Ir(i,o){if(i&1&&T(0,yr,40,33,"div",9)(1,Lr,3,0,"div",10),i&2){let e=C().$implicit;L(e.isRandom?0:1)}}function Br(i,o){if(i&1&&(p(0,"div",3),T(1,Or,6,6,"div",5),T(2,Ir,2,1),m()),i&2){let e=o.$implicit,t=o.$index,n=C();O("id",te("group-",t)),l(),L(n.groups.length>1?1:-1),l(),L(e.expanded?2:-1)}}var Li=(()=>{class i{constructor(){this.layouts=R(),this.startEvent=me(),this.scrollHost=_e.required("scrollHost"),this.groups=[],this.randomMirrorX="random",this.randomMirrorY="random",this.randomGroup={name:"",layouts:[],expanded:!0,isRandom:!0},this.storage=k(De),this.translate=k(Be),this.layoutService=k(Pe)}ngOnInit(){this.randomMirrorX=this.storage.getLastMirrorX()??"random",this.randomMirrorY=this.storage.getLastMirrorY()??"random",this.buildRandomGroup()}buildRandomGroup(){this.randomGroup.name=this.translate.instant("RANDOM_GROUP");let e=this.translate.instant("RANDOM_LAYOUT");for(let t=0;t<4;t++)this.randomGroup.layouts.push({layout:{id:`${ht}${t}`,name:`${e} ${t+1}`,category:this.randomGroup.name,mapping:[]},visible:!1,selected:!1});this.generateRandomLayouts()}randomMirrorXSet(e){this.randomMirrorX=e,this.storage.setLastMirrorX(e),this.generateRandomLayouts()}randomMirrorYSet(e){this.randomMirrorY=e,this.storage.setLastMirrorY(e),this.generateRandomLayouts()}generateRandomLayout(e){let t=Ei(this.randomMirrorX,this.randomMirrorY,"random");e.layout.previewSVG=this.layoutService.generatePreview(t),e.layout.mapping=t}generateRandomLayouts(){for(let e of this.randomGroup.layouts)setTimeout(()=>{this.generateRandomLayout(e)})}ngOnChanges(e){this.refresh()}refresh(){let e=this.layouts();if(e){this.buildGroups();let t=this.storage.getLastPlayed(),n=this.layoutService.selectBoardID;this.layoutService.selectBoardID=void 0,n&&e.some(r=>r.id===n)&&(t=n),t&&setTimeout(()=>{this.select(t)})}}onStart(e){e?.visible&&this.startEvent.emit(e.layout)}buildGroups(){let e=[],t={},n=this.layouts()??this.layoutService.layouts.items;for(let r of n){t[r.category]||(t[r.category]={name:r.category,layouts:[],expanded:!0},e.push(t[r.category]));let a=this.storage.getScore(r.id)||{};t[r.category].layouts.push({layout:r,playCount:a.playCount,bestTime:a.bestTime,visible:!1})}e.push(this.randomGroup),this.groups=e}scrollToElement(e,t){if(!e||!t)return;let n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),a=n.top-r.top+t.scrollTop;t.scrollTo({top:a,behavior:"auto"})}scrollToGroup(e){let t=document.getElementById(`group-${e}`);t&&this.scrollToElement(t,this.scrollHost().nativeElement)}scrollToItem(e){let t=document.getElementById(`item-${e}`);t&&this.scrollToElement(t,this.scrollHost().nativeElement)}select(e){if(e){for(let t of this.groups)for(let n of t.layouts)n.selected=n.layout.id===e;this.scrollToItem(e)}}clearBestTimeClick(e,t){e.stopPropagation(),confirm(this.translate.instant("BEST_TIME_CLEAR_SURE"))&&(this.storage.clearScore(t.layout.id),t.bestTime=void 0,t.playCount=void 0)}removeCustomLayout(e,t){e.stopPropagation(),confirm(this.translate.instant("CUSTOM_BOARD_DELETE_SURE"))&&(this.layoutService.removeCustomLayout([t.layout.id]),this.refresh())}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-layout-list"]],viewQuery:function(t,n){t&1&&Te(n.scrollHost,fr,5),t&2&&Le()},inputs:{layouts:[1,"layouts"]},outputs:{startEvent:"startEvent"},features:[Ee],decls:5,vars:1,consts:[["scrollHost",""],[1,"headline-anchors"],[1,"groups"],[1,"group",3,"id"],[3,"click"],[1,"group-name"],[1,"group-name",3,"click"],[1,"group-expander"],[1,"group-count"],["appDeferLoadScrollHost","",1,"previews","previews-random"],["appDeferLoadScrollHost","",1,"previews"],["tabindex","0",1,"preview",3,"id","selected"],[1,"preview-random"],[1,"random-options"],["for","random-setting-vertical"],["width","20px","height","20px","viewBox","-2 0 20 20"],["id","focus_vertical-[#842]","d","M7,20 L7,0 L9,0 L9,20 Z M0,2 L5,2 L5,4 L2,4 L2,7 L0,7 Z M11,2 L16,2 L16,7 L14,7 L14,4 L11,4 Z M0,18 L0,13 L2,13 L2,16 L5,16 L5,18 Z M16,18 L11,18 L11,16 L14,16 L14,13 L16,13 Z"],["id","random-setting-vertical",3,"change"],["value","random",3,"selected"],["value","true",3,"selected"],["value","false",3,"selected"],["for","random-setting-horizontal"],["width","20px","height","20px","viewBox","0 -2 20 20"],["d","M0,9 L0,7 L20,7 L20,9 Z M2,5 L2,0 L7,0 L7,2 L4,2 L4,5 Z M18,0 L18,5 L16,5 L16,2 L13,2 L13,0 Z M2,16 L2,11 L4,11 L4,14 L7,14 L7,16 Z M18,16 L13,16 L13,14 L16,14 L16,11 L18,11 Z"],["id","random-setting-horizontal",3,"change"],[3,"click","keydown.enter"],["tabindex","0",1,"preview",3,"keydown.enter","click","appDeferLoad","id"],[1,"svg-board",3,"svg","alt"],[1,"preview-placeholder",3,"id","selected"],[1,"preview-name"],[1,"preview-placeholder",3,"id"],[1,"preview-placeholder",3,"selected"],[1,"preview-best-time"],[1,"preview-custom",3,"title"],[1,"preview-placeholder"],[3,"title"],[3,"click","title"],[1,"icon-cancel-squared"],[1,"icon-trash-empty"]],template:function(t,n){t&1&&(T(0,Mr,3,0,"div",1),p(1,"div",2,0),N(3,Br,3,4,"div",3,U),m()),t&2&&(L(n.groups.length>1?0:-1),l(3),j(n.groups))},dependencies:[Wn,hi,ui,Ot,Z,Ti],styles:['[_nghost-%COMP%]{display:flex;overflow:hidden;flex-direction:column;flex:1;border:1px solid var(--card-layout-color-border);border-radius:4px}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{border-bottom:1px solid var(--card-layout-color-border);width:100%;display:flex;flex-wrap:wrap;padding-top:2px;padding-bottom:2px;color:var(--dialog-text-color);white-space:nowrap}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;flex:1 1 140px;padding:2px 4px;font-size:.9em;cursor:pointer;text-align:center}[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--dialog-headline-color);background-color:var(--dialog-background-color-hover)}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{justify-content:center}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]{overflow:hidden auto;width:100%;flex:1}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{border-top:1px solid var(--card-layout-color-border);color:var(--main-content-text-color);padding-top:12px;padding-bottom:12px;height:48px;display:flex;justify-content:space-between;align-items:center;text-align:center;cursor:pointer}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]:hover{color:var(--dialog-headline-color);background-color:var(--dialog-background-color-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]{margin-left:20px;min-width:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander[_ngcontent-%COMP%]:after{content:"+";color:var(--main-content-text-color-muted);font-size:1.2em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-expander.expanded[_ngcontent-%COMP%]:after{content:"-"}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]   .group-count[_ngcontent-%COMP%]{font-size:.8em;color:var(--main-content-text-color-muted);margin-right:20px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]:first-of-type   .group-name[_ngcontent-%COMP%]{border-top:inherit}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{padding:20px 10px 10px;display:flex;flex-direction:column;gap:10px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1;align-items:center;flex-direction:row;font-size:.9em;display:flex}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   .random-options[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:var(--main-content-text-color)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{width:100%;display:flex;flex-flow:row wrap;justify-content:space-evenly;gap:4px;padding-bottom:12px;box-sizing:border-box}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:8px;width:300px;height:208px;cursor:pointer;border:1px solid var(--card-layout-color-border);background-color:var(--card-layout-color-bg);display:block;position:relative;overflow:clip;box-sizing:border-box}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{display:block;width:100%;height:200px;text-align:center;padding-bottom:1.5em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{position:absolute;right:0;background-color:var(--preview-overlay-background);color:var(--preview-overlay-text);text-shadow:1px 1px var(--preview-overlay-text-shadow);border-bottom-left-radius:3px;padding:3px 3px 3px 6px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;min-width:1.2em;text-align:right;transition:all .1s;margin-top:-1px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{transform:scale(1.3)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{position:absolute;width:100%;display:block;bottom:0;background-color:var(--card-text-color-bg);color:var(--card-text-color);text-align:center;font-size:.8em;padding:1px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-best-time[_ngcontent-%COMP%]{top:0;display:flex;flex-direction:row;justify-content:center}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%]{bottom:0;padding:2px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus{background-color:var(--card-layout-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-name[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-name[_ngcontent-%COMP%]{background-color:var(--card-text-color-bg-hover)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:hover   .preview-custom[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]:focus   .preview-custom[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview.selected[_ngcontent-%COMP%]{border:1px solid var(--card-layout-color-border-selected);box-shadow:#00000029 0 3px 6px,#0000003b 0 3px 6px}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:200px;height:190px}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:49%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:96%}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{padding-top:0}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%;height:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-1[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-2[_ngcontent-%COMP%], [_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-3[_ngcontent-%COMP%]{display:none}}@supports (display: grid){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .headline-anchors[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{display:grid;gap:4px;padding-right:4px;padding-bottom:12px;align-content:start;grid-template-columns:repeat(6,1fr);place-items:stretch stretch}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr 2fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{margin-top:0;width:100%;max-width:none;min-width:0;box-sizing:border-box;height:208px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{width:100%;height:200px}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:190px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{height:190px}}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{grid-column:1/-1;flex-direction:row;justify-content:space-around}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-3[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview-random[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   #item-random-2[_ngcontent-%COMP%]{display:none}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{height:120px}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]   app-layout-preview[_ngcontent-%COMP%]{height:100%}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews[_ngcontent-%COMP%]{grid-template-columns:1fr}[_nghost-%COMP%]   .groups[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .previews-random[_ngcontent-%COMP%]{grid-template-columns:1fr}}}']})}}return i})();function Dr(i,o){if(i&1&&(p(0,"option",5),f(1),h(2,"translate"),h(3,"translate"),m()),i&2){let e=o.$implicit,t=C();O("value",e.id)("selected",t.buildMode===e.id),l(),Ye("",u(2,4,e.id)," [",u(3,6,e.id+"_DESC"),"]")}}function Ar(i,o){if(i&1&&(f(0),h(1,"translate")),i&2){let e=o.$implicit,t=o.$index,n=o.$count;Ye(" ",u(1,2,e.title),"",t!==n-1?", ":""," ")}}function Rr(i,o){if(i&1&&(f(0," ["),N(1,Ar,2,4,null,null,U),f(3,"] ")),i&2){let e=C().$implicit;l(),j(e.features)}}function Vr(i,o){if(i&1&&(p(0,"option",5),f(1),h(2,"translate"),T(3,Rr,4,0),m()),i&2){let e=o.$implicit,t=C();O("value",e.id)("selected",t.gameMode()===e.id),l(),K("",u(2,4,e.id)," "),l(2),L(e.features.length>0?3:-1)}}var Ii=(()=>{class i{constructor(){this.startEvent=me(),this.gameMode=st.required(),this.buildMode=lt,this.buildModes=Nn,this.gameModes=Gn,this.layoutService=k(Pe),this.storage=k(De)}onStart(e){e&&(this.startEvent.emit({layout:e,buildMode:this.buildMode,gameMode:this.gameMode()}),this.storage.storeLastPlayed(e.id))}randomGame(){let e=Math.floor(Math.random()*this.layoutService.layouts.items.length);this.onStart(this.layoutService.layouts.items[e])}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-choose-layout"]],inputs:{gameMode:[1,"gameMode"]},outputs:{startEvent:"startEvent",gameMode:"gameModeChange"},decls:20,vars:10,consts:[[3,"startEvent","layouts"],[1,"choose-buttons"],[1,"generator"],["for","board-generator-select"],["id","board-generator-select",3,"change"],[3,"value","selected"],[1,"mode"],["for","game-mode-select"],["id","game-mode-select",3,"change"],[1,"start-links"],[3,"click"]],template:function(t,n){t&1&&(p(0,"app-layout-list",0),b("startEvent",function(a){return n.onStart(a)}),m(),p(1,"div",1)(2,"div",2)(3,"label",3),f(4),h(5,"translate"),m(),p(6,"select",4),b("change",function(a){return n.buildMode=a.target.value}),N(7,Dr,4,8,"option",5,U),m()(),p(9,"div",6)(10,"label",7),f(11),h(12,"translate"),m(),p(13,"select",8),b("change",function(a){return n.gameMode.set(a.target.value)}),N(14,Vr,4,6,"option",5,U),m()(),p(16,"div",9)(17,"button",10),b("click",function(){return n.randomGame()}),f(18),h(19,"translate"),m()()()),t&2&&(O("layouts",n.layoutService.layouts.items),l(4),K("",u(5,4,"BOARD_GENERATOR"),":"),l(3),j(n.buildModes),l(4),K("",u(12,6,"GAME_MODE"),":"),l(3),j(n.gameModes),l(4),M(u(19,8,"START_RANDOM")))},dependencies:[Li,Z],styles:["[_nghost-%COMP%]{padding:0;margin:0;width:100%;height:100%;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{padding-top:10px;display:flex;flex-flow:row nowrap;align-items:flex-end;gap:8px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{text-align:right;display:inline-block}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:2px}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .generator[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], [_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:30%}@media only screen and (max-height:700px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:50%}}@media only screen and (max-height:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{padding-top:4px}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:5px}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:unset}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.7em}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .mode[_ngcontent-%COMP%]{max-width:unset}[_nghost-%COMP%]   .choose-buttons[_ngcontent-%COMP%]   .start-links[_ngcontent-%COMP%]{display:none}}"]})}}return i})();var St=class{constructor(){this.gestureIndicators=[]}hide(o){let e=o;e&&setTimeout(()=>{e.state="hidden",setTimeout(()=>{this.removeIndicator(o)},250)},500)}removeIndicator(o){for(let e=0;e<this.gestureIndicators.length;e++){let t=this.gestureIndicators[e];if(t.x===o.x&&t.y===o.y){this.gestureIndicators.splice(e,1);break}}}setSize(o,e){this.gestureIndicators[o].size=e,this.gestureIndicators[o].top=this.gestureIndicators[o].y-e/2,this.gestureIndicators[o].left=this.gestureIndicators[o].x-e/2}display(o,e,t){if(o>0&&e>0){let n={x:o,y:e,size:t,top:e-t/2,left:o-t/2,state:"hidden"};return this.gestureIndicators.push(n),setTimeout(()=>{n.state="visible"},100),n}}};var Bi=(()=>{class i{transform(e,t){return`${t}${e??""}`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ye({name:"prefix",type:i,pure:!0})}}return i})();var Fr=(i,o)=>o.source.z+":"+o.source.x+":"+o.source.y;function Nr(i,o){if(i&1&&(Y(),p(0,"title"),f(1),h(2,"translate"),m()),i&2){let e=C().$implicit;l(),M(u(2,1,e.url))}}function jr(i,o){if(i&1){let e=A();Y(),p(0,"g",9),b("mouseup",function(n){let r=x(e).$implicit,a=C();return y(a.onClickUp(n,r))})("touchend",function(n){let r=x(e).$implicit,a=C();return y(a.onTouchTileEnd(n,r))}),p(1,"g",10),T(2,Nr,3,3,":svg:title"),S(3,"rect",11)(4,"rect",12)(5,"use",13),h(6,"prefix"),S(7,"use",14),m()()}if(i&2){let e=o.$implicit,t=C();ee("selected",e.source.selected)("hidden",e.source.picked)("hinted",e.source.hinted)("wiggle",e.source.effects==null?null:e.source.effects.wiggle),ne("transform",e.pos.translate),l(2),L(e.url?2:-1),l(3),ne("href",at(6,15,e.url,t.urlPrefix),null,"xlink")("x",t.imagePos[0])("y",t.imagePos[1])("width",t.imagePos[2])("height",t.imagePos[3])}}function Gr(i,o){if(i&1&&S(0,"div",15),i&2){let e=o.$implicit;rt("top",e.top,"px")("left",e.left,"px")("width",e.size,"px")("height",e.size,"px")("transform",e.transform),ee("visible",e.state==="visible")}}var Di=1470,Ai=960;function Et(i,o,e){return Math.min(Math.max(o,i),e)}var Tt=(()=>{class i{constructor(){this.background=R(),this.theme=R(),this.imageSet=R(),this.kyodaiUrl=R(),this.pattern=R(),this.stones=R(),this.noRotate=R(!1),this.clickEvent=me(),this.indicators=new St,this.drawStones=[],this.rotate=!1,this.transformSVG="",this.transformStage="",this.viewport=`0 0 ${Di} ${Ai}`,this.prefix="",this.urlPrefix="",this.imagePos=[1,1,69,88],this.imageCut=[0,0,65,90],this.scale=1,this.panX=0,this.panY=0,this.bounds=[0,0,Di,Ai],this.lastPinch=0,this.touchPoints=[],this.initialDistance=0,this.initialScale=1,this.lastTouchX=0,this.lastTouchY=0,this.initialTouchX=0,this.initialTouchY=0,this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.lastMouseX=0,this.lastMouseY=0,this.initialMouseX=0,this.initialMouseY=0,this.isPanning=!1,this.isPinching=!1,this.app=k(he),this.patternService=k(di),this.element=k(be)}ngOnInit(){this.resize(window)}ngOnChanges(e){if(e.stones&&this.updateStones(e.stones.currentValue),e.background&&this.updateBackground(e.background.currentValue),e.theme||e.pattern){let t=this.background();t&&this.updateBackground(t)}if(e.imageSet){this.prefix=`b_${e.imageSet.currentValue}_`,this.urlPrefix=`#b_${e.imageSet.currentValue}_`;let t=ft(e.imageSet.currentValue);this.imagePos=t?[0,0,75,100]:[6,6,63,88],this.imageCut=t?[1,1,73,98]:[0,0,65,90]}}onWheel(e){e.preventDefault();let n=(e.deltaY<0?1:-1)===1?this.scale+.15:this.scale-.15;this.zoomSVGValue(n,e.clientX,e.clientY);let r=this.indicators.display(e.clientX,e.clientY,n*10);this.indicators.hide(r)}onResize(e){let t=e.target;t&&this.resize(t)}onMouseDown(e){this.scale>1&&(e.preventDefault(),this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,this.initialMouseX=e.clientX,this.initialMouseY=e.clientY)}onMouseMove(e){if(this.scale>1){if(!this.isPanning&&this.initialMouseX!==0&&this.initialMouseY!==0){let t=e.clientX-this.initialMouseX,n=e.clientY-this.initialMouseY;Math.hypot(t,n)>=10&&(this.isPanning=!0)}this.isPanning&&(e.preventDefault(),this.updatePanning(e))}}onMouseUp(e){let t=e.type==="mouseleave";if(this.isPanning)e.preventDefault(),this.updatePanning(e);else if(!t){if(this.scale===1)this.clickEvent.emit(void 0);else if(this.initialMouseX!==0&&this.initialMouseY!==0){let n=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY;Math.hypot(n,r)<4&&this.clickEvent.emit(void 0)}}this.stopPanning()}onTouchTileEnd(e,t){this.hasPinchChanged||this.hasTouchPanMoved||this.clickEvent.emit(t?.source)}onClickUp(e,t){this.initialMouseX=0,this.initialMouseY=0,this.isPanning?(this.updatePanning(e),this.stopPanning()):(this.clickEvent.emit(t?.source),e.stopPropagation())}onTouchStart(e){e.preventDefault(),this.touchPoints=[],this.hasTouchPanMoved=!1,this.hasPinchChanged=!1;let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});if(this.touchPoints.length===1)this.lastTouchX=this.touchPoints[0].x,this.lastTouchY=this.touchPoints[0].y,this.initialTouchX=this.touchPoints[0].x,this.initialTouchY=this.touchPoints[0].y,this.isPanning=!0;else if(this.touchPoints.length===2){this.isPanning=!1,this.isPinching=!0,this.initialDistance=this.getDistance(this.touchPoints[0],this.touchPoints[1]),this.initialScale=this.scale,this.indicators.gestureIndicators=[];let n=(this.touchPoints[0].x+this.touchPoints[1].x)/2,r=(this.touchPoints[0].y+this.touchPoints[1].y)/2;this.indicators.display(n,r,30),this.lastPinch=Date.now()}}onTouchMove(e){e.preventDefault(),this.touchPoints=[];let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});if(this.isPinching&&this.touchPoints.length===2){let r=this.getDistance(this.touchPoints[0],this.touchPoints[1])/this.initialDistance,a=(this.touchPoints[0].x+this.touchPoints[1].x)/2,s=(this.touchPoints[0].y+this.touchPoints[1].y)/2;if(this.indicators.gestureIndicators[0]){let d=this.indicators.gestureIndicators[0];d.x=a,d.y=s,d.top=s-d.size/2,d.left=a-d.size/2}else this.indicators.display(a,s,30);let c=Et(30*r,10,80);this.indicators.setSize(0,c),Math.abs(r-1)>=.1&&(this.hasPinchChanged=!0),this.lastPinch=Date.now()}else if(this.isPanning&&this.touchPoints.length===1&&this.scale>1&&Date.now()-this.lastPinch>600){let n=this.touchPoints[0].x,r=this.touchPoints[0].y,a=n-this.lastTouchX,s=r-this.lastTouchY;if(Math.hypot(n-this.initialTouchX,r-this.initialTouchY)>=10){this.hasTouchPanMoved=!0;let d=this.indicators.display(n,r,10);this.indicators.hide(d)}this.setPanValue(this.panX+a,this.panY+s),this.lastTouchX=n,this.lastTouchY=r}}onTouchEnd(e){if(e.preventDefault(),this.isPinching){let n=this.indicators.gestureIndicators.at(0);n&&this.indicators.hide(n);let r=Array.from(e.touches).map(c=>({x:c.clientX,y:c.clientY,identifier:c.identifier})),a=Array.from(e.changedTouches).map(c=>({x:c.clientX,y:c.clientY,identifier:c.identifier})),s=[];if(r.length>=2?s.push(r[0],r[1]):r.length===1&&a.length>0?s.push(r[0],a[0]):a.length>=2&&s.push(a[0],a[1]),s.length===2){let d=this.getDistance(s[0],s[1])/this.initialDistance,g=this.initialScale;Math.abs(d-1)>=.1&&(g=this.initialScale*d);let _=(s[0].x+s[1].x)/2,P=(s[0].y+s[1].y)/2;this.zoomSVGValue(g,_,P)}this.isPinching=!1,this.lastPinch=Date.now()}else this.isPanning&&(this.updateTransform(),this.isPanning=!1);this.touchPoints=[];let t=Array.from(e.touches);for(let n of t)this.touchPoints.push({x:n.clientX,y:n.clientY,identifier:n.identifier});this.touchPoints.length===0&&(this.hasTouchPanMoved=!1,this.hasPinchChanged=!1,this.initialTouchX=0,this.initialTouchY=0)}updatePanning(e){let t=e.clientX-this.lastMouseX,n=e.clientY-this.lastMouseY,r=this.indicators.display(e.clientX,e.clientY,10);this.indicators.hide(r),this.setPanValue(this.panX+t,this.panY+n),this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,this.updateTransform()}stopPanning(){this.isPanning=!1,this.initialMouseX=0,this.initialMouseY=0}setPanValue(e,t){let n=this.element.nativeElement.offsetWidth||0,r=this.element.nativeElement.offsetHeight||0,a=50,s=Math.max(0,(this.scale-1)*n),c=Math.max(0,(this.scale-1)*r),d=-s-a,g=a,_=-c-a,P=a;this.panX=Et(e,d,g),this.panY=Et(t,_,P)}zoomSVGValue(e,t,n){let r=this.scale,a=Et(e,1,2);if(a!==r){if(a<1.01)this.scale=1,this.panX=0,this.panY=0;else{let s=(t-this.panX)/this.scale,c=(n-this.panY)/this.scale,d=t-s*a,g=n-c*a;this.scale=a,this.setPanValue(d,g)}this.updateTransform()}}updateViewPort(){window.requestAnimationFrame(()=>{this.setViewPort()})}updateTransform(){window.requestAnimationFrame(()=>{this.setTransform()})}setTransform(){let e=this.scale>1?` scale(${this.scale})`:"";if(this.transformSVG=`translate(${this.panX}px, ${this.panY}px)${e}`,this.rotate){let[t,n,r,a]=Yt(this.bounds),s=t+r/2,c=n+a/2;this.transformStage=`rotate(90 ${s} ${c})`}else this.transformStage=""}getDistance(e,t){let n=t.x-e.x,r=t.y-e.y;return Math.hypot(n,r)}resize(e){let t=this.noRotate()?!1:e.innerHeight>e.innerWidth;this.panX=0,this.panY=0,this.scale=1,this.updateTransform(),t!==this.rotate&&(this.rotate=t),this.updateViewPort()}setViewPort(){let[e,t,n,r]=Yt(this.bounds);if(this.rotate){let a=e+n/2,s=t+r/2,c=r,d=n;e=a-c/2,t=s-d/2,n=c,r=d}this.viewport=`${e} ${t} ${n} ${r}`}updateStones(e){if(!e)return;this.scale=1,this.panX=0,this.panY=0;let t=e.filter(n=>n!==void 0).map(n=>({z:n.z,x:n.x,y:n.y,v:n.v,visible:!0,url:n.img?.id,pos:Yn(n.z,n.x,n.y),source:n,className:n.effects?.wiggle?"wiggle":void 0}));this.bounds=Xn(t),this.drawStones=qn(t),this.setViewPort(),this.setTransform()}cssBarColors(){return(qe.find(t=>t.id===this.app.settings.theme)??qe[0]).colors}updateMahBackground(e){this.backgroundUrl="",e&&this.patternService.svgDataUrl(e,this.cssBarColors()).then(t=>this.backgroundUrl=t).catch(console.error)}updateBackground(e){let t=ct.find(n=>n.img===e);if(!t){this.backgroundUrl=void 0;return}if(this.backgroundRepeat=!!t.repeat,t.type==="MAH"){this.updateMahBackground(this.pattern());return}this.backgroundUrl=`url("assets/img/${t.img}.${t.type??"jpg"}")`}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-board"]],hostVars:4,hostBindings:function(t,n){t&1&&b("wheel",function(a){return n.onWheel(a)})("resize",function(a){return n.onResize(a)},On)("mousedown",function(a){return n.onMouseDown(a)})("mousemove",function(a){return n.onMouseMove(a)})("mouseup",function(a){return n.onMouseUp(a)})("mouseleave",function(a){return n.onMouseUp(a)})("touchstart",function(a){return n.onTouchStart(a)})("touchmove",function(a){return n.onTouchMove(a)})("touchend",function(a){return n.onTouchEnd(a)})("touchcancel",function(a){return n.onTouchEnd(a)}),t&2&&(rt("background-image",n.backgroundUrl),ee("background-repeat",n.backgroundRepeat))},inputs:{background:[1,"background"],theme:[1,"theme"],imageSet:[1,"imageSet"],kyodaiUrl:[1,"kyodaiUrl"],pattern:[1,"pattern"],stones:[1,"stones"],noRotate:[1,"noRotate"]},outputs:{clickEvent:"clickEvent"},features:[Ee],decls:14,vars:18,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid meet",1,"board-svg",3,"mouseup"],["id","front","width","300","height","400","viewBox","0 0 300 400"],["transform","translate(28,-614)","d","M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z",2,"fill","#ffffff","fill-opacity","0.3","fill-rule","evenodd","stroke","none","filter","blur(10px)"],["id","mah-image-clip"],["rx","10","ry","10","fill","#fff"],["app-image-set-loader","",3,"imageSet","kyodaiUrl","dark","prefix"],[1,"stage"],[1,"draw",3,"selected","hidden","hinted","wiggle"],[1,"gesture-indicator",3,"top","left","width","height","transform","visible"],[1,"draw",3,"mouseup","touchend"],[1,"tile"],["x","3","y","3","width","75","height","100","rx","10","ry","10",1,"shadow"],["x","0","y","0","width","75","height","100","rx","10","ry","10",1,"stone"],["clip-path","url(#mah-image-clip)"],[0,"xlink","href","#front","x","0","y","0","width","75","height","100",1,"front"],[1,"gesture-indicator"]],template:function(t,n){t&1&&(Y(),p(0,"svg",0),b("mouseup",function(a){return n.onMouseUp(a)}),p(1,"defs")(2,"svg",1),S(3,"path",2),m(),p(4,"clipPath",3),S(5,"rect",4),m()(),p(6,"style"),f(7," g.tile { transform-origin: 50px 32.5px; opacity: 1; transition: transform 120ms ease-in-out; } @keyframes mah-wiggle { 0% { transform: rotate(0deg); } 20% { transform: rotate(-3deg); } 40% { transform: rotate(3deg); } 60% { transform: rotate(-1deg); } 80% { transform: rotate(1deg); } 100% { transform: rotate(0deg); } } g.wiggle g.tile { animation: mah-wiggle 250ms ease-in-out; } g.hinted g.tile { transform: scale(1.12); } g.hinted g.tile > rect { stroke: #9f0000; stroke-width: 3px; } @keyframes mah-select-pop { 0% { transform: scale(1); } 60% { transform: scale(1.08); } 100% { transform: scale(1.04); } } g.selected g.tile { transform: scale(1.04); animation: mah-select-pop 140ms ease-out; } g.selected g.tile rect.stone { stroke: black; fill: #F8EABB; } g.selected.hinted g.tile { transform: scale(1.14); animation: none; } g.selected.hinted g.tile rect.stone { stroke: #9f0000; stroke-width: 3px; } g.draw rect.shadow { fill: #191919; opacity: 0.6; stroke-width: 1; stroke: black; } g.draw rect.stone { fill: #FFF9E5; stroke-width: 1; stroke: black; } g.hidden { opacity: 0; } g.stage.contrast g.draw rect.stone { stroke-width: 2; } g.stage.contrast g.draw rect.shadow { opacity: 0.7; } g.stage.dark g.draw rect.shadow { opacity: 0.6; stroke-width: 1; fill: #9d948c; stroke: green; } g.stage.dark g.draw rect.stone { fill: #000; stroke-width: 1; stroke: #9d948c; } g.stage.dark g.selected g.tile rect.stone { stroke: #F8EABB; fill: black; } g.stage.dark g.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark g.selected.hinted g.tile rect.stone { stroke: #ef0202; } g.stage.dark.contrast g.draw rect.stone { stroke-width: 2; } g.stage.dark.contrast g.draw rect.shadow { opacity: 0.7; } g.stage.dark .front { display: none; } g.stage.dark .front { display: unset; } @media (prefers-reduced-motion: reduce) { g.tile { transition: none; } g.wiggle g.tile { animation: none; } g.selected g.tile { animation: none; } } "),m(),S(8,"defs",5),p(9,"g",6),N(10,jr,8,18,":svg:g",7,Fr),m()(),N(12,Gr,1,12,"div",8,U)),t&2&&(rt("transform",n.transformSVG),ee("rotate",n.rotate),ne("viewBox",n.viewport),l(5),ne("x",n.imageCut[0])("y",n.imageCut[1])("width",n.imageCut[2])("height",n.imageCut[3]),l(3),O("imageSet",n.imageSet())("kyodaiUrl",n.kyodaiUrl())("dark",n.app.settings.dark)("prefix",n.prefix),l(),ee("dark",n.app.settings.dark)("contrast",n.app.settings.contrast),ne("transform",n.transformStage),l(),j(n.drawStones),l(2),j(n.indicators.gestureIndicators))},dependencies:[Mt,Bi,Z],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block;background-repeat:repeat;background-size:cover}.background-repeat[_nghost-%COMP%]{background-size:unset}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;transform-origin:0 0 0;transform:translate(0) scale(1);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .gesture-indicator[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;position:fixed;top:0;left:0;height:50px;width:50px;display:block;border-radius:50%;text-align:center;line-height:45px;z-index:10;background-color:var(--gesture-indicator);transform:scale(0);transition:transform .15s ease-in-out}[_nghost-%COMP%]   .gesture-indicator.visible[_ngcontent-%COMP%]{transform:scale(1.5)}"]})}}return i})();var Ri=[{id:"first-match",titleKey:"TUTORIAL_STEP1_TITLE",descriptionKey:"TUTORIAL_STEP1_DESC",board:[[0,0,0,1],[0,4,0,5],[0,0,2,2],[0,4,2,6]]},{id:"blocked-tiles",titleKey:"TUTORIAL_STEP2_TITLE",descriptionKey:"TUTORIAL_STEP2_DESC",board:[[0,0,0,1],[0,4,0,5],[0,0,2,6],[1,4,0,2]]},{id:"side-blocked",titleKey:"TUTORIAL_STEP3_TITLE",descriptionKey:"TUTORIAL_STEP3_DESC",board:[[0,0,0,1],[0,2,0,5],[0,4,0,2],[0,2,2,6]]},{id:"tricky-tiles",titleKey:"TUTORIAL_STEP4_TITLE",descriptionKey:"TUTORIAL_STEP4_DESC",board:[[0,0,0,129],[0,4,0,130],[0,0,2,131],[0,4,2,132]]},{id:"challenge",titleKey:"TUTORIAL_STEP5_TITLE",descriptionKey:"TUTORIAL_STEP5_DESC",board:[[0,0,0,109],[0,4,0,5],[1,0,0,9],[0,0,2,110],[0,2,2,1],[0,4,2,10],[0,0,4,2],[0,4,4,6]]}];function Lt(i){let o=new He,e=new Ge(144),n=new Ne(e).load(i);return n&&(o.stones=n,o.update()),o}var $r=(i,o)=>({current:i,total:o});function Hr(i,o){if(i&1){let e=A();p(0,"div",0)(1,"div",3)(2,"h1"),f(3),h(4,"translate"),m(),p(5,"p",4),f(6),h(7,"translate"),m(),p(8,"ul",5)(9,"li"),f(10),h(11,"translate"),m(),p(12,"li"),f(13),h(14,"translate"),m(),p(15,"li"),f(16),h(17,"translate"),m()(),p(18,"div",6)(19,"button",7),b("click",function(){x(e);let n=C();return y(n.start())}),f(20),h(21,"translate"),m(),p(22,"button",8),b("click",function(){x(e);let n=C();return y(n.skip())}),f(23),h(24,"translate"),m()()()()}i&2&&(l(3),M(u(4,7,"TUTORIAL_WELCOME_TITLE")),l(3),M(u(7,9,"TUTORIAL_WELCOME_DESC")),l(4),M(u(11,11,"TUTORIAL_WELCOME_BENEFIT_1")),l(3),M(u(14,13,"TUTORIAL_WELCOME_BENEFIT_2")),l(3),M(u(17,15,"TUTORIAL_WELCOME_BENEFIT_3")),l(4),M(u(21,17,"TUTORIAL_WELCOME_START")),l(3),M(u(24,19,"TUTORIAL_SKIP")))}function Ur(i,o){if(i&1){let e=A();p(0,"div",1)(1,"h2"),f(2),h(3,"translate"),m(),p(4,"p"),f(5),h(6,"translate"),m(),p(7,"button",7),b("click",function(){x(e);let n=C();return y(n.completed.emit())}),f(8),h(9,"translate"),m()()}i&2&&(l(2),M(u(3,3,"TUTORIAL_COMPLETE_TITLE")),l(3),M(u(6,5,"TUTORIAL_COMPLETE_DESC")),l(3),M(u(9,7,"TUTORIAL_START_PLAYING")))}function zr(i,o){if(i&1&&(p(0,"div",12),f(1),h(2,"translate"),m()),i&2){let e=C(2);l(),M(u(2,1,e.feedbackKey()))}}function Kr(i,o){if(i&1){let e=A();p(0,"div",2)(1,"div",9)(2,"h2"),f(3),h(4,"translate"),m(),p(5,"p"),f(6),h(7,"translate"),m()(),p(8,"div",10)(9,"app-board",11),b("clickEvent",function(n){x(e);let r=C();return y(r.onStoneClick(n))}),m(),T(10,zr,3,3,"div",12),m(),p(11,"div",13)(12,"span",14),f(13),h(14,"translate"),m(),p(15,"div",15)(16,"button",16),b("click",function(){x(e);let n=C();return y(n.next())}),f(17),h(18,"translate"),m(),p(19,"button",8),b("click",function(){x(e);let n=C();return y(n.skip())}),f(20),h(21,"translate"),m()()()()}if(i&2){let e=C();l(3),M(u(4,12,e.currentStep.titleKey)),l(3),M(u(7,14,e.currentStep.descriptionKey)),l(3),O("stones",e.board.stones)("theme",e.app.settings.theme)("imageSet",e.app.settings.tileset)("kyodaiUrl",e.app.settings.kyodaiUrl)("background","")("noRotate",!0),l(),L(e.feedbackKey()?10:-1),l(3),M(at(14,16,"TUTORIAL_STEP",yn(23,$r,e.currentStepIndex()+1,e.steps.length))),l(4),M(u(18,19,"TUTORIAL_NEXT")),l(3),M(u(21,21,"TUTORIAL_SKIP"))}}var Vi=(()=>{class i{constructor(){this.completed=me(),this.currentStepIndex=Ft(-1),this.feedbackKey=Ft(void 0),this.steps=Ri,this.app=k(he),this.sound=this.app.game.sound,this.board=Lt(this.steps[0].board)}get currentStep(){return this.steps[this.currentStepIndex()]}onStoneClick(e){if(!e){this.board.clearSelection();return}if(!e.picked){if(e.state.blocked){this.sound.play(ie.NOPE),this.wiggleStone(e),this.showFeedback("TUTORIAL_FEEDBACK_BLOCKED");return}this.board.selected&&e!==this.board.selected?e.groupNr===this.board.selected.groupNr?(this.board.pick(this.board.selected,e),this.sound.play(ie.MATCH),this.board.count===0&&this.onStepComplete()):(this.board.setStoneSelected(e),this.sound.play(ie.SELECT)):(this.board.setStoneSelected(this.board.selected===e?void 0:e),this.sound.play(ie.SELECT))}}start(){this.currentStepIndex.set(0),this.board=Lt(this.steps[0].board)}next(){let e=this.currentStepIndex()+1;this.currentStepIndex.set(e),e<this.steps.length&&(this.board=Lt(this.steps[e].board))}skip(){this.completed.emit()}onStepComplete(){this.sound.play(ie.WIN),setTimeout(()=>{this.next()},800)}wiggleStone(e){e.effects=e.effects||{},e.effects.wiggle=!0,setTimeout(()=>{e.effects&&(e.effects.wiggle=!1)},300)}showFeedback(e){clearTimeout(this.feedbackTimer),this.feedbackKey.set(e),this.feedbackTimer=setTimeout(()=>{this.feedbackKey.set(void 0)},2e3)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-tutorial"]],outputs:{completed:"completed"},decls:3,vars:1,consts:[[1,"tutorial-welcome"],[1,"tutorial-complete"],[1,"tutorial-main"],[1,"tutorial-welcome-content"],[1,"lead"],[1,"welcome-benefits"],[1,"tutorial-welcome-actions"],[1,"tutorial-btn-primary",3,"click"],[1,"tutorial-btn-skip",3,"click"],[1,"tutorial-instruction"],[1,"tutorial-board"],[3,"clickEvent","stones","theme","imageSet","kyodaiUrl","background","noRotate"],[1,"tutorial-feedback"],[1,"tutorial-footer"],[1,"tutorial-progress"],[1,"tutorial-actions"],[1,"tutorial-btn-next",3,"click"]],template:function(t,n){t&1&&T(0,Hr,25,21,"div",0)(1,Ur,10,9,"div",1)(2,Kr,22,26,"div",2),t&2&&L(n.currentStepIndex()===-1?0:n.currentStepIndex()===n.steps.length?1:2)},dependencies:[Tt,Z],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:hidden;border-top:1px solid var(--main-bg-color-lt);padding-top:20px}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]{padding-top:0}}@media only screen and (max-height:400px){[_nghost-%COMP%]{border-top:none}}.tutorial-welcome[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:1em}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]{text-align:center;padding:1.2em}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .4em;font-size:1.5em;color:var(--dialog-headline-color)}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{margin:0 0 .8em;font-size:1em;color:var(--main-content-text-color)}@media only screen and (width>=400px)and (height<=600px){.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   .lead[_ngcontent-%COMP%]{margin:0 auto .8em;max-width:90%}}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   .welcome-benefits[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 1em}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   .welcome-benefits[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.95em;opacity:.95}.tutorial-welcome[_ngcontent-%COMP%]   .tutorial-welcome-content[_ngcontent-%COMP%]   .tutorial-welcome-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.7em;margin:.6em 0 .4em}@media only screen and (width>=400px)and (height<=600px){.tutorial-welcome[_ngcontent-%COMP%]{padding:0}}.tutorial-main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}@media only screen and (width>=400px)and (height<=600px){.tutorial-main[_ngcontent-%COMP%]{display:grid;grid-template-columns:40% 1fr;grid-template-rows:auto 1fr auto;gap:.5em;padding:.5em}}.tutorial-instruction[_ngcontent-%COMP%]{text-align:center;padding:0 1em .5em}.tutorial-instruction[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .3em;color:var(--dialog-headline-color);font-size:1.2em}.tutorial-instruction[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;line-height:1.5;font-size:.95em}@media only screen and (width>=400px)and (height<=600px){.tutorial-instruction[_ngcontent-%COMP%]{grid-column:1;grid-row:1;padding:0;text-align:left}.tutorial-instruction[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1em;margin:0 0 .25em}.tutorial-instruction[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85em;line-height:1.4}}.tutorial-board[_ngcontent-%COMP%]{flex:1;display:flex;position:relative;overflow:hidden}.tutorial-board[_ngcontent-%COMP%]   app-board[_ngcontent-%COMP%]{display:flex;flex:1}@media only screen and (width>=400px)and (height<=600px){.tutorial-board[_ngcontent-%COMP%]{grid-column:2;grid-row:1/4;min-height:0;border-left:1px solid var(--main-bg-color-lt);margin-left:10px}}.tutorial-feedback[_ngcontent-%COMP%]{position:absolute;bottom:12px;left:50%;transform:translate(-50%);background:var(--dialog-background-color);border:1px solid var(--main-bg-color-lt);border-radius:8px;padding:.5em 1.2em;font-size:.9em;animation:_ngcontent-%COMP%_tutorial-feedback-in .2s ease-out;pointer-events:none;text-align:center;max-width:calc(100% - 24px)}@keyframes _ngcontent-%COMP%_tutorial-feedback-in{0%{opacity:0;transform:translate(-50%) translateY(8px)}to{opacity:1;transform:translate(-50%) translateY(0)}}.tutorial-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.7em 0 0;border-top:1px solid var(--main-bg-color-lt)}@media only screen and (width>=400px)and (height<=600px){.tutorial-footer[_ngcontent-%COMP%]{grid-column:1;grid-row:3;gap:.5em;padding:0;border-top:none;align-self:end;flex-direction:column;justify-content:center}}.tutorial-progress[_ngcontent-%COMP%]{font-size:.85em;opacity:.7}.tutorial-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.tutorial-complete[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:1em}.tutorial-complete[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5em;color:var(--dialog-headline-color);font-size:1.3em}.tutorial-complete[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5em;line-height:1.5;font-size:.95em}.tutorial-btn-next[_ngcontent-%COMP%]{display:none}.tutorial-btn-primary[_ngcontent-%COMP%]{font-size:1em;border-width:3px}"]})}}return i})();var Fi=(()=>{class i{transform(e){return e===je}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ye({name:"gameModeEasy",type:i,pure:!0})}}return i})(),Ni=(()=>{class i{transform(e){return e===je||e===jn}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ye({name:"gameModeStandard",type:i,pure:!0})}}return i})();var Yr=["info"],qr=["settings"],Xr=["help"],Wr=["newgame"],Zr=["tutorial"];function Qr(i,o){if(i&1){let e=A();p(0,"button",24),h(1,"translate"),b("click",function(){x(e);let n=C();return y(n.enterFullScreen())}),S(2,"i",40),m()}i&2&&O("title",G(u(1,2,"FULLSCREEN")))}function Jr(i,o){if(i&1){let e=A();p(0,"app-tutorial",41),b("completed",function(){x(e);let n=C();return y(n.completeTutorial())}),m()}}function ea(i,o){if(i&1){let e=A();p(0,"app-help",42),b("showTutorial",function(){x(e);let n=C();return ve(77).toggle(),y(n.showTutorial())}),m()}}function ta(i,o){i&1&&S(0,"app-tiles-info")}function na(i,o){i&1&&S(0,"app-settings")}function ia(i,o){if(i&1){let e=A();p(0,"app-choose-layout",43),b("startEvent",function(n){x(e);let r=C();return y(r.startGame(n))}),m()}if(i&2){let e=C();O("gameMode",e.game.mode)}}function oa(i,o){if(i&1&&(p(0,"div"),f(1),h(2,"translate"),m()),i&2){let e=C(2);l(),M(u(2,1,e.game.message.messageID))}}function ra(i,o){if(i&1&&(p(0,"div"),f(1),h(2,"duration"),m()),i&2){let e=C(2);l(),M(u(2,1,e.game.message.playTime))}}function aa(i,o){if(i&1){let e=A();p(0,"div",45)(1,"button",46),b("click",function(n){x(e);let r=C(2);return y(r.onShuffleContinue(n))}),S(2,"i",14),p(3,"span",12),f(4),h(5,"translate"),m()(),p(6,"button",47),b("click",function(n){x(e);let r=C(2);return y(r.onSurrenderGame(n))}),S(7,"i",17),p(8,"span",12),f(9),h(10,"translate"),m()()()}i&2&&(l(4),M(u(5,2,"SHUFFLE")),l(5),M(u(10,4,"RESTART")))}function sa(i,o){if(i&1){let e=A();p(0,"div",44),b("click",function(){x(e);let n=C();return y(n.clickMessage())}),T(1,oa,3,3,"div"),T(2,ra,3,3,"div"),T(3,aa,11,6,"div",45),m()}if(i&2){let e=C();l(),L(e.game.message.messageID?1:-1),l(),L(e.game.message.playTime?2:-1),l(),L(e.game.message.askShuffle?3:-1)}}var ji=(()=>{class i{constructor(){this.info=_e.required("info"),this.settings=_e.required("settings"),this.help=_e.required("help"),this.newgame=_e.required("newgame"),this.tutorial=_e.required("tutorial"),this.app=k(he),this.fullScreenEnabled=!0,this.title="",this.injector=k(fn),this.game=this.app.game,this.fullScreenEnabled=this.canFullscreen(),this.title=`${this.app.name} v${Q.version}`}showTutorial(){this.tutorial().visible.set(!0)}completeTutorial(){this.tutorial().visible.set(!1),this.app.settings.tutorialCompleted=!0,this.app.settings.save(),this.app.game.isIdle()&&this.showNewGame()}start(){this.app.settings.tutorialCompleted?this.showNewGame():this.showTutorial()}showNewGame(){this.newgame().visible.set(!0)}handleKeyDownEventKey(e){switch(e){case"h":{this.help().toggle();break}case"i":{this.info().toggle();break}case"s":{this.settings().toggle();break}case"t":{this.game.hint();break}case"m":{this.game.shuffle();break}case"g":{this.debugSolve().catch(console.error);break}case"u":{this.game.back();break}case"n":{this.game.pause(),this.newgame().toggle();break}case" ":case"space":case"Space":case"spacebar":case"Spacebar":case"p":{this.game.isRunning()?this.game.pause():this.game.isPaused()&&this.game.resume();break}default:return!1}return!0}handleKeyDownDialogExit(){if(this.tutorial().visible())return this.completeTutorial(),!0;let t=this.help();if(t.visible())return t.toggle(),!0;let n=this.newgame();if(n.visible())return n.toggle(),!0;let r=this.info();if(r.visible())return r.toggle(),!0;let a=this.settings();return a.visible()?(a.toggle(),!0):!1}handleKeyDownEvent(e){e.key==="Escape"&&this.handleKeyDownDialogExit()||(e.target?.nodeName??"").toLocaleLowerCase()==="input"||this.handleKeyDownEventKey(e.key)&&e.preventDefault()}stoneClick(e){this.game.click(e)}isFullscreenEnabled(){let e=window.document;if(typeof e.fullscreenEnabled=="boolean")return e.fullscreenEnabled;let t=document.documentElement;return!!(t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen)}canFullscreen(){return Q.mobile?!1:this.isFullscreenEnabled()}isFullscreen(){let e=window.document;return!!(e.fullscreenElement||e.webkitIsFullScreen||e.mozFullScreen)}exitFullscreen(){let e=window.document;e.exitFullscreen?e.exitFullscreen().catch(t=>{console.error(t)}):e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()}requestFullscreen(){let e=document.body;e.requestFullscreen?e.requestFullscreen().catch(t=>{console.error(t)}):e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}enterFullScreen(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()}newGame(){this.game.pause(),this.showNewGame()}startGame(e){this.newgame().visible.set(!1),this.game.reset(),this.game.start(e.layout,e.buildMode,e.gameMode)}toggleDialogState(e){e?this.app.game.isPaused()||this.app.game.pause():(this.app.settings.save(),this.app.game.isPaused()&&this.app.game.resume())}clickMessage(){if(this.game.isPaused()){if(this.game.message?.askShuffle)return;this.game.resume()}else this.game.reset(),this.showNewGame()}onShuffleContinue(e){e.stopPropagation(),this.game.gameOverEasyModeShuffle()}onSurrenderGame(e){e.stopPropagation(),this.game.surrender(),this.showNewGame()}debugSolve(){return ce(this,null,function*(){if(Q.production)return;let{WorkerService:e}=yield import("./chunk-3AFPWP2T.js"),t=this.injector.get(e),n=(r,a)=>{let s=a[r],c=a[r+1];if(!s||!c)return;let d=this.game.board.stones.filter(g=>g.z===s[0]&&g.x===s[1]&&g.y===s[2]||g.z===c[0]&&g.x===c[1]&&g.y===c[2]);if(d.length>1){for(let g of d)g.selected=!0;setTimeout(()=>{this.game.board.pick(d[0],d[1]),n(r+2,a)},300)}};t.solveGame(this.game.board.stones.filter(r=>!r.picked).map(r=>r.toPosition()),r=>{n(0,r.order)})})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-game-component"]],viewQuery:function(t,n){t&1&&Te(n.info,Yr,5)(n.settings,qr,5)(n.help,Xr,5)(n.newgame,Wr,5)(n.tutorial,Zr,5),t&2&&Le(5)},hostBindings:function(t,n){t&1&&b("keydown",function(a){return n.handleKeyDownEvent(a)},nt)},decls:93,vars:106,consts:[["tutorial",""],["help",""],["info",""],["settings",""],["newgame",""],[1,"controls","controls-top"],[1,"ctrl","ctrl-name"],[1,"button",3,"click","title"],[1,"icon-logo"],[1,"name"],[1,"ctrl","ctrl-game"],[1,"icon-pause"],[1,"label"],[1,"button","feature",3,"click","title"],[1,"icon-spin1"],[1,"icon-undo"],[1,"icon-lightbulb"],[1,"icon-loop"],[1,"board",3,"clickEvent","stones","theme","imageSet","kyodaiUrl","background","pattern"],[1,"controls","controls-bottom"],[1,"ctrl","ctrl-stats"],["title","Menu","aria-haspopup","true",1,"button","menu-button"],[1,"icon-menu"],["role","menu",1,"menu"],["role","menuitem",1,"button",3,"click","title"],[1,"icon-cog"],[1,"icon-volume-low"],[1,"icon-calendar"],["role","menuitem",1,"button",3,"title"],[1,"ctrl","ctrl-time"],[1,"label","text"],[1,"time"],["className","overlay-tutorial",3,"clickEvent","noCloseButton","allowCloseOverlay","title"],["className","overlay-help",3,"clickEvent","title"],["className","overlay-info",3,"clickEvent","title"],["className","overlay-settings",3,"clickEvent","title"],["className","overlay-newgame",3,"clickEvent","title"],[1,"choose",3,"gameMode"],["className","overlay-message",3,"clickEvent","visible","noCloseButton"],[1,"overlay-message-message"],[1,"icon-resize-full-alt"],[3,"completed"],[3,"showTutorial"],[1,"choose",3,"startEvent","gameMode"],[1,"overlay-message-message",3,"click"],[1,"overlay-message-actions"],[1,"button","feature",3,"click"],[1,"button",3,"click"]],template:function(t,n){if(t&1){let r=A();p(0,"div",5)(1,"div",6)(2,"button",7),h(3,"translate"),b("click",function(){x(r);let s=ve(77);return y(s.toggle())}),S(4,"i",8),p(5,"span",9),f(6),m()()(),p(7,"div",10)(8,"button",7),h(9,"translate"),b("click",function(){return x(r),y(n.game.toggle())}),S(10,"i",11),p(11,"span",12),f(12),h(13,"translate"),m()(),p(14,"button",13),h(15,"gameModeEasy"),h(16,"translate"),b("click",function(){return x(r),y(n.game.shuffle())}),S(17,"i",14),p(18,"span",12),f(19),h(20,"translate"),m()(),p(21,"button",13),h(22,"gameModeStandard"),h(23,"translate"),b("click",function(){return x(r),y(n.game.back())}),S(24,"i",15),p(25,"span",12),f(26),h(27,"translate"),m()(),p(28,"button",13),h(29,"gameModeStandard"),h(30,"translate"),b("click",function(){return x(r),y(n.game.hint())}),S(31,"i",16),p(32,"span",12),f(33),h(34,"translate"),m()(),p(35,"button",7),h(36,"translate"),b("click",function(){return x(r),y(n.newGame())}),S(37,"i",17),p(38,"span",12),f(39),h(40,"translate"),m()()()(),p(41,"app-board",18),b("clickEvent",function(s){return x(r),y(n.stoneClick(s))}),m(),p(42,"div",19)(43,"div",20)(44,"button",21),S(45,"i",22),m(),p(46,"div",23)(47,"button",24),h(48,"translate"),b("click",function(){x(r);let s=ve(84);return y(s.toggle())}),S(49,"i",25),m(),p(50,"button",24),h(51,"translate"),b("click",function(){return x(r),y(n.app.toggleSound())}),S(52,"i",26),m(),p(53,"button",24),h(54,"translate"),b("click",function(){x(r);let s=ve(80);return y(s.toggle())}),S(55,"i",27),m(),T(56,Qr,3,4,"button",28),m()(),p(57,"div",29)(58,"span",30)(59,"small"),f(60),h(61,"translate"),m(),p(62,"span"),f(63),m()(),p(64,"span",30)(65,"small"),f(66),h(67,"translate"),m(),p(68,"span"),f(69),m()(),p(70,"span",31),f(71),h(72,"duration"),m()()(),p(73,"app-dialog",32,0),b("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(75,Jr,1,0,"app-tutorial"),m(),p(76,"app-dialog",33,1),b("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(78,ea,1,0,"app-help"),m(),p(79,"app-dialog",34,2),h(81,"translate"),b("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(82,ta,1,0,"app-tiles-info"),m(),p(83,"app-dialog",35,3),h(85,"translate"),b("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(86,na,1,0,"app-settings"),m(),p(87,"app-dialog",36,4),h(89,"translate"),b("clickEvent",function(s){return x(r),y(n.toggleDialogState(s))}),T(90,ia,1,1,"app-choose-layout",37),m(),p(91,"app-dialog",38),b("clickEvent",function(){return x(r),y(n.clickMessage())}),T(92,sa,4,3,"div",39),m()}if(t&2){let r=ve(74),a=ve(77),s=ve(80),c=ve(84),d=ve(88);l(2),O("title",G(u(3,60,"OPEN_HELP"))),l(4),M(n.app.name),l(2),O("title",G(u(9,62,"PAUSE_LONG"))),l(4),M(u(13,64,"PAUSE")),l(2),ee("enabled",u(15,66,n.game.mode)),O("title",G(u(16,68,"SHUFFLE_LONG"))),l(5),M(u(20,70,"SHUFFLE")),l(2),ee("enabled",u(22,72,n.game.mode)),O("title",G(u(23,74,"UNDO_LONG"))),ne("disabled",n.game.board.undo.length===0?!0:null),l(5),M(u(27,76,"UNDO")),l(2),ee("enabled",u(29,78,n.game.mode)),O("title",G(u(30,80,"HINT_LONG"))),l(5),M(u(34,82,"HINT")),l(2),O("title",G(u(36,84,"RESTART_LONG"))),l(4),M(u(40,86,"RESTART")),l(2),O("stones",n.game.board.stones)("theme",n.app.settings.theme)("imageSet",n.app.settings.tileset)("kyodaiUrl",n.app.settings.kyodaiUrl)("background",n.app.settings.background)("pattern",n.app.settings.pattern),l(6),O("title",G(u(48,88,"OPEN_SETTINGS"))),l(3),ee("inactive",!n.app.settings.sounds),O("title",G(u(51,90,"AUDIO_SOUNDS"))),l(3),O("title",G(u(54,92,"TILES_INFO"))),l(3),L(n.fullScreenEnabled?56:-1),l(4),K("",u(61,94,"STONES"),":"),l(3),M(n.game.board.count),l(3),K("",u(67,96,"FREE"),":"),l(3),M(n.game.board.free.length),l(2),M(u(72,98,n.game.clock.elapsed)),l(2),O("noCloseButton",!0)("allowCloseOverlay",!1)("title",n.app.name),l(2),L(r.visible()?75:-1),l(),O("title",n.title),l(2),L(a.visible()?78:-1),l(),O("title",u(81,100,"TILES")),l(3),L(s.visible()?82:-1),l(),O("title",u(85,102,"SETTINGS")),l(3),L(c.visible()?86:-1),l(),O("title",u(89,104,"SELECT_BOARD")),l(3),L(d.visible()?90:-1),l(),O("visible",!!n.game.message)("noCloseButton",!0),l(),L(n.game.message?92:-1)}},dependencies:[Tt,ti,li,mi,Ii,Vi,ei,Ot,Ni,Fi,Z],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column nowrap;width:100%;height:100%;background-color:var(--main-bg-color)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{min-width:170px;display:flex;justify-content:space-between;padding-left:12px;padding-right:12px}@media only screen and (min-width:3000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:4em}}@media only screen and (max-width:2200px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.6em}}@media only screen and (max-width:1900px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.3em}}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{font-size:1.2em}}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{color:var(--main-text-color);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{padding:.3em .9em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{text-decoration:none;font-weight:500;color:var(--main-text-color);padding:.3em .9em;border-radius:10px;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease,transform .05s ease}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] + .label[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{color:var(--main-text-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .link[disabled][_ngcontent-%COMP%]{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:6px;border-radius:10px;font-family:Kulim Park,Tahoma,sans-serif;color:var(--main-text-color);padding:.3em .9em;cursor:pointer;border:1px solid transparent;background-clip:padding-box;transition:color .15s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease,transform .05s ease;background-color:transparent;font-size:inherit}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{background-image:linear-gradient(to bottom,color-mix(in oklab,var(--main-bg-color-lt) 35%,transparent),color-mix(in oklab,var(--main-bg-color) 90%,transparent));border:1px solid color-mix(in oklab,var(--main-bg-color-lt) 70%,transparent);background-color:color-mix(in oklab,var(--main-bg-color) 78%,transparent);color:var(--main-text-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:inset 0 1px 1px #00000026,0 0 #0000}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:focus-visible{outline:none;box-shadow:0 0 0 2px var(--main-bg-color),0 0 0 4px var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[disabled][_ngcontent-%COMP%]{opacity:.55;cursor:not-allowed;pointer-events:none;filter:saturate(.75)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .feature.enabled[_ngcontent-%COMP%]{display:unset}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]{font-weight:600;cursor:pointer}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-name[_ngcontent-%COMP%]   .icon-logo[_ngcontent-%COMP%]{color:red}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]:hover{color:var(--main-text-color-dk)}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]{cursor:default;gap:24px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-variant-numeric:lining-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-right:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-family:Kulim Park,Tahoma,sans-serif;min-width:98px;display:inline-block;text-align:center;font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{cursor:default}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:none;width:2.2em;height:2.2em;padding:0;border-radius:999px;justify-content:center;align-items:center}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.05em}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{border-bottom:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{border-top:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .board[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1;overflow:hidden}@media only screen and (max-width:1000px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1.2em;padding:.3em}[_nghost-%COMP%]   .time[_ngcontent-%COMP%]{padding:.3em}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:700px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1.1em}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{min-width:unset}}@media only screen and (max-width:500px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:1em}}@media only screen and (max-width:400px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:.9em}}@media only screen and (max-width:350px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:.8em}[_nghost-%COMP%]   span.name[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width:280px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{gap:2px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:none;position:absolute;bottom:100%;right:0;background:var(--dialog-background-color);border:1px solid var(--dialog-border-color);border-radius:8px;flex-direction:column;z-index:10;gap:6px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{padding:0;margin-left:0;width:2.2em;height:2.2em;border-radius:8px}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.05em}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:hover   .menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl.ctrl-stats[_ngcontent-%COMP%]:focus-within   .menu[_ngcontent-%COMP%]{display:flex}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]{flex-direction:row;position:relative;padding-left:calc(52px + env(safe-area-inset-left));padding-right:calc(52px + env(safe-area-inset-right))}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%], [_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl-name[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl-name[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-top[_ngcontent-%COMP%]{flex-direction:column;min-width:unset;max-width:52px;height:calc(100% - env(safe-area-inset-top) - env(safe-area-inset-bottom));position:absolute;left:env(safe-area-inset-left);border-bottom:unset}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]{flex-direction:column;min-width:98px;max-width:98px;height:calc(100% - env(safe-area-inset-top) - env(safe-area-inset-bottom));position:absolute;right:env(safe-area-inset-right);align-items:flex-end;border-top:unset}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]{align-items:flex-end}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .controls-bottom[_ngcontent-%COMP%]   .ctrl.ctrl-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{padding-right:.3em;min-width:unset}}@media only screen and (width>=400px)and (height<=260px){[_nghost-%COMP%]   .controls[_ngcontent-%COMP%]   .ctrl[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{padding:.1em}}"]})}}return i})();var la=["gameComponent"],ca=["editorPlaceholder"];function da(i,o){if(i&1&&S(0,"app-game-component",3,1),i&2){let e=C();Me("theme-"+e.app.settings.theme),O("hidden",e.loading)}}function pa(i,o){}var Gi=(()=>{class i{constructor(){this.gameComponent=_e.required("gameComponent"),this.editorPlaceholder=_e.required("editorPlaceholder",{read:Nt}),this.app=k(he),this.loading=!0,this.editorVisible=!1,this.layoutService=k(Pe),this.ngZone=k(Cn),this.meta=k(Dn),this.updateName(),this.registerWindowListeners()}ngOnInit(){this.init().catch(e=>{console.error(e)})}handleKeyDownEvent(e){(e.target?.nodeName??"").toLocaleLowerCase()!=="input"&&Q.editor&&e.key==="e"&&(this.toggleEditor(),e.preventDefault())}loadEditor(){Q.editor&&import("./chunk-R7SB2ZP3.js").then(({EditorComponent:e})=>{let t=this.editorPlaceholder().createComponent(e);this.editorSubscription=t.instance.closeEvent.subscribe(()=>{this.toggleEditor()})}).catch(e=>{console.error(e)})}toggleEditor(){Q.editor&&(this.editorVisible=!this.editorVisible,this.editorVisible?(this.app.game.pause(),this.loadEditor()):(this.editorSubscription&&(this.editorSubscription.unsubscribe(),this.editorSubscription=void 0),this.editorPlaceholder().clear()))}init(){return ce(this,null,function*(){yield this.layoutService.get(),this.loading=!1;let e=new URLSearchParams(window.location.search),t=yield this.checkImport(e.get("mah"));this.layoutService.selectBoardID=t[0]||e.get("board"),window.location.search&&this.clearSearchParameters(),(this.app.game.isIdle()||this.layoutService.selectBoardID)&&this.gameComponent().start()})}clearSearchParameters(){try{window.history.replaceState(null,"",window.location.pathname)}catch(e){console.error(e)}}checkImport(e){return ce(this,null,function*(){if(!e)return[];try{let t=[],n=JSON.parse(atob(e)),r=[];for(let a of n.boards){let s=this.layoutService.expandLayout(a,!0);t.push(s.id),!this.layoutService.layouts.items.some(c=>c.id===s.id)&&!r.some(c=>c.id===s.id)&&r.push(Pe.layout2loadLayout(s,a.map))}return r.length>0&&this.layoutService.storeCustomBoards(r),t}catch(t){return console.error(t),[]}})}registerWindowListeners(){if(window.addEventListener("beforeunload",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1),window.addEventListener("blur",()=>{this.app.game.isRunning()&&this.app.game.pause()},!1),Q.onWindowBlur){Q.onWindowBlur(()=>{this.app.game.isRunning()&&this.ngZone.run(()=>{this.app.game.pause()})});return}}updateName(){let e=this.meta.getTag("name=application-name");this.app.name=e?e.content:this.app.name}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=$({type:i,selectors:[["app-root"]],viewQuery:function(t,n){t&1&&Te(n.gameComponent,la,5)(n.editorPlaceholder,ca,5,Nt),t&2&&Le(2)},hostBindings:function(t,n){t&1&&b("keydown",function(a){return n.handleKeyDownEvent(a)},nt)},decls:3,vars:1,consts:[["editorPlaceholder",""],["gameComponent",""],[3,"hidden","class"],[3,"hidden"]],template:function(t,n){t&1&&(T(0,da,2,3,"app-game-component",2),bn(1,pa,0,0,"ng-template",null,0,wn)),t&2&&L(n.editorVisible?-1:0)},dependencies:[ji],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}"]})}}return i})();var en=new un("TRANSLATE_HTTP_LOADER_CONFIG"),ga=(()=>{class i{http;config;constructor(){this.config=dn({prefix:"/assets/i18n/",suffix:".json",enforceLoading:!1,useHttpBackend:!1},k(en)),this.http=this.config.useHttpBackend?new Ie(k(jt)):k(Ie)}getTranslation(e){let t=this.config.enforceLoading?`?enforceLoading=${Date.now()}`:"";return this.http.get(`${this.config.prefix}${e}${this.config.suffix}${t}`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Oe({token:i,factory:i.\u0275fac})}return i})();function $i(i={}){let o=i.useHttpBackend??!1;return[{provide:en,useValue:i},{provide:An,useClass:ga,deps:[o?jt:Ie,en]}]}Q.production&&void 0;Tn(Gi,{providers:[kn(),_n(Ln,Sn,...Q.modules),Rn({loader:$i({prefix:"./assets/i18n/",suffix:".json"}),fallbackLang:"en"}),he,Pe,ze,Ct,In(Bn())]}).catch(console.error);
