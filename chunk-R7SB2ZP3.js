import{A as W,a as xt,b as ft,l as tt,m as Z,q as vt,r as et,s as J,t as Ot,u as yt,w as Mt,y as R,z as U}from"./chunk-46TAORT7.js";import{a as nt}from"./chunk-YGV5J4XL.js";import{Aa as ct,Ab as at,D as S,Gb as $,Ha as G,Ia as P,J as h,Ja as b,K as C,Ka as pt,L as z,La as j,Ma as I,Na as B,Oa as f,Pa as s,Qa as c,Ra as v,Sa as F,Ta as Y,U as A,Ua as q,Va as w,Xa as u,Ya as Q,Za as p,ab as dt,b as N,bb as mt,eb as T,fb as _t,gb as g,hb as M,ib as E,jb as L,kb as y,mb as ut,nb as gt,ob as m,pa as rt,pb as _,qa as a,sb as k,tb as V,ub as ht,vb as Ct,ya as D}from"./chunk-XEHCUY67.js";var X=class{constructor(){this.levels=[],this.init(2,2,1)}init(r,t,n){let e=[];for(let o=0;o<n;o++){e[o]=[];for(let l=0;l<r;l++){e[o][l]=[];for(let d=0;d<t;d++)e[o][l][d]=0}}this.levels=e}clear(){let r=this.levels;for(let t of r)for(let n of t)for(let e=0;e<n.length;e++)n[e]=0}inBounds(r,t,n){let e=r>=0&&t>=0&&n>=0,o=r<this.levels.length&&t<this.levels[0].length&&n<this.levels[0][0].length;return e&&o}isTile(r,t,n){return this.levels[r][t][n]>0}isTilePosInvalid(r,t,n){let e=this.levels[r];if(!e[t+1]||e[t].length-1===n)return!0;let o=(d,x)=>{let O=e[t+d];return O&&O[n+x]||0};return[[0,1],[-1,1],[-1,-1],[1,0],[1,-1],[1,1]].some(([d,x])=>o(d,x)>0)}isTilePosBlocked(r,t,n){let e=this.levels[r];return e[t][n-1]>0?!0:e[t-1]?e[t-1][n]>0?!0:e[t-1][n-1]>0:!1}get(r,t,n){return this.levels[r][t][n]||0}setValue(r,t,n,e){this.levels[r][t][n]=e}applyMapping(r,t,n,e){let o=J(r,t,n,e);this.init(o.x+1,o.y+1,o.z);for(let l of r){let d=l[0],x=l[1],O=l[2];this.setValue(d,x,O,1)}}};function $t(i){return i.sort((r,t)=>r[0]<t[0]?-1:r[0]>t[0]?1:r[1]<t[1]?-1:r[1]>t[1]?1:r[2]<t[2]?-1:r[2]>t[2]?1:0)}function Xt(i,r,t,n,e){return N(this,null,function*(){let o=r*t,l=o*i;if(e.length!==l)return Promise.reject(new Error("Invalid Matrix Pattern length"));let d={name:n,cat:"Kyodai",mapping:[]};for(let x=0;x<i;x++){let O=e.slice(x*o,(x+1)*o);for(let K=0;K<r;K++){let Zt=[...O.slice(K*t,(K+1)*t)];for(let[At,Yt]of Zt.entries())Yt==="1"&&d.mapping.push([x,At,K])}}return d})}function zt(i,r){return N(this,null,function*(){return Xt(5,20,34,i,r)})}function Pt(i,r){return N(this,null,function*(){let t=[];for(let[n,e]of i.entries()){let o=Math.floor(n/r),l=n%r;for(let[d,x]of[...e].entries())x==="1"&&t.push([o,d,l])}return t})}function Gt(i,r){return N(this,null,function*(){let t=i.replace(/\r\n/g,`
`).split(`
`),n=r.split(".");n.pop();let e=t.shift()??"",o={name:n.join(".").replace(/_/g," "),cat:"uncategorized",mapping:[]};if(["kmahjongg-layout-v1.0"].includes(e))return o.by="KDE Games team",o.mapping=yield Pt(t.filter(l=>!l.startsWith("#")),16),o;if(["kmahjongg-layout-v1.1"].includes(e)){let l=Number((t.find(O=>O.startsWith("h"))??"h16").split("").slice().join("")),d=(t.find(O=>O.startsWith("# name:"))??"").slice(7).trim();o.name=d??o.name,o.name=o.name.length===0?r.split(".")[0]:o.name;let x=(t.find(O=>O.startsWith("# by:"))??"").slice(5).trim();return o.by=x||o.by,t=t.filter(O=>!O.startsWith("h")&&!O.startsWith("w")&&!O.startsWith("d")&&!O.startsWith("#")),o.mapping=yield Pt(t,Number.isNaN(l)?16:l),o}return Promise.reject(new Error(`Unknown .layout format ${JSON.stringify((e??"").slice(0,50))}`))})}function jt(i,r){return N(this,null,function*(){let t=i.replace(/\r\n/g,`
`).split(`
`),n=t[0]||"";if(["Kyodai 3.0","Kyodai 6.0"].includes(n)){let e=(t[1]||"").split("::"),o=e[0].length===0?r.split(".")[0]:e[0],l=e[1]||"uncategorized",d=t[2]||"",x=yield zt(o,d);return x.cat=l||x.cat,x}return Promise.reject(new Error(`Unknown .lay format ${JSON.stringify((n||"").slice(0,50))}`))})}function Ut(i){let r={},t=$t(i);for(let n of t)r[n[0]]=r[n[0]]||{},r[n[0]][n[2]]=r[n[0]][n[2]]||[],r[n[0]][n[2]].push(n[1]);return r}function Wt(i,r,t){let n=t[i][r],e=[],o={start:-1,current:-1,count:0};for(let d of n)d===o.current?(o.current+=2,o.count++):(o={start:d,current:d+2,count:1},e.push(o));let l=e.map(d=>d.count===1?d.start:[d.start,d.count]);return[Number(r),l.length===1&&!Array.isArray(l[0])?l[0]:l]}function it(i){let r=Ut(i),t=[];for(let n of Object.keys(r)){let e=[];for(let o of Object.keys(r[Number(n)]))e.push(Wt(Number(n),Number(o),r));t.push([Number(n),e])}return t}function bt(i){return i.trim().split(" ").map(r=>r[0].toUpperCase()+r.slice(1)).join(" ").replace(/"/g,"").replace(/(^'|'$)/gm,"")}function wt(i){let r=i.name.split(" by ");r.length>1&&(i.name=r[0].trim(),i.by=r[1].trim()),i.name=bt(i.name||""),i.by=i.by?bt(i.by):void 0;let t=W(i.mapping);return{id:et(t),name:i.name.trim(),cat:i.cat.trim(),by:i.by,map:it(t)}}function Ht(i){return N(this,null,function*(){let r=new FileReader;return new Promise((t,n)=>{r.addEventListener("load",()=>{t(r.result)}),r.addEventListener("error",e=>{n(new Error(`Reading File failed: ${e?.target?.error?.message??"unknown error"}`))}),r.readAsText(i,"ascii")})})}function Et(i){return N(this,null,function*(){let r=yield Ht(i),t=(i.name.split(".").pop()??"").toLowerCase(),n;if(t==="lay")n=wt(yield jt(r,i.name));else if(t==="layout")n=wt(yield Gt(r,i.name));else return JSON.parse(r).boards;return[n]})}function Tt(i){return kt([i])}function kt(i){return JSON.stringify(Kt(i))}function lt(i){let r=vt(it(W(i.mapping)));return{id:et(r),name:i.name,by:!i.by||i.by.length===0?void 0:i.by,cat:!i.category||i.category.length===0?void 0:i.category,map:it(r)}}function Kt(i){return{mah:"1.0",boards:i.map(t=>lt(t))}}function St(i){let r=new X,t=J(i.mapping,0,0,0);r.init(t.x+1,t.y+1,t.z);for(let e of i.mapping){let o=e[0],l=e[1],d=e[2];r.setValue(o,l,d,1),r.setValue(o,l+1,d,2),r.setValue(o,l,d+1,4),r.setValue(o,l+1,d+1,3)}let n=["mahjongg-layout-v1.1",`# name: ${i.name}`,`# by: ${i.by}`,`# category: ${i.category}`,"# Board size in quarter tiles",`w${t.x+1}`,`h${t.y+1}`,"# Board depth",`d${t.z}`];for(let[e,o]of r.levels.entries()){let l=`# Level ${e} `;n.push(`${l}${"-".repeat(Math.max(t.x-l.length,0))}`);for(let d=0;d<=t.y;d++){let x=[];for(let O=0;O<=t.x;O++)x.push(o[O][d]||".");n.push(x.join(""))}}return n.join(`
`)}function Jt(i,r,t){let n=J(i,0,0,0),e=Math.max(0,Math.floor((t-n.y)/2)),o=Math.max(0,Math.floor((r-n.x)/2));return i.map(l=>[l[0],l[1]+o,l[2]+e])}function qt(i){let r=new X,t=20,n=34,e=5,o=Jt(i,n,t);r.applyMapping(o,e,n,t);let l=[];for(let d=0;d<e;d++)for(let x=0;x<t;x++)for(let O=0;O<n;O++)l.push(r.get(d,O,x).toString());return l.join("")}function Lt(i){let r=i.by?` by ${i.by}`:"",t=i.category?` :: ${i.category}`:"";return`Kyodai 6.0
${i.name}${r}${t}
${qt(i.mapping)}
`}function Dt(i){st("mah-layouts.mah",kt(i),"text/json")}function st(i,r,t){let n=new Blob([r],{type:t}),e=document.createElement("a");e.href=window.URL.createObjectURL(n),e.download=i,e.click()}function Qt(i,r){if(i&1){let t=w();s(0,"div",0)(1,"div",6)(2,"label"),g(3),m(4,"translate"),c(),s(5,"input",7),u("input",function(e){h(t);let o=p();return C(o.layout().name=e.target.value)})("change",function(){h(t);let e=p();return C(e.update())})("blur",function(){h(t);let e=p();return C(e.update())}),c(),s(6,"label"),g(7),m(8,"translate"),c(),s(9,"input",7),u("input",function(e){h(t);let o=p();return C(o.layout().by=e.target.value)})("change",function(){h(t);let e=p();return C(e.update())})("blur",function(){h(t);let e=p();return C(e.update())}),c(),s(10,"label"),g(11),m(12,"translate"),c(),s(13,"input",7),u("input",function(e){h(t);let o=p();return C(o.layout().category=e.target.value)})("change",function(){h(t);let e=p();return C(e.update())})("blur",function(){h(t);let e=p();return C(e.update())}),c()(),s(14,"div",8),v(15,"app-layout-preview",9),c()()}if(i&2){let t=p();a(3),M(_(4,7,"EDITOR_LAYOUT_NAME")),a(2),f("value",t.layout().name),a(2),M(_(8,9,"EDITOR_LAYOUT_BY")),a(2),f("value",t.layout().by),a(2),M(_(12,11,"EDITOR_LAYOUT_CATEGORY")),a(2),f("value",t.layout().category),a(2),f("layout",t.layout())}}function te(i,r){if(i&1){let t=w();s(0,"li")(1,"input",10),u("change",function(){let e=h(t).$implicit,o=p();return C(o.chooseFormat(e))}),c(),s(2,"label",11),g(3),c()()}if(i&2){let t=r.$implicit,n=p();a(),f("id","format_"+t.name)("value",t)("checked",n.format===t),a(),f("for","format_"+t.name),a(),M(t.name)}}function ee(i,r){if(i&1){let t=w();s(0,"button",4),u("click",function(){h(t);let e=p();return C(e.saveAsCopy())}),g(1),m(2,"translate"),c()}i&2&&(a(),M(_(2,1,"EDITOR_LAYOUT_SAVE_AS_COPY")))}var ne=[{name:"Mah",ext:"mah",func:Tt,type:"text/json"},{name:"Kyodai",ext:"lay",func:Lt,type:"text/lay"},{name:"Kmahjongg",ext:"layout",func:St,type:"text/layout"}],It=(()=>{class i{constructor(){this.layout=V.required(),this.savedEvent=k(),this.exportFormats=ne,this.format=this.exportFormats[0],this.translate=S(tt),this.layoutService=S(R)}ngOnInit(){this.layout()&&this.update()}ngOnChanges(t){t.layout&&this.update()}saveAsCopy(){this.layoutService.storeCustomBoards([this.exportLayout]);let t=this.layout();t.originalId=this.exportLayout.id,this.savedEvent.emit(!0)}save(){if(this.layoutService.layouts.items.some(e=>!e.custom&&e.id===this.exportLayout.id)){alert(this.translate.instant("EDITOR_BUILD_IN_EXISTS"));return}let t=[this.exportLayout.id],n=this.layout();n.originalId&&t.push(n.originalId),this.layoutService.removeCustomLayout(t),this.saveAsCopy()}chooseFormat(t){this.format=t,this.update()}download(){st(this.filename,this.result,this.format.type),this.savedEvent.emit(!0)}update(){let t=this.layout();this.layoutName=t.name.toLocaleLowerCase().replace(/ /g,"_"),this.result=this.format.func(t),this.filename=`${this.layoutName}.${this.format.ext}`,this.exportLayout=lt(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-editor-export-component"]],inputs:{layout:[1,"layout"]},outputs:{savedEvent:"savedEvent"},features:[A],decls:24,vars:16,consts:[[1,"section"],[1,"export"],[1,"export-preview"],[1,"buttons"],[1,"text-button",3,"click"],[1,"text-button"],[1,"inputs"],["type","text",3,"input","change","blur","value"],[1,"preview"],[1,"svg-board",3,"layout"],["type","radio","name","format",3,"change","id","value","checked"],[3,"for"]],template:function(n,e){n&1&&(s(0,"h3"),g(1),m(2,"translate"),m(3,"translate"),c(),P(4,Qt,16,13,"div",0),s(5,"div",1)(6,"label"),g(7,"Format"),c(),s(8,"fieldset")(9,"ul"),I(10,te,4,5,"li",null,j),c()(),s(12,"div",2)(13,"pre"),g(14),c()(),v(15,"br"),s(16,"div",3)(17,"button",4),u("click",function(){return e.download()}),g(18),m(19,"translate"),c(),P(20,ee,3,3,"button",5),s(21,"button",4),u("click",function(){return e.save()}),g(22),m(23,"translate"),c()()()),n&2&&(a(),L("",_(2,8,"EDITOR_SAVE")," / ",_(3,10,"EDITOR_EXPORT")),a(3),b(e.layout()?4:-1),a(6),B(e.exportFormats),a(4),M(e.result),a(4),L("",_(19,12,"EDITOR_LAYOUT_DOWNLOAD")," ",e.filename),a(2),b(e.layout()&&e.layout().originalId&&e.exportLayout.id!==e.layout().originalId?20:-1),a(2),M(_(23,14,"EDITOR_LAYOUT_SAVE")))},dependencies:[U,Z],styles:["[_nghost-%COMP%]{color:var(--main-text-color)}[_nghost-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;padding-top:0;text-align:center}[_nghost-%COMP%]   .preview[_ngcontent-%COMP%]{max-height:180px;min-width:100px;padding-left:10px}[_nghost-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}[_nghost-%COMP%]   .inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px;font-size:16px;margin-bottom:8px}@media only screen and (max-width:400px){[_nghost-%COMP%]   .preview[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{vertical-align:middle;cursor:pointer}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]{margin-left:10px}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   .export-preview[_ngcontent-%COMP%]{margin-top:16px}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   .export-preview[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-line;overflow-wrap:break-word;font-family:monospace;text-align:left;overflow:auto;min-height:180px;max-height:180px;font-size:.8em;line-height:1em;background-color:#000}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{text-align:center;display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;background-color:#0000000d;background-image:none;border:1px solid var(--dialog-border-color);cursor:pointer;color:var(--main-text-color)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);background-color:#0000001a;border:1px solid var(--dialog-border-color-hover)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}"]})}}return i})();function Bt(i,r){return this.gridID(r)}function ie(i,r){if(i&1){let t=w();z(),F(0,"rect",9),Q("click",function(e){let o=h(t).$implicit,l=p();return C(l.onClickDraw(e,o))}),Y()}if(i&2){let t=r.$implicit;_t(t.className),G("x",t.pos.x)("y",t.pos.y)}}function oe(i,r){if(i&1){let t=w();z(),F(0,"g",10),Q("mousedown",function(e){let o=h(t).$implicit,l=p();return C(l.onClickStone(e,o))}),F(1,"g",11),q(2,"rect",12)(3,"rect",13)(4,"use",14),Y()()}if(i&2){let t=r.$implicit;T("selected",t.source.selected)("hidden",t.source.picked)("hinted",t.source.hinted),G("transform",t.pos.translate)}}var Vt=(()=>{class i{constructor(){this.imageSet=V(),this.level=V(),this.matrix=V.required(),this.isBoard=V(),this.clickBoardEvent=k(),this.clickDrawEvent=k(),this.clickStoneEvent=k(),this.drawStones=[],this.drawCells=[],this.rotate=!1,this.translate="",this.viewport="0 0 1470 960",this.emptySource=new at(0,0,0,0,0)}ngOnInit(){let t=this.level();t&&this.updateLevel(t)}gridID(t){return`${t.z}-${t.x}-${t.y}`}drawClass(t,n,e){let o="",l=this.matrix();return l.inBounds(t,n,e)||(o="invalid"),(l.isTile(t,n,e)||l.isTilePosBlocked(t,n,e))&&(o="tile"),l.isTilePosInvalid(t,n,e)&&(o="blocked"),t>0&&(l.isTile(t-1,n,e)||l.isTilePosBlocked(t-1,n,e))&&(o+=" below"),o}ngOnChanges(t){t.level&&this.updateLevel(t.level.currentValue)}onClickStone(t,n){this.clickStoneEvent.emit(n?.source),t.stopPropagation()}onClickBoard(t){this.clickBoardEvent.emit()}onClickDraw(t,n){this.clickDrawEvent.emit(n),t.stopPropagation()}updateLevel(t){if(this.drawCells=[],this.drawStones=[],!t?.rows)return;let n=[];for(let[e,o]of t.rows.entries())for(let[l,d]of o.entries()){let x={x:e,y:l,z:t.z,v:d,visible:!0,pos:Ot(t.z,e,l),className:this.drawClass(t.z,e,l),source:d>0?new at(t.z,e,l,d,0):this.emptySource};this.drawCells.push(x),x.v>0&&n.push(x)}this.drawStones=yt(n),this.viewport=Mt(this.drawCells)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-editor-board"]],inputs:{imageSet:[1,"imageSet"],level:[1,"level"],matrix:[1,"matrix"],isBoard:[1,"isBoard"]},outputs:{clickBoardEvent:"clickBoardEvent",clickDrawEvent:"clickDrawEvent",clickStoneEvent:"clickStoneEvent"},features:[A],decls:15,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMin meet",1,"board-svg",3,"mousedown"],["id","filter4198-8",2,"color-interpolation-filters","sRGB"],["in","SourceGraphic","stdDeviation","8"],["id","front","width","300","height","400","viewBox","0 0 300 400"],["d","m 151.73588,1025.0177 c -3.32683,-9.3138 -10.24843,-68.45389 5.31821,-90.62655 20.27717,-26.12032 219.43558,-16.45796 231.55506,-9.93184 11.07433,5.31702 -178.60366,0.0589 -204.85126,34.86646 -21.59349,30.0006 -26.50086,82.17843 -32.02201,65.69193 z","transform","rotate(180,229,666.5)",2,"fill","#000000","fill-opacity","0.15","fill-rule","evenodd","stroke","none","filter","url(#filter4198-8)"],["transform","translate(28,-614)","d","M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z",2,"fill","#ffffff","fill-opacity","0.4","fill-rule","evenodd","stroke","none","filter","url(#filter4198-8)"],[1,"stage"],["stroke","black","stroke-width","1","width","37.5px","height","50px",1,"draw",3,"class"],[1,"draw",3,"selected","hidden","hinted"],["stroke","black","stroke-width","1","width","37.5px","height","50px",1,"draw",3,"click"],[1,"draw",3,"mousedown"],[1,"tile"],["x","3","y","3","width","75px","height","100px","rx","10","ry","10",1,"shadow"],["x","0","y","0","width","75","height","100","rx","10","ry","10",1,"stone"],[0,"xlink","href","#front","x","0","y","0","width","75","height","100"]],template:function(n,e){n&1&&(z(),F(0,"svg",0),Q("mousedown",function(l){return e.onClickBoard(l)}),F(1,"defs")(2,"filter",1),q(3,"feGaussianBlur",2),Y(),F(4,"svg",3),q(5,"path",4)(6,"path",5),Y()(),F(7,"style"),g(8," g.tile { transform-origin: 50px 32.5px; opacity: 1; } g.selected g.tile { transform: scale(1.04); } g.selected g.tile rect.stone { stroke: black; fill: #F8EABB; } g.draw rect.shadow { fill: #191919; opacity: 0.6; stroke-width: 1; stroke: black; } g.draw rect.stone { fill: #FFF9E5; stroke-width: 1; stroke: black; } g.hidden { opacity: 0; } "),Y(),F(9,"g",6),I(10,ie,1,4,":svg:rect",7,Bt,!0),Y(),F(12,"g",6),I(13,oe,5,7,":svg:g",8,Bt,!0),Y()()),n&2&&(T("rotate",e.rotate)("edit",e.isBoard()),G("viewBox",e.viewport),a(9),G("transform",e.translate),a(),B(e.drawCells),a(2),G("transform",e.translate),a(),B(e.drawStones))},styles:["[_nghost-%COMP%]{flex:1}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]{height:100%;width:100%;max-height:960px;background-color:var(--main-background-color);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   g.stage[_ngcontent-%COMP%]{transition:opacity .5s}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{fill:#2b424f}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   .draw.tile[_ngcontent-%COMP%]{fill:#fff9e5}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{fill:transparent;cursor:pointer}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.invalid[_ngcontent-%COMP%]{fill:#000;cursor:default}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.below[_ngcontent-%COMP%]{stroke:#d2691e;stroke-width:1px}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.blocked[_ngcontent-%COMP%]{fill:#0c1a1e;cursor:not-allowed}"]})}}return i})();var re=i=>({selected:i}),ae=(i,r)=>({z:i,rows:r,showStones:!0});function le(i,r){if(i&1){let t=w();s(0,"li",29),u("click",function(){let e=h(t).$index,o=p(2);return C(o.selectLevel(e))}),s(1,"div"),g(2),c(),s(3,"div",30)(4,"app-editor-board",31),u("clickBoardEvent",function(){let e=h(t).$index,o=p(2);return C(o.selectLevel(e))}),c()()()}if(i&2){let t=r.$implicit,n=r.$index,e=p(2);f("ngClass",ut(4,re,n===e.currentZ)),a(2),E("Level ",n),a(2),f("level",gt(6,ae,n,t))("matrix",e.matrix)}}function se(i,r){if(i&1&&(s(0,"div",26),z(),s(1,"svg",32)(2,"g",33),v(3,"path",34),c(),s(4,"text",35),g(5),c(),s(6,"text",36),g(7),c(),s(8,"text",37),g(9),c()()()),i&2){let t=p(2);a(5),L("x",t.stats.minX," \u2026 x",t.stats.maxX),a(2),L("z",t.stats.minZ," \u2026 z",t.stats.maxZ),a(2),L("y",t.stats.minY," \u2026 y",t.stats.maxY)}}function ce(i,r){if(i&1){let t=w();s(0,"button",38),u("click",function(){h(t);let e=p(2);return C(e.solve())}),g(1),m(2,"translate"),c()}i&2&&(a(),E(" ",_(2,1,"EDITOR_TEST_RUN")," "))}function pe(i,r){if(i&1){let t=w();s(0,"button",38),u("click",function(){h(t);let e=p(2);return C(e.cancelSolve())}),g(1),m(2,"translate"),c()}i&2&&(a(),E(" ",_(2,1,"EDITOR_TEST_CANCEL")," "))}function de(i,r){if(i&1&&(s(0,"div")(1,"div"),g(2),m(3,"translate"),c(),s(4,"div"),g(5),m(6,"translate"),s(7,"span"),g(8),c()()()),i&2){let t=p(2);a(2),L("",_(3,6,"EDITOR_TEST_SOLVED"),": ",t.solveStats.won),a(3),E("",_(6,8,"EDITOR_TEST_FAILED"),": "),a(2),T("fail",t.solveStats.fail>0),a(),M(t.solveStats.fail)}}function me(i,r){if(i&1){let t=w();s(0,"div",1)(1,"ul",2),I(2,le,5,9,"li",3,pt),c(),s(4,"div",4)(5,"div",5)(6,"button",6),m(7,"translate"),u("click",function(){h(t);let e=p();return C(e.newLayerBelow(e.currentZ))}),v(8,"i",7),c()()()(),s(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",4)(13,"div",11)(14,"div",12),g(15),c(),s(16,"button",13),m(17,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerZ(-1,e.currentZ))}),v(18,"i",14),c(),s(19,"button",13),m(20,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerZ(1,e.currentZ))}),v(21,"i",15),c(),s(22,"button",6),m(23,"translate"),u("click",function(){h(t);let e=p();return C(e.duplicateLayerZ(e.currentZ))}),v(24,"i",16),c(),s(25,"button",6),m(26,"translate"),u("click",function(){h(t);let e=p();return C(e.clearLayerZ(e.currentZ))}),v(27,"i",17),c(),s(28,"button",6),m(29,"translate"),u("click",function(){h(t);let e=p();return C(e.deleteLayerZ(e.currentZ))}),v(30,"i",18),c(),s(31,"button",6),m(32,"translate"),u("click",function(){h(t);let e=p();return C(e.toggleMirrorX())}),g(33," \uFE31 "),c(),s(34,"button",6),m(35,"translate"),u("click",function(){h(t);let e=p();return C(e.toggleMirrorY())}),g(36," \u23AF "),c()(),s(37,"div",5)(38,"span"),g(39),c(),s(40,"button",6),m(41,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerY(-1))}),v(42,"i",14),c(),s(43,"button",6),m(44,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerY(1))}),v(45,"i",15),c(),s(46,"button",6),m(47,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerX(-1))}),v(48,"i",19),c(),s(49,"button",6),m(50,"translate"),u("click",function(){h(t);let e=p();return C(e.moveLayerX(1))}),v(51,"i",20),c()()(),s(52,"div",21)(53,"app-editor-board",22),u("clickDrawEvent",function(e){h(t);let o=p();return C(o.onCellClick(e))})("clickStoneEvent",function(e){h(t);let o=p();return C(o.onStoneClick(e))}),c()()(),s(54,"div",23)(55,"div",4)(56,"div",5)(57,"div",12),g(58),m(59,"translate"),c()(),s(60,"div",5)(61,"span"),g(62),c(),s(63,"button",6),m(64,"translate"),u("click",function(){h(t);let e=p();return C(e.moveY(-1))}),v(65,"i",14),c(),s(66,"button",6),m(67,"translate"),u("click",function(){h(t);let e=p();return C(e.moveY(1))}),v(68,"i",15),c(),s(69,"button",6),m(70,"translate"),u("click",function(){h(t);let e=p();return C(e.moveX(-1))}),v(71,"i",19),c(),s(72,"button",6),m(73,"translate"),u("click",function(){h(t);let e=p();return C(e.moveX(1))}),v(74,"i",20),c()()(),s(75,"div",24),v(76,"app-layout-preview",25),P(77,se,10,6,"div",26),c(),s(78,"div",27)(79,"div",5)(80,"div"),P(81,ce,3,3,"button",28),P(82,pe,3,3,"button",28),c()(),P(83,de,9,10,"div"),c()()()()}if(i&2){let t=p();a(2),B(t.matrix.levels),a(4),f("title",y(_(7,52,"EDITOR_NEW_LAYER_LONG"))),a(9),E("Level ",t.currentZ),a(),f("title",y(_(17,54,"EDITOR_MOVE_LAYER_DOWN_LONG")))("disabled",t.currentZ===0),a(3),f("title",y(_(20,56,"EDITOR_MOVE_LAYER_UP_LONG")))("disabled",t.currentZ===t.matrix.levels.length-1),a(3),f("title",y(_(23,58,"EDITOR_DUPLICATE_LAYER_LONG"))),a(3),f("title",y(_(26,60,"EDITOR_CLEAR_LAYER_LONG"))),a(3),f("title",y(_(29,62,"EDITOR_DELETE_LAYER_LONG"))),a(3),T("checked",t.mirrorX),f("title",y(_(32,64,"MIRROR_X"))),a(3),T("checked",t.mirrorY),f("title",y(_(35,66,"MIRROR_X"))),a(5),E("Tiles: ",t.stats.layerCount),a(),f("title",y(_(41,68,"EDITOR_MOVE_TILES_UP_LONG"))),a(3),f("title",y(_(44,70,"EDITOR_MOVE_TILES_DOWN_LONG"))),a(3),f("title",y(_(47,72,"EDITOR_MOVE_TILES_LEFT_LONG"))),a(3),f("title",y(_(50,74,"EDITOR_MOVE_TILES_RIGHT_LONG"))),a(4),f("level",t.level)("isBoard",!0)("matrix",t.matrix),a(5),M(_(59,76,"EDITOR_VIEW_FULL")),a(3),T("fail",t.stats.countInvalid),a(),E("Tiles: ",t.stats.totalCount),a(),f("title",y(_(64,78,"EDITOR_MOVE_ALL_TILES_UP_LONG"))),a(3),f("title",y(_(67,80,"EDITOR_MOVE_ALL_TILES_DOWN_LONG"))),a(3),f("title",y(_(70,82,"EDITOR_MOVE_ALL_TILES_LEFT_LONG"))),a(3),f("title",y(_(73,84,"EDITOR_MOVE_ALL_TILES_RIGHT_LONG"))),a(4),f("svg",t.svg),a(),b(t.stats?77:-1),a(4),b(t.solveWorker?-1:81),a(),b(t.solveWorker?82:-1),a(),b(t.solveStats?83:-1)}}function _e(i,r){if(i&1){let t=w();s(0,"div",39),u("click",function(){h(t);let e=p();return C(e.toggleSave())}),s(1,"div",40),u("click",function(e){return h(t),C(e.stopPropagation())}),s(2,"span",41),m(3,"translate"),u("click",function(){h(t);let e=p();return C(e.toggleSave())}),v(4,"i",42),c(),s(5,"app-editor-export-component",43),u("savedEvent",function(){h(t);let e=p();return C(e.toggleAfterSave())}),c()()()}if(i&2){let t=p();a(2),f("title",y(_(3,3,"CLOSE"))),a(3),f("layout",t.layout())}}var ot=(()=>{class i{constructor(){this.layout=Ct.required(),this.currentZ=0,this.totalZ=1,this.totalY=$.mY,this.totalX=$.mX,this.matrix=new X,this.saveDialog=!1,this.hasChanged=!1,this.mirrorX=!1,this.mirrorY=!1,this.worker=S(nt),this.layoutService=S(R)}ngOnDestroy(){this.cancelSolve()}getStats(t){let n={name:t.name,totalCount:t.mapping.length,layerCount:t.mapping.filter(e=>e[0]===this.currentZ).length,countInvalid:t.mapping.length>144||!!(t.mapping.length%2),minX:100,maxX:0,minY:100,maxY:0,minZ:100,maxZ:0,height:0,width:0,depth:0};for(let e of t.mapping)e[0]<n.minZ&&(n.minZ=e[0]),e[0]>n.maxZ&&(n.maxZ=e[0]),e[1]<n.minX&&(n.minX=e[1]),e[1]>n.maxX&&(n.maxX=e[1]),e[2]<n.minY&&(n.minY=e[2]),e[2]>n.maxY&&(n.maxY=e[2]);return n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.depth=n.maxZ-n.minZ,n}ngOnInit(){this.layout()&&(this.refresh(),this.hasChanged=!1)}ngOnChanges(t){t.layout&&(this.refresh(),this.hasChanged=!1)}removeStone(t,n,e){this.layout().mapping=this.layout().mapping.filter(o=>o[0]!==t||o[1]!==n||o[2]!==e),this.matrix.applyMapping(this.layout().mapping,this.totalZ,this.totalX,this.totalY)}addStone(t,n,e){this.layout().mapping.push([t,n,e]),this.matrix.applyMapping(this.layout().mapping,this.totalZ,this.totalX,this.totalY)}mirrorXValue(t){return this.totalX-2-t}mirrorYValue(t){return this.totalY-2-t}onPosClick(t,n,e){if(!(this.matrix.isTilePosBlocked(t,n,e)||this.matrix.isTilePosInvalid(t,n,e))){if(this.matrix.isTile(t,n,e)){this.removeStone(t,n,e);let o=[];this.mirrorX&&o.push([t,this.mirrorXValue(n),e]),this.mirrorY&&o.push([t,n,this.mirrorYValue(e)]),this.mirrorX&&this.mirrorY&&o.push([t,this.mirrorXValue(n),this.mirrorYValue(e)]);for(let[l,d,x]of o)this.matrix.isTile(l,d,x)&&this.removeStone(l,d,x)}else{this.addStone(t,n,e);let o=[];if(this.mirrorX){let l=this.mirrorXValue(n);o.push([t,l,e])}if(this.mirrorY){let l=this.mirrorYValue(e);o.push([t,n,l])}if(this.mirrorX&&this.mirrorY){let l=this.mirrorXValue(n),d=this.mirrorYValue(e);o.push([t,l,d])}for(let[l,d,x]of o)!this.matrix.isTilePosBlocked(l,d,x)&&!this.matrix.isTilePosInvalid(l,d,x)&&!this.matrix.isTile(l,d,x)&&this.addStone(l,d,x)}this.refresh()}}onCellClick(t){this.onPosClick(t.z,t.x,t.y)}onStoneClick(t){t&&this.onPosClick(t.z,t.x,t.y)}selectLevel(t){this.level={z:t,rows:this.matrix.levels[t],showTiles:!0},this.currentZ=t,this.refresh()}refresh(){let t=this.layout();t&&(this.hasChanged=!0,this.matrix.applyMapping(t.mapping,this.totalZ,this.totalX,this.totalY),this.stats=this.getStats(t),this.level={z:this.currentZ,rows:this.matrix.levels[this.currentZ],showTiles:!0},this.svg=this.layoutService.generatePreview(W(t.mapping)),t.previewSVG=this.svg)}moveX(t){if(this.stats.minX+t<0||this.stats.maxX+t>=$.mX-1)return;let n=this.layout().mapping;for(let e of n)e[1]=e[1]+t;this.refresh()}moveY(t){if(this.stats.minY+t<0||this.stats.maxY+t>=$.mY-1)return;let n=this.layout().mapping;for(let e of n)e[2]=e[2]+t;this.refresh()}moveLayer(t,n){let e=this.layout().mapping.filter(O=>O[0]===this.currentZ),o=t?1:2,l=t?$.mX:$.mY,d=e[0][o],x=e[0][o];for(let O of e)d=Math.min(O[o],d),x=Math.max(O[o],x);if(!(d+n<0||x+n>=l-1)){for(let O of e)O[o]=O[o]+n;this.refresh()}}toggleMirrorX(){this.mirrorX=!this.mirrorX}toggleMirrorY(){this.mirrorY=!this.mirrorY}moveLayerX(t){this.moveLayer(!0,t)}moveLayerY(t){this.moveLayer(!1,t)}duplicateLayerZ(t){let n=[],e=this.layout().mapping;for(let o of e)o[0]>t?o[0]=o[0]+1:o[0]===t&&n.push(o);for(let o of n)e.push([t+1,o[1],o[2]]);this.refresh()}clearLayerZ(t){this.layout().mapping=this.layout().mapping.filter(n=>n[0]!==t),this.refresh()}deleteLayerZ(t){this.layout().mapping=this.layout().mapping.filter(n=>n[0]!==t);for(let n of this.layout().mapping)n[0]>t&&(n[0]=n[0]-1);this.totalZ=Math.max(this.totalZ-1,1),this.refresh()}newLayerBelow(t){this.totalZ+=1;let n=this.layout().mapping;for(let e of n)e[0]>t&&(e[0]=e[0]+1);this.refresh()}moveLayerZ(t,n){if(n+t<0||n+t>=this.matrix.levels.length)return;let e=this.layout().mapping;for(let o of e)o[0]===n?o[0]=o[0]+t:o[0]===n+t&&(o[0]=n);n===this.currentZ&&(this.currentZ=this.currentZ+t),this.refresh()}toggleSave(){this.saveDialog=!this.saveDialog}toggleAfterSave(){this.saveDialog=!1,this.hasChanged=!1}cancelSolve(){this.solveWorker&&(this.solveWorker.terminate(),this.solveWorker=void 0)}solve(){if(this.solveWorker)return;let t={fail:0,won:0};this.solveWorker=this.worker.solve(this.layout().mapping,1e3,n=>{t.won=n[0],t.fail=n[1]},n=>{t.won=n[0],t.fail=n[1],this.solveWorker=void 0}),this.solveStats=t}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-editor-layout-component"]],inputs:{layout:[1,"layout"]},outputs:{layout:"layoutChange"},features:[A],decls:2,vars:2,consts:[[1,"overlay","overlay-save"],[1,"editor-matrix-list"],[1,"matrix-list"],[3,"ngClass"],[1,"buttonbar"],[1,"buttons"],[3,"click","title"],[1,"icon-editor-list-add"],[1,"editor-selected"],[1,"matrix-edit"],[1,"matrix-edit-top"],[1,"buttons","buttons-current-level"],[1,"buttonbar-title"],[3,"click","disabled","title"],[1,"icon-editor-up-small"],[1,"icon-editor-down-small"],[1,"icon-editor-docs"],[1,"icon-editor-cancel-alt"],[1,"icon-editor-trash"],[1,"icon-editor-left-small"],[1,"icon-editor-right-small"],[1,"matrix-board"],[3,"clickDrawEvent","clickStoneEvent","level","isBoard","matrix"],[1,"matrix-edit-bottom"],[1,"matrix-preview"],[1,"svg-board",3,"svg"],[1,"dimensions"],[1,"stats","stats-bottom"],[1,"text-button"],[3,"click","ngClass"],[1,"matrix-level"],[3,"clickBoardEvent","level","matrix"],["xmlns","http://www.w3.org/2000/svg","height","100%","width","100%","x","0px","y","0px","viewBox","0 0 1600 1500"],["transform","translate(0, 300)"],["fill","#47b00a","d","M10,309.7c40.7-99.4,81.5-198.7,122.3-298c39.6,99.2,78.6,198.7,117.9,298c-31.6,0.1-63.2,0-94.8,0.1c0,167-0.1,334.1,0,501.1c148.5-103.4,296.4-207.8,444.8-311.4c-16.9-26.8-37-51.7-53.8-78.5c102.1-22.8,204.1-46,306.2-69C795.4,439.2,738,526.3,680.3,613.2c-17.6-25.2-35.1-50.4-52.9-75.4C480.9,640,334.5,742.4,188.5,845.4c167.8,0.3,335.6,0.1,503.4,0.1c0.1-32.5-0.1-64.9,0.1-97.3c99.4,40.7,198.7,81.5,298,122.3C890.8,910,791.3,949,691.9,988.3c-0.1-31.6,0-63.2-0.1-94.8c-193.7-0.1-387.4-0.1-581.1,0c-1.2,0-2.3-0.5-3.5-0.8c0.1-194.3,0.1-388.6,0-582.9C74.9,309.7,42.5,309.8,10,309.7L10,309.7z"],["x","100","y","1500","fill","#47b00a",2,"font","200px monospace"],["x","0","y","200","fill","#47b00a",2,"font","200px monospace"],["x","600","y","500","fill","#47b00a",2,"font","200px monospace"],[1,"text-button",3,"click"],[1,"overlay","overlay-save",3,"click"],[1,"overlay-popup",3,"click"],[1,"close",3,"click","title"],[1,"icon-cancel-circled2"],[3,"savedEvent","layout"]],template:function(n,e){n&1&&(P(0,me,84,86),P(1,_e,6,5,"div",0)),n&2&&(b(e.layout()?0:-1),a(),b(e.saveDialog?1:-1))},dependencies:[ft,xt,Vt,U,It,Z],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:row;color:var(--main-text-color);overflow:hidden}[_nghost-%COMP%]   .overlay-save[_ngcontent-%COMP%]   .overlay-popup[_ngcontent-%COMP%]{width:98%;height:98%;max-height:640px;max-width:640px;overflow-y:auto}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{padding-right:6px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;color:var(--text-highlight-color);border:1px solid var(--main-bg-color-dk);cursor:pointer}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button.checked[_ngcontent-%COMP%]{background-color:#0000004d;border:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}[_nghost-%COMP%]   .buttons-current-level[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .buttonbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}[_nghost-%COMP%]   .buttonbar[_ngcontent-%COMP%]   .buttonbar-title[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]{width:220px;max-height:100%;height:100%;border-right:1px solid var(--dialog-border-color);overflow-y:auto;background-color:var(--editor-color-bg)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:4px;max-height:100%}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   .matrix-level[_ngcontent-%COMP%]{display:flex;max-width:80%;margin:0 auto}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{text-align:center;cursor:pointer;border:1px solid var(--dialog-border-color);margin-bottom:4px;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{border-color:var(--dialog-border-color-hover)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{border-color:var(--dialog-border-color-selected)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;display:inline-block;min-width:.8em}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:auto}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;text-align:center;max-height:100%;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]   .matrix-board[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]{border-top:1px solid var(--dialog-border-color);height:25%;display:flex;flex-direction:column;position:relative;min-height:120px}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]   .dimensions[_ngcontent-%COMP%]{opacity:0;background-color:#000000b3;position:absolute;padding:8px;inset:0}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]:hover   .dimensions[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;background-color:#000000b3;bottom:0;font-size:.9em;border-radius:6px;text-align:left;padding:10px;font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .stats-bottom[_ngcontent-%COMP%]{text-align:right;right:0}@media only screen and (max-width:700px){[_nghost-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]{height:80px;width:100%;overflow:auto hidden;margin-bottom:2px;border-right:none;border-bottom:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]{white-space:nowrap;border-right:none;height:92%}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100px;height:100%;display:inline-flex}}@media only screen and (width>=400px)and (height<=600px){[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]{flex-direction:row}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]{max-height:100%}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]{height:100%;width:30%;border-top:none}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}}"]})}}return i})();var Rt=(()=>{class i{constructor(){this.appDropZone=k(),this.appDropZoneOver=k(),this.preventBodyDrop=V(!0),this.active=!1}onDrop(t){t.preventDefault(),this.active=!1;let{dataTransfer:n}=t;if(n?.items){let e=[],o=Array.from(n.items);for(let l of o)if(l?.kind==="file"){let d=l.getAsFile();d&&e.push(d)}n.items.clear(),this.appDropZone.emit(e)}else if(n){let e=n?.files;n.clearData(),e&&this.appDropZone.emit(Array.from(e))}}onDragOver(t){t.stopPropagation(),t.preventDefault(),this.active||this.appDropZoneOver.emit(),this.active=!0}onDragLeave(t){this.active=!1}onBodyDragOver(t){this.preventBodyDrop()&&(t.preventDefault(),t.stopPropagation())}onBodyDrop(t){this.preventBodyDrop()&&t.preventDefault()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=ct({type:i,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(n,e){n&1&&u("drop",function(l){return e.onDrop(l)})("dragover",function(l){return e.onDragOver(l)})("dragleave",function(l){return e.onDragLeave(l)})("dragover",function(l){return e.onBodyDragOver(l)},rt)("drop",function(l){return e.onBodyDrop(l)},rt),n&2&&T("drop-zone-active",e.active)},inputs:{preventBodyDrop:[1,"preventBodyDrop"]},outputs:{appDropZone:"appDropZone",appDropZoneOver:"appDropZoneOver"}})}}return i})();function ue(i,r){if(i&1){let t=w();s(0,"a",7),u("click",function(){h(t);let e=p().$implicit,o=p();return C(o.selectLayout(e.id))}),v(1,"i",8),g(2),c()}if(i&2){let t=p().$implicit;a(2),E(" ",t.msg)}}function ge(i,r){if(i&1&&g(0),i&2){let t=p().$implicit;E(" ",t.msg," ")}}function he(i,r){if(i&1&&(s(0,"p",6),P(1,ue,3,1,"a"),P(2,ge,1,1),c()),i&2){let t=r.$implicit;T("is-error",t.isError),a(),b(t.id?1:-1),a(),b(t.id?-1:2)}}var Nt=(()=>{class i{constructor(){this.editEvent=k(),this.layoutService=S(R),this.logs=[]}selectFiles(t){let e=t.currentTarget.files;e&&this.importFiles(Array.from(e))}importLayouts(t){return N(this,null,function*(){this.logs=[];let n=[];for(let e of t)try{let o=yield Et(e);for(let l of o){let d=this.layoutService.expandLayout(l,!0);!this.layoutService.layouts.items.some(x=>x.id===d.id)&&!n.some(x=>x.id===d.id)?(n.push(R.layout2loadLayout(d,l.map)),this.logs.push({msg:`Imported: "${e.name}"`,id:d.id})):(console.error(`Similar layout to "${d.name}" already available. Import rejected`),this.logs.push({msg:`Similar layout to "${d.name}" already available. Import rejected.`,isError:!0}))}}catch(o){console.error("Error importing",e,o),this.logs.push({msg:`ERROR importing "${e.name}". Invalid file.`,isError:!0})}n.length>0&&this.layoutService.storeCustomBoards(n)})}selectLayout(t){let n=this.layoutService.layouts.items.find(e=>e.id===t);n&&this.editEvent.emit(n)}importFiles(t){this.importLayouts(t).catch(n=>{console.error(n)})}onDropFiles(t){this.importFiles(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-import-component"]],outputs:{editEvent:"editEvent"},decls:19,vars:12,consts:[[1,"import-section",3,"appDropZone"],[1,"drop-zone"],[1,"title"],["name","file","type","file","multiple","",3,"change"],[1,"log-zone"],[1,"layout",3,"is-error"],[1,"layout"],[3,"click"],[1,"icon-editor-ok"]],template:function(n,e){n&1&&(s(0,"div",0),u("appDropZone",function(l){return e.onDropFiles(l)}),s(1,"div",1)(2,"div",2),g(3),m(4,"translate"),v(5,"br"),g(6),m(7,"translate"),v(8,"br"),g(9),m(10,"translate"),v(11,"br"),g(12),m(13,"translate"),v(14,"br"),c(),s(15,"input",3),u("change",function(l){return e.selectFiles(l)}),c()(),s(16,"div",4),I(17,he,3,4,"p",5,j),c()()),n&2&&(a(3),M(_(4,4,"EDITOR_IMPORT_DROP")),a(3),E(" ",_(7,6,"EDITOR_FORMAT_KYODAI")),a(3),E(" ",_(10,8,"EDITOR_FORMAT_KMAHJONGG")),a(3),E(" ",_(13,10,"EDITOR_FORMAT_MAH")),a(5),B(e.logs))},dependencies:[Rt,Z],styles:["[_nghost-%COMP%]{flex:1;display:flex;color:var(--main-text-color);width:100%}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:80px 30px;width:100%;max-width:800px;border:2px dashed var(--dialog-border-color);border-radius:20px;text-align:center;position:relative}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]{margin-top:20px;max-height:300px;width:100%;max-width:800px;color:var(--main-text-color);overflow-y:auto}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]   p.is-error[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .import-section.drop-zone-active[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]{border:2px dashed var(--dialog-border-color)}"]})}}return i})();function Ce(i,r){if(i&1&&(s(0,"div"),g(1),m(2,"translate"),c()),i&2){let t=p(2).$implicit,n=p();a(),L("",_(2,2,"EDITOR_TEST_SOLVED"),": ",n.test[t.id]==null?null:n.test[t.id].win)}}function xe(i,r){if(i&1&&(s(0,"div",20),g(1),m(2,"translate"),c()),i&2){let t=p(2).$implicit,n=p();a(),L("",_(2,2,"EDITOR_TEST_FAILED"),": ",n.test[t.id]==null?null:n.test[t.id].fail)}}function fe(i,r){if(i&1&&(s(0,"div"),P(1,Ce,3,4,"div"),P(2,xe,3,4,"div",20),c()),i&2){let t=p().$implicit,n=p();a(),b(n.test[t.id]!=null&&n.test[t.id].win?1:-1),a(),b(n.test[t.id]!=null&&n.test[t.id].fail?2:-1)}}function ve(i,r){if(i&1){let t=w();s(0,"button",9),m(1,"translate"),u("click",function(e){h(t);let o=p().$implicit,l=p();return C(l.removeCustomBoard(e,o))}),v(2,"i",12),c()}i&2&&f("title",y(_(1,2,"CUSTOM_BOARD_DELETE")))}function Oe(i,r){if(i&1){let t=w();s(0,"tr",14),u("click",function(){let e=h(t).$implicit,o=p();return C(o.editLayout(e))}),s(1,"td",2),v(2,"app-layout-preview",15),c(),s(3,"td",16),g(4),c(),s(5,"td",17),g(6),c(),s(7,"td",18),g(8),c(),s(9,"td",8)(10,"button",9),m(11,"translate"),u("click",function(e){let o=h(t).$implicit,l=p();return C(l.testLayout(e,o))}),v(12,"i",10),c(),P(13,fe,3,2,"div"),c(),s(14,"td",11),P(15,ve,3,4,"button",19),c()()}if(i&2){let t=r.$implicit,n=p();a(2),f("layout",t),a(2),M(t.name),a(2),M(t.category),a(2),M(t.mapping.length),a(2),f("title",y(_(11,8,"EDITOR_TEST_RUN"))),a(3),b(n.test[t.id]?13:-1),a(2),b(t.custom?15:-1)}}var Ft=(()=>{class i{constructor(){this.inputLayouts=V(),this.editEvent=k(),this.test={},this.sortColumn=1,this.sortDesc=!0,this.showBuildIn=!0,this.layoutService=S(R),this.workerService=S(nt),this.update()}ngOnChanges(t){t.inputLayouts&&this.update()}ngOnDestroy(){this.worker&&(this.worker.terminate(),this.worker=void 0)}editLayout(t){this.editEvent.emit(t)}toggleBuildIn(){this.showBuildIn=!this.showBuildIn,this.update()}clickSortBy(t,n){this.sortColumn===n&&(this.sortDesc=!this.sortDesc),this.sortBy(n)}update(){let t=this.inputLayouts();t&&(this.layouts=t.sort((n,e)=>n.name.localeCompare(e.name)),this.showBuildIn||(this.layouts=this.layouts.filter(n=>n.custom)),this.sortBy(this.sortColumn))}removeCustomBoard(t,n){t.stopPropagation(),this.layoutService.removeCustomLayout([n.id]),this.update()}removeCustomLayouts(t){t.stopPropagation(),this.layoutService.removeAllCustomLayouts(),this.update()}sortBy(t){this.sortColumn=t,this.layouts=this.layouts.sort((n,e)=>{let o;switch(t){case 1:{o=n.name.localeCompare(e.name);break}case 2:{o=(n.by??"").localeCompare(e.by??"");break}case 3:{o=(n.category??"").localeCompare(e.category??"");break}case 4:{o=n.mapping.length-e.mapping.length;break}default:o=0}return(this.sortDesc?1:-1)*o})}testLayout(t,n){t.stopPropagation(),this.startTestLayout(n)}startTestLayout(t,n){if(this.worker){this.worker.terminate(),this.worker=void 0;return}this.test[t.id]=void 0,this.worker=this.workerService.solve(t.mapping,10,e=>{this.test[t.id]={win:e[0],fail:e[1]}},e=>{this.test[t.id]={win:e[0],fail:e[1]},this.worker=void 0,n&&n()})}testLayouts(t){if(this.worker){this.worker.terminate();return}this.testNextLayout()}testNextLayout(){let t=this.layouts.find(n=>!this.test[n.id]);t&&this.startTestLayout(t,()=>{this.testNextLayout()})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-manager-component"]],inputs:{inputLayouts:[1,"inputLayouts"]},outputs:{editEvent:"editEvent"},features:[A],decls:36,vars:39,consts:[[1,"layout-table"],[1,"layout","layout-header"],[1,"col-image"],[1,"col-name","sortable",3,"click"],[1,"arrow"],[1,"col-cat","sortable",3,"click"],["type","checkbox",3,"change","checked"],[1,"col-stats","sortable",3,"click"],[1,"col-test"],[3,"click","title"],[1,"icon-editor-paper-plane-empty"],[1,"col-delete"],[1,"icon-trash-empty"],[1,"layout"],[1,"layout",3,"click"],[1,"svg-board",3,"layout"],[1,"col-name"],[1,"col-cat"],[1,"col-stats"],[3,"title"],[1,"fail"]],template:function(n,e){n&1&&(s(0,"table",0)(1,"thead")(2,"tr",1)(3,"td",2),g(4),m(5,"translate"),c(),s(6,"td",3),u("click",function(l){return e.clickSortBy(l,1)}),g(7),m(8,"translate"),v(9,"span",4),c(),s(10,"td",5),u("click",function(l){return e.clickSortBy(l,3)}),g(11),m(12,"translate"),v(13,"span",4),s(14,"div")(15,"label")(16,"input",6),u("change",function(){return e.toggleBuildIn()}),c(),g(17),m(18,"translate"),c()()(),s(19,"td",7),u("click",function(l){return e.clickSortBy(l,4)}),g(20),m(21,"translate"),v(22,"span",4),c(),s(23,"td",8),g(24),m(25,"translate"),s(26,"button",9),m(27,"translate"),u("click",function(l){return e.testLayouts(l)}),v(28,"i",10),c()(),s(29,"td",11)(30,"button",9),m(31,"translate"),u("click",function(l){return e.removeCustomLayouts(l)}),v(32,"i",12),c()()()(),s(33,"tbody"),I(34,Oe,16,10,"tr",13,j),c()()),n&2&&(a(4),M(_(5,23,"EDITOR_COLUMN_PREVIEW")),a(2),T("sort-up",e.sortColumn===1&&e.sortDesc)("sort-down",e.sortColumn===1&&!e.sortDesc),a(),E("",_(8,25,"EDITOR_LAYOUT_NAME")," "),a(3),T("sort-up",e.sortColumn===3&&e.sortDesc)("sort-down",e.sortColumn===3&&!e.sortDesc),a(),E("",_(12,27,"EDITOR_LAYOUT_CATEGORY")," "),a(5),f("checked",e.showBuildIn),a(),E(" ",_(18,29,"EDITOR_SHOW_BUILDIN")," "),a(2),T("sort-up",e.sortColumn===4&&e.sortDesc)("sort-down",e.sortColumn===4&&!e.sortDesc),a(),E("",_(21,31,"EDITOR_LAYOUT_NR_OF_STONES")," "),a(4),E("",_(25,33,"EDITOR_COLUMN_TEST")," "),a(2),f("title",y(_(27,35,"EDITOR_TEST_RUN"))),a(4),f("title",y(_(31,37,"CUSTOM_BOARD_DELETE_ALL"))),a(4),B(e.layouts))},dependencies:[U,Z],styles:["[_nghost-%COMP%]{overflow-y:auto;flex:1}[_nghost-%COMP%]   .fail[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]{color:var(--editor-table-row-color);width:100%}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{cursor:pointer;background-color:var(--editor-table-row-color-bg);height:80px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]:hover{background-color:var(--editor-table-row-color-bg-hover)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{vertical-align:middle;padding:4px 15px;border-top:1px solid var(--dialog-border-color);border-right:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:5px solid var(--main-text-color);display:none;margin-bottom:3px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sortable[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sort-up[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sort-down[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{display:inline-block;transform:rotate(180deg)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]   .col-image[_ngcontent-%COMP%]{width:80px;height:80px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-test[_ngcontent-%COMP%]{width:140px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-cat[_ngcontent-%COMP%]{width:200px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-stats[_ngcontent-%COMP%]{width:140px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-delete[_ngcontent-%COMP%]{width:80px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout-header[_ngcontent-%COMP%]{max-height:30px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-top:none}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout-header[_ngcontent-%COMP%]:hover{background-color:#0000001a}[_nghost-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;color:var(--text-highlight-color);border:1px solid var(--main-bg-color-dk);cursor:pointer;text-align:center}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}"]})}}return i})();function ye(i,r){if(i&1){let t=w();s(0,"div")(1,"div",9)(2,"ul")(3,"li"),g(4),m(5,"translate"),m(6,"translate"),c()()(),s(7,"div",10)(8,"app-import-component",11),u("editEvent",function(e){h(t);let o=p();return C(o.editLayout(e))}),c()()()}i&2&&(a(4),L("",_(5,2,"EDITOR_TITLE"),": ",_(6,4,"EDITOR_IMPORT")))}function Me(i,r){if(i&1){let t=w();s(0,"div")(1,"div",4)(2,"ul")(3,"li"),g(4),m(5,"translate"),c(),v(6,"li",5),s(7,"li")(8,"button",6),m(9,"translate"),u("click",function(){h(t);let e=p();return C(e.save())}),g(10),m(11,"translate"),c()()()(),s(12,"div",10),v(13,"app-editor-layout-component",12),c()()}if(i&2){let t=p();a(4),L("",_(5,6,"EDITOR_TITLE"),": ",t.layout.name),a(4),f("title",y(_(9,8,"EDITOR_SAVE_LONG"))),a(2),M(_(11,10,"EDITOR_SAVE")),a(3),f("layout",t.layout)}}var Vn=(()=>{class i{constructor(){this.closeEvent=k(),this.layoutComponent=ht(ot),this.mode="manager",this.layoutService=S(R),this.translate=S(tt)}save(){let t=this.layoutComponent();t&&t.toggleSave()}close(){if(this.mode==="manager"){this.closeEvent.emit();return}let t=this.layoutComponent();(!(this.layout&&t?.hasChanged)||confirm(this.translate.instant("EDITOR_DISCARD_CHANGES_SURE")))&&(this.layout=void 0,this.mode="manager")}editLayout(t){this.mode="edit",this.layout={id:"",originalId:t.id,name:t.name,by:t.by??"",category:(t.custom?t.category:void 0)??"Custom",mapping:t.mapping.map(n=>[n[0],n[1],n[2]])}}exportLayouts(){Dt(this.layoutService.layouts.items)}newLayout(){this.editLayout({id:"",name:"New Board",category:"Custom",by:"",mapping:[]})}onDropFiles(){}onDragFiles(){this.mode="import"}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-editor-component"]],viewQuery:function(n,e){n&1&&dt(e.layoutComponent,ot,5),n&2&&mt()},outputs:{closeEvent:"closeEvent"},decls:30,vars:33,consts:[[1,"editor-content"],[1,"close",3,"click","title"],[1,"icon-cancel-circled2"],[1,"editor-manager"],[1,"editor-nav","buttons"],[1,"sep"],[3,"click","title"],[1,"editor-main",3,"appDropZone","appDropZoneOver"],[3,"editEvent","inputLayouts"],[1,"editor-nav"],[1,"editor-main"],[3,"editEvent"],[3,"layout"]],template:function(n,e){n&1&&(s(0,"div",0)(1,"a",1),m(2,"translate"),u("click",function(){return e.close()}),v(3,"i",2),c(),s(4,"div",3)(5,"div",4)(6,"ul")(7,"li"),g(8),m(9,"translate"),c(),v(10,"li",5),s(11,"li")(12,"button",6),m(13,"translate"),u("click",function(){return e.newLayout()}),g(14),m(15,"translate"),c()(),s(16,"li")(17,"button",6),m(18,"translate"),u("click",function(){return e.mode="import"}),g(19),m(20,"translate"),c()(),s(21,"li")(22,"button",6),m(23,"translate"),u("click",function(){return e.exportLayouts()}),g(24),m(25,"translate"),c()()()(),s(26,"div",7),u("appDropZone",function(){return e.onDropFiles()})("appDropZoneOver",function(){return e.onDragFiles()}),s(27,"app-manager-component",8),u("editEvent",function(l){return e.editLayout(l)}),c()()(),P(28,ye,9,6,"div"),P(29,Me,14,12,"div"),c()),n&2&&(a(),f("title",y(_(2,17,"CLOSE"))),a(3),T("visible",e.mode==="manager"),a(4),M(_(9,19,"EDITOR_TITLE")),a(4),f("title",y(_(13,21,"EDITOR_NEW_LONG"))),a(2),M(_(15,23,"EDITOR_NEW")),a(3),f("title",y(_(18,25,"EDITOR_IMPORT_LONG"))),a(2),M(_(20,27,"EDITOR_IMPORT")),a(3),f("title",y(_(23,29,"EDITOR_EXPORT_LONG"))),a(2),M(_(25,31,"EDITOR_EXPORT")),a(3),f("inputLayouts",e.layoutService.layouts.items),a(),b(e.mode==="import"?28:-1),a(),b(e.mode==="edit"&&e.layout?29:-1))},dependencies:[ot,Nt,Ft,Z],styles:["[_nghost-%COMP%]{--editor-table-row-color: #fff;--editor-color-bg: #1e2e37;--editor-table-row-color-bg: #1e2e37;--editor-table-row-color-bg-hover: #2b424f;position:absolute;inset:0;background-color:var(--editor-color-bg);z-index:10001}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:var(--main-content-link-color);cursor:pointer}[_nghost-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--main-content-link-hover-color)}[_nghost-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;right:10px;top:8px;cursor:pointer}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;border:1px solid var(--main-bg-color-dk);cursor:pointer;font-size:1em;color:var(--text-highlight-color);padding:2px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-text-color-hover)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-manager[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-manager.visible[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]{padding:4px 8px 8px;border-bottom:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;margin:0 40px 0 0;list-style:none;display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#fff;font-size:1.3em;padding-left:8px}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.sep[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:#ff0;cursor:default}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}"]})}}return i})();export{Vn as EditorComponent};
